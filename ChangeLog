------------------------------------------------------------------------
r17899 | gerald | 2006-04-18 15:46:48 -0500 (Tue, 18 Apr 2006) | 42 lines
Changed paths:
   M /trunk-1.0/epan/dissectors/packet-bacapp.c
   M /trunk-1.0/epan/dissectors/packet-bootp.c
   M /trunk-1.0/wiretap/netxray.c

Misc fixes from the trunk.

r17869:
User: jake
Date: 2006/04/15 02:00 PM

Log:
 Sake Blok wrote....
 I have taken a look at the trace myself and calculated the TpS to be 
 20000000.0 for this particular trace. If I also discard the start_timestamp
 like it has been done for other versions of the netxray format, then I get 
 the proper results.


r17884:
User: jake
Date: 2006/04/17 03:38 AM

Log:
 From Thomas Anders:
 - allow DHCP option 43 suboption 8 (OUI) for CableLabs clients to be a 6-byte string (as required for DOCSIS CMs) to 
   account for inconsistencies in different CableLabs specifications
 - add new DHCP option 60 fields 0x0d (IP Filters Support) and 0x0e (LLC Filters Support) for CableLabs DOCSIS 2.0 CMs
 - rename PKT_CM_* variables to have a DOCS_CM prefix instead (overdue, as indicated by an existing comment)
 - update specification references


r17877:
User: jake
Date: 2006/04/16 05:03 PM

Log:
 From Steve Karg:
 1) BACnet signed values were being decoded incorrectly for negative
 values since BACnet tries to be clever and minimizes the number of bytes
 sent on the wire and drops the leading FF on negative values.  For
 example, -200 is passed as FF 38 on the wire, but would display as 65336.
 2) Since the BACnet unsigned values were decoded using a 64-bit entity,
 I changed the decoding such that allows all 8 bytes to be decoded.  The
 function can now decode 5, 6, and 7 byte values.
 3) Corrected warning about signed/unsigned in a pointer parameter.

------------------------------------------------------------------------
r17898 | gerald | 2006-04-18 15:36:59 -0500 (Tue, 18 Apr 2006) | 31 lines
Changed paths:
   M /trunk-1.0/epan/dissectors/packet-giop.c
   M /trunk-1.0/ethereal_gen.py
   M /trunk-1.0/plugins/giop/packet-coseventcomm.c
   M /trunk-1.0/plugins/giop/packet-cosnaming.c
   M /trunk-1.0/plugins/giop/packet-parlay.c
   M /trunk-1.0/plugins/giop/packet-tango.c

Copy over GIOP-related fixes from the trunk.

r17880:
User: etxrab
Date: 2006/04/16 06:16 PM

Log:
 From W. Borgert:
 the attached patch enables the explicit GIOP dissection. This fixes erronous decoding, if methods of two different CORBA interfaces have the same name, which happens frequently.
 
 The generated GIOP plugins (CosEvent, CosNaming, Parlay, Tango) need to be re-generated to make use of the fix.


r17885:
User: etxrab
Date: 2006/04/17 01:12 PM

Log:
 From W. Borgert:
 - Regenerated files.
 - Use .sort() on one or two of the lists in ethereal_gen.py to make generated files
   more diff-friendly in the future.

User: jake
Date: 2006/04/18 05:04 AM

Log:
 From W. Borgert:
 Currently, the filename IOR.txt is hardcoded into ethereal.
 The patch allows the user to change it. Thanks for applying!

------------------------------------------------------------------------
r17897 | gerald | 2006-04-18 15:29:49 -0500 (Tue, 18 Apr 2006) | 26 lines
Changed paths:
   M /trunk-1.0/epan/dissectors/packet-bssgp.c
   M /trunk-1.0/epan/dissectors/packet-gsm_a.c
   M /trunk-1.0/plugins/megaco/packet-megaco.c

Fixes and updates from the trunk:

r17868:
User: etxrab
Date: 2006/04/15 01:41 PM

Log:
 Add some missing commands.  (megaco)


r17875:
User: etxrab
Date: 2006/04/16 02:14 PM

Log:
 bssgp - handle LLC PDU of 0 length.
 Gsm_a - radio pri included in Modify PDP context request.


r17878:
User: etxrab
Date: 2006/04/16 05:48 PM

Log:
 Calculate Timezone correctly fixes http://bugs.ethereal.com/bugzilla/show_bug.cgi?id=876

------------------------------------------------------------------------
r17896 | gerald | 2006-04-18 15:06:11 -0500 (Tue, 18 Apr 2006) | 36 lines
Changed paths:
   M /trunk-1.0/epan/dissectors/packet-frame.c
   M /trunk-1.0/gtk/win32-file-dlg.c
   M /trunk-1.0/wiretap/network_instruments.c
   M /trunk-1.0/wiretap/network_instruments.h

Copy over fixes from the trunk:

r17860:
User: ulfl
Date: 2006/04/14 03:50 AM

Log:
 bugfix: don't crash with a Null pointer exception, if the open file preview timestamp can't be converted


r17861:
User: guy
Date: 2006/04/14 05:22 AM

Log:
 Skip non-data records.  Fixes bug 767.


r17865:
User: ulfl
Date: 2006/04/14 08:32 AM

Log:
 fix #865: if the timestamps fraction (m/u/nsec) of a packet is out of range (<0 or >1000000000) add a generated line to the protocol tree and a corresponding expert info entry
 
 A special marker in the packet list would be too much effort to implement


r17874:
User: guy
Date: 2006/04/16 05:54 AM

Log:
 The code to read hcidump files sets the p2p pseudo-header for
 WTAP_ENCAP_BLUETOOTH_H4.

------------------------------------------------------------------------
r17857 | gerald | 2006-04-13 16:39:45 -0500 (Thu, 13 Apr 2006) | 11 lines
Changed paths:
   M /trunk-1.0/epan/dissectors/packet-frame.c
   M /trunk-1.0/manuf

Copy over revisions 17855 and 17856 from the trunk:

17855 (manuf):
 Update to current IEEE list

17856 (packet-frame.c):
 Pass the right tree argument to the DOCSIS dissector if "treat all
 frames as DOCSIS" was selected.  Fixes bug 872.



------------------------------------------------------------------------
r17854 | gerald | 2006-04-12 16:22:57 -0500 (Wed, 12 Apr 2006) | 2 lines
Changed paths:
   A /trunk-1.0 (from /trunk:17848)
   R /trunk-1.0/config.nmake (from /trunk/config.nmake:17849)
   R /trunk-1.0/configure.in (from /trunk/configure.in:17849)

Populate the 1.0 trunk.

------------------------------------------------------------------------
r17848 | gerald | 2006-04-12 15:52:09 -0500 (Wed, 12 Apr 2006) | 2 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

Add a few entries to the "Known Bugs" section.

------------------------------------------------------------------------
r17847 | gerald | 2006-04-12 15:36:31 -0500 (Wed, 12 Apr 2006) | 2 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/config.nmake
   M /trunk/tools/win32-setup.sh

Update Lua.

------------------------------------------------------------------------
r17846 | jake | 2006-04-10 12:24:14 -0500 (Mon, 10 Apr 2006) | 2 lines
Changed paths:
   M /trunk/gtk/capture_if_dlg.c

Add 2px height to avoid a vertical scrollbar with Gtk-Wimp

------------------------------------------------------------------------
r17845 | ulfl | 2006-04-09 20:34:23 -0500 (Sun, 09 Apr 2006) | 1 line
Changed paths:
   M /trunk/capture_wpcap_packet.c

fix #868: don't assert but simply ignore values that don't have the proper size
------------------------------------------------------------------------
r17844 | jake | 2006-04-08 15:19:40 -0500 (Sat, 08 Apr 2006) | 2 lines
Changed paths:
   M /trunk/gtk/capture_if_dlg.c

Fix for bug 848. Make a scrollable window when more than 10 interfaces are listed.

------------------------------------------------------------------------
r17843 | etxrab | 2006-04-08 08:03:18 -0500 (Sat, 08 Apr 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ucp.c

Fix bug 597:
- Add TCP reassembly to get the proper packet length
- Add "result = check_ucp(tvb, &endpkt);" in dissect_udp_commong to fill some variables used.
------------------------------------------------------------------------
r17842 | ulfl | 2006-04-07 19:20:00 -0500 (Fri, 07 Apr 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-dcom-dispatch.h

set SVN properties correct "when will I ever learn" :-(
------------------------------------------------------------------------
r17841 | ulfl | 2006-04-07 19:17:51 -0500 (Fri, 07 Apr 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/Makefile.common

add packet-dcom-dispatch.h
------------------------------------------------------------------------
r17840 | ulfl | 2006-04-07 17:05:34 -0500 (Fri, 07 Apr 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-dcom.c

bring HRESULT values in the right order
------------------------------------------------------------------------
r17839 | ulfl | 2006-04-07 17:03:58 -0500 (Fri, 07 Apr 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-dcom-cba.c
   M /trunk/epan/dissectors/packet-dcom-dispatch.c
   A /trunk/epan/dissectors/packet-dcom-dispatch.h

some of the CBA interfaces are actually derived from IDispatch, dissect the methods accordingly
------------------------------------------------------------------------
r17838 | sahlberg | 2006-04-07 05:15:15 -0500 (Fri, 07 Apr 2006) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fcp.c
   M /trunk/epan/dissectors/packet-iscsi.c
   M /trunk/epan/dissectors/packet-ndmp.c
   M /trunk/epan/dissectors/packet-scsi.c
   M /trunk/epan/dissectors/packet-scsi.h

make dissect_scsi_rsp() take an exchange structure as parameter instead of just a lun.

this finally allows us to have scsi.time  for scsi transactions   but we need to cleanup and refactor the other three scsi entrypoints before we should implement scsi srt    to make the other three also take an exchange data structure as parameter from their transports (and get rid of the pinfo->private_data )


------------------------------------------------------------------------
r17837 | etxrab | 2006-04-06 15:50:48 -0500 (Thu, 06 Apr 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sccp.c

Fix bug 851
------------------------------------------------------------------------
r17836 | jake | 2006-04-06 15:47:22 -0500 (Thu, 06 Apr 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtcp.c

Better read NTP LSW from the right spot

------------------------------------------------------------------------
r17835 | guy | 2006-04-06 15:07:16 -0500 (Thu, 06 Apr 2006) | 2 lines
Changed paths:
   M /trunk/dftest.c

Handle a filter that evaluates to an empty "matches everything" filter.

------------------------------------------------------------------------
r17834 | jake | 2006-04-06 08:30:45 -0500 (Thu, 06 Apr 2006) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtcp.c
   M /trunk/epan/dissectors/packet-rtcp.h

From: Martin Mathieson
- fixes bug 863 (RTCP sender report's NTP time display incorrect - use using wrong bytes)
- makes NTP timestamp MSW and LSW proper filterable fields, displaying them in dec and hex
- when doing roundtrip calculations, rationalise fields added, add link to LSR frame whenever it matches

------------------------------------------------------------------------
r17833 | sahlberg | 2006-04-06 06:05:18 -0500 (Thu, 06 Apr 2006) | 12 lines
Changed paths:
   M /trunk/epan/dissectors/packet-iscsi.c

change iscsi to track transaction data in a fc_exchange_data structure   just as the fc / fcp transport does.


while reusing this structure for multi-purpose would make it berret suited to move the struct from packet-fc.h to packet-scsi.h
we would have to include packet-scsi.h   for everyone that includes packet-fc.h  and that are a few dependencies.
(would have to include it even in packet-llc.c)

so leave it as a fc structure for now.




------------------------------------------------------------------------
r17832 | sahlberg | 2006-04-06 05:41:49 -0500 (Thu, 06 Apr 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-iscsi.c

remove the hashtables for pdu tracking and replace with an se_tree
indexed by itt


------------------------------------------------------------------------
r17831 | sahlberg | 2006-04-06 04:47:31 -0500 (Thu, 06 Apr 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-iscsi.c

attach the iscsi_session to the conversation instead of using a hashtable to map conversation to iscsi_session.

use the pointer to iscsi_Session  as conversation index for the exchange tracking for now,   it works just as well   and will be replaced with better exchange tracking shortly  anyway



------------------------------------------------------------------------
r17830 | sahlberg | 2006-04-06 04:16:10 -0500 (Thu, 06 Apr 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-iscsi.c

get rid of a field we are not using


------------------------------------------------------------------------
r17829 | sahlberg | 2006-04-06 03:33:08 -0500 (Thu, 06 Apr 2006) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fc.c
   M /trunk/epan/dissectors/packet-fc.h

add a field for storing the scsi opcode in the exchange struct.

it is silly that scsi has to track these things itself  when all the transports
already keep track of exchanges.

the scsi transports should all use the fc_exchange_data structure to pass lun to scsi and where scsi kan store the opcode between requests and data/response packets




------------------------------------------------------------------------
r17828 | etxrab | 2006-04-06 00:09:45 -0500 (Thu, 06 Apr 2006) | 2 lines
Changed paths:
   A /trunk/asn1/pkix1explicit/pkix1explicit-exp.cnf
   A /trunk/asn1/pkix1implicit/pkix1implicit-exp.cnf
   M /trunk/asn1/tcap/tcap.asn

Add two missing *-exp.cnf files
tcap.asn - whitespace changes
------------------------------------------------------------------------
r17827 | sahlberg | 2006-04-05 22:15:16 -0500 (Wed, 05 Apr 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fc.c
   M /trunk/epan/dissectors/packet-fc.h
   M /trunk/epan/dissectors/packet-fcp.c

use the fc exchange structure to track LUN values from fcp command  all the way through to the response
and get rid of the broken hashtable used for the same purpose previously.

some additional cleanups.


------------------------------------------------------------------------
r17826 | sahlberg | 2006-04-05 21:46:41 -0500 (Wed, 05 Apr 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fcp.c

use the fc exchange data to track fcp response times


------------------------------------------------------------------------
r17825 | sahlberg | 2006-04-05 21:15:41 -0500 (Wed, 05 Apr 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fc.c

make fc pass the fchdr structure as pinfo->private data to higher layer protocols


------------------------------------------------------------------------
r17824 | sahlberg | 2006-04-05 21:04:22 -0500 (Wed, 05 Apr 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fcp.c

remove another field from a structure that we never use.


------------------------------------------------------------------------
r17823 | sahlberg | 2006-04-05 20:17:36 -0500 (Wed, 05 Apr 2006) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fcp.c

remove a field we no longer use in this dissector from the conversation structure.




------------------------------------------------------------------------
r17822 | sahlberg | 2006-04-05 20:16:23 -0500 (Wed, 05 Apr 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fcp.c

move conversation tracking out from the type specific subdissectors and track them in the main entry point for the protocol dissector instead.

this is semi-temporary though since FCP will always sit ontop of FC which also tracks the same conversations  so there is no need to do a redundant conversation tracking in fcp itself.



------------------------------------------------------------------------
r17821 | sahlberg | 2006-04-05 18:33:35 -0500 (Wed, 05 Apr 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

decode the first two bytes of the negotiate protocol request as buffercode


------------------------------------------------------------------------
r17820 | sahlberg | 2006-04-05 16:38:41 -0500 (Wed, 05 Apr 2006) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c
   M /trunk/epan/dissectors/packet-smb2.h

from metze


dissect smb2 break responses   used by a server to break an oplock


these unsolicited responses are sent with a commandseqnum of -1   so mark these in the header as unsolicited as well



------------------------------------------------------------------------
r17819 | tuexen | 2006-04-05 15:24:48 -0500 (Wed, 05 Apr 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sctp.c
   M /trunk/epan/sctpppids.h

Update PPIDs to latest IANA regsitration status.

------------------------------------------------------------------------
r17818 | etxrab | 2006-04-05 13:54:43 -0500 (Wed, 05 Apr 2006) | 1 line
Changed paths:
   M /trunk/asn1/gsmmap/gsm_map-exp.cnf
   M /trunk/asn1/gsmmap/gsmmap.cnf
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-gsm_map.h
   M /trunk/epan/dissectors/packet-gtp.c

Expand some value strings, get map_error from gsm_map use the added IE's.
------------------------------------------------------------------------
r17817 | etxrab | 2006-04-05 11:05:29 -0500 (Wed, 05 Apr 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

Add some IE:s
------------------------------------------------------------------------
r17816 | etxrab | 2006-04-05 11:04:46 -0500 (Wed, 05 Apr 2006) | 7 lines
Changed paths:
   M /trunk/plugins/mgcp/packet-mgcp.c

From Martin Mathieson:
This patch fixes the decode problem mentioned in this bug report:

"3. Frames 9 and 13 are only partially decoded and show up as "Packet size limited during capture" It looks like the decode chokes on the DQ-RI line."

DQ-RI is a localconnectionoptions parameter and shouldn't appear as a top-level parameter. This patch makes sure that all of the single-character top-level parmeter codes are followed immediately by a ':'.

------------------------------------------------------------------------
r17815 | etxrab | 2006-04-05 11:03:36 -0500 (Wed, 05 Apr 2006) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mtp3.c
   M /trunk/epan/dissectors/packet-mtp3.h
   M /trunk/epan/dissectors/packet-mtp3mg.c
   M /trunk/epan/dissectors/packet-sccp.c
   M /trunk/epan/dissectors/packet-sccpmg.c

Frof Jeff Morriss:
The attached patch adds support for the Japan SS7 variants (TTC/NTT) to 
the MTP3, MTP3MG, SCCP, and SCCPMG dissectors.  It's not as thoroughly 
implemented nor tested as I'd like, but it does a good job of at least 
the basic dissection and I'm out of time for now.

It also fixes bug I found in the SCCP dissector where it would show an 
End of Optional parameter even when the Optional pointer was 0.

------------------------------------------------------------------------
r17814 | sahlberg | 2006-04-05 05:07:49 -0500 (Wed, 05 Apr 2006) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fcp.c

from previous commit



dont dereference cdata null pointer


------------------------------------------------------------------------
r17813 | sahlberg | 2006-04-05 04:51:14 -0500 (Wed, 05 Apr 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fcp.c

create the protocol tree in the main function and not down in the individual helper functions



------------------------------------------------------------------------
r17812 | sahlberg | 2006-04-05 03:58:16 -0500 (Wed, 05 Apr 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fcp.c

remove some crap


------------------------------------------------------------------------
r17811 | sahlberg | 2006-04-05 03:51:45 -0500 (Wed, 05 Apr 2006) | 17 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fcp.c
   M /trunk/epan/dissectors/packet-scsi.c

imake fcp responses    that do carry a scsi response code
call the scsi response dissector as well
(so that eventually we can do things like SRT for SCSI)


it doesnt work yet since fcp is using some incredibly broken logic to
track state between frames.

the cdata stuff can just not ever work exscept for single scan tethereal dissection.
is there noone at all looking at these protocols wioth ethereal?
has noone noticed it is completely broken yet?


sigh,    soon   i think i will be able to add the originally estimated trivial to implement   SCSI SRT



------------------------------------------------------------------------
r17810 | sahlberg | 2006-04-05 02:25:57 -0500 (Wed, 05 Apr 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi.c

make reportluns use the new macros to catch and flag alloclen truncation


------------------------------------------------------------------------
r17809 | sahlberg | 2006-04-05 00:51:51 -0500 (Wed, 05 Apr 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fc.c
   M /trunk/epan/dissectors/packet-fc.h

cleaning up bits and pieces

replacing the hashtables with a better exchange   se_tree



------------------------------------------------------------------------
r17808 | etxrab | 2006-04-05 00:05:42 -0500 (Wed, 05 Apr 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-lge_monitor.c

Add a dissector for Nortels LGE Monitor protocol.
------------------------------------------------------------------------
r17807 | sahlberg | 2006-04-04 20:17:32 -0500 (Tue, 04 Apr 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fcp.c

add dissection of the fcp response   bidir read residual field



------------------------------------------------------------------------
r17806 | sahlberg | 2006-04-04 17:22:18 -0500 (Tue, 04 Apr 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fcp.h

move some arrays from the header to fcp.c


------------------------------------------------------------------------
r17805 | sahlberg | 2006-04-04 17:21:48 -0500 (Tue, 04 Apr 2006) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fcp.c

refactoring of the fcp response dissector


add missing flags to the dissection   and during refactoring fix several things that just can not have worked previously.




------------------------------------------------------------------------
r17804 | sahlberg | 2006-04-04 06:58:56 -0500 (Tue, 04 Apr 2006) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ifcp.c

major refactoring of the ifcp dissector.

remove the port preference setting and replace it with strong heuristics instead
(attempt but fail to set a conversation dissector when the heuristics and the dissection match)

use tcp_dissect_pdus() for reassembly and pdu tracking and get rid of the try-to-step-through-the-pdu-to-find-where-the-next-pdu-starts thing.




------------------------------------------------------------------------
r17803 | tuexen | 2006-04-04 04:04:08 -0500 (Tue, 04 Apr 2006) | 2 lines
Changed paths:
   M /trunk/gtk/sctp_assoc_analyse.c

From Irene: Make buttons unselecable when nothing would happen.

------------------------------------------------------------------------
r17802 | sahlberg | 2006-04-04 02:53:39 -0500 (Tue, 04 Apr 2006) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gssapi.c

fix for bug #856

dont try to lookup a NULL string since this string will be dereferenced
in the ghashtable   hash callback



------------------------------------------------------------------------
r17801 | sahlberg | 2006-04-03 15:39:55 -0500 (Mon, 03 Apr 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi.c

dislay a flags field as "Flags" instead of "SCCS Flags"


------------------------------------------------------------------------
r17800 | sahlberg | 2006-04-03 15:29:53 -0500 (Mon, 03 Apr 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi.c

use col_set_fence() after we have populated the info column with the SCSI details   so that if there are other pdus followinf this scsi pdu in the packet they will not overwrite it



------------------------------------------------------------------------
r17799 | sahlberg | 2006-04-03 15:12:24 -0500 (Mon, 03 Apr 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi.c

add dissection of the inq sync flag
sort the entries in scsi_verdesc_val   so it is easier to add missing entries


------------------------------------------------------------------------
r17798 | etxrab | 2006-04-03 14:07:52 -0500 (Mon, 03 Apr 2006) | 2 lines
Changed paths:
   M /trunk/asn1/ftam/ISO8571-FTAM.asn
   M /trunk/asn1/ftam/ftam.cnf
   M /trunk/asn1/ftam/packet-ftam-template.c
   M /trunk/epan/dissectors/packet-ftam.c
   M /trunk/epan/dissectors/packet-ftam.h

Fix bug http://bugs.ethereal.com/bugzilla/show_bug.cgi?id=850 problems with tagged assignments.
Add som OID names. 
------------------------------------------------------------------------
r17797 | gerald | 2006-04-03 09:44:56 -0500 (Mon, 03 Apr 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ncp2222.inc

Add a null pointer check.  Fixes the current Buildbot menagerie failure.

------------------------------------------------------------------------
r17796 | sahlberg | 2006-04-03 03:55:04 -0500 (Mon, 03 Apr 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-kerberos.c

a krb_error pdu with the error_code   ERR_CLIENT_REVOKED
issued by ms kdc contains a PA_DATA structure with a salt that contains an
nt_status code explaining why the client was not allowed to get a (tgt) ticket



------------------------------------------------------------------------
r17795 | sahlberg | 2006-04-03 03:20:54 -0500 (Mon, 03 Apr 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi.c

further prettification of the inq dissector.

further refactorinf of  the scsi  alloc_len macros



------------------------------------------------------------------------
r17794 | sahlberg | 2006-04-02 22:19:52 -0500 (Sun, 02 Apr 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi.c

dissect byte 7 of the inq response


------------------------------------------------------------------------
r17793 | guy | 2006-04-02 22:15:29 -0500 (Sun, 02 Apr 2006) | 2 lines
Changed paths:
   M /trunk/dumpcap.c

Don't report the interface name unconditionally.

------------------------------------------------------------------------
r17792 | guy | 2006-04-02 22:12:32 -0500 (Sun, 02 Apr 2006) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Set the right structure member.

------------------------------------------------------------------------
r17791 | sahlberg | 2006-04-02 21:40:07 -0500 (Sun, 02 Apr 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi.c

add dissection of byte 6 of inq response
(except fopr 3 bits that only exist for pscsi)


------------------------------------------------------------------------
r17790 | guy | 2006-04-02 20:58:43 -0500 (Sun, 02 Apr 2006) | 2 lines
Changed paths:
   M /trunk/capture_sync.c

Clean up if CreateProcess() fails. 

------------------------------------------------------------------------
r17789 | guy | 2006-04-02 20:56:53 -0500 (Sun, 02 Apr 2006) | 7 lines
Changed paths:
   M /trunk/Makefile.common
   M /trunk/capture_loop.c
   M /trunk/capture_loop.h
   M /trunk/capture_sync.c
   M /trunk/capture_sync.h
   M /trunk/dumpcap.c
   A /trunk/sync_pipe.h
   A /trunk/sync_pipe_write.c
   M /trunk/tethereal.c

Put the low-level sync routines into a common file so they can be shared
by dumpcap and Ethereal (so that, on UN*X, the child process can report
a detailed "can't exec dumpcap" error).

Rename most of the "sync_pipe_XXX_to_parent()" routines, as they're also
in Tethereal, which doesn't have a sync pipe.

------------------------------------------------------------------------
r17788 | sahlberg | 2006-04-02 20:44:56 -0500 (Sun, 02 Apr 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi.c

add dissection of the flags in byte 5 of the inquiry response



------------------------------------------------------------------------
r17787 | sahlberg | 2006-04-02 19:55:21 -0500 (Sun, 02 Apr 2006) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi.c

prettify dissection of the aca flags byte in the inq response data.

add dissection of two additional bits and the respdataformat bitvield

add booleans for the filter fields

make all the fields filterable



------------------------------------------------------------------------
r17786 | guy | 2006-04-02 19:52:59 -0500 (Sun, 02 Apr 2006) | 14 lines
Changed paths:
   M /trunk/capture_loop.c
   M /trunk/capture_opts.c
   M /trunk/capture_opts.h
   M /trunk/dumpcap.c
   M /trunk/gtk/capture_dlg.c
   M /trunk/tethereal.c

In Tethereal, don't save to a temporary file if "-w" isn't specified,
even if doing a live capture; just print the packets without saving
them.

In dumpcap:

	default to the capturing the entire packet;

	don't do the "Press any key" stuff when debugging on UN*X;

	do console logging (to the standard error) even when we're
	running as the capture child (the sync pipe should only be the
	standard output, not the standard error).

------------------------------------------------------------------------
r17785 | sahlberg | 2006-04-02 18:24:00 -0500 (Sun, 02 Apr 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nfs.c

the hash,name,fullname of an nfs filehandle are all
generated items

mark them as generated items in the dissect pane


------------------------------------------------------------------------
r17784 | sahlberg | 2006-04-02 17:50:46 -0500 (Sun, 02 Apr 2006) | 17 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi.c

 change TRY_SCSI_SHORT_TRANSFER   to use the allocation length specified in the CDB
instead of the allocation length from the data pdu   since sometimes the datapdu will be completely empty and thus we cant extract it from the data pdu.
(unclear if this is really allowed by scsi   but anyway)
this should make the scsi transfer length checking more correct.


update mmc  getconfiguration   and spc  inquiry  to use these macros
and flag these packets that are short due to a too small alloc_len
as truncated due to scsi  and not being short/malformed packets.


at the same time,  get rid of a few horrible   offset+x   in the inquiry dissector and replace with proper offset incrementation instead.





------------------------------------------------------------------------
r17783 | sahlberg | 2006-04-02 16:04:11 -0500 (Sun, 02 Apr 2006) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nfs.c
   M /trunk/epan/dissectors/packet-nfs.h
   M /trunk/epan/dissectors/packet-nfsacl.c

prettify dissection of nfsv3 fattr3 structure

put useful info like type,mode,uid,gid on the expansion lines so we dont have to open the expansion to see these values.

allow it to push this info multiple expansion lines upward
and optionally (such as for GETATTR replies) put this info in the info column as well




------------------------------------------------------------------------
r17782 | etxrab | 2006-04-02 14:38:36 -0500 (Sun, 02 Apr 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ms-mms.c

From Martin Mathieson:
Removes the use of the deprecated proto_tree_add_item_hidden() function

I was adding the 'msmms.command.unknown' field in lots of places (a 
habit of mine in my own dissectors), but this probably isn't useful.

------------------------------------------------------------------------
r17781 | etxrab | 2006-04-02 14:37:12 -0500 (Sun, 02 Apr 2006) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ncp2222.inc

From Greg Morris:
Fixes bug 830
Adds a few more expert info details.
 

------------------------------------------------------------------------
r17780 | etxrab | 2006-03-30 23:11:57 -0600 (Thu, 30 Mar 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi.c

From Ming Zhang:
fix a minor error in mode_select, packet-scsi.c

------------------------------------------------------------------------
r17779 | etxrab | 2006-03-30 23:09:37 -0600 (Thu, 30 Mar 2006) | 5 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-mpls.c
   M /trunk/epan/dissectors/packet-mpls.h

From Francesco Fondelli:

you find attached a patch for dissecting MPLS OAM pdus
as defind in Y.1711 ITU-T doc.

------------------------------------------------------------------------
r17778 | tuexen | 2006-03-30 16:17:42 -0600 (Thu, 30 Mar 2006) | 3 lines
Changed paths:
   M /trunk/gtk/sctp_byte_graph_dlg.c
   M /trunk/gtk/sctp_graph_dlg.c
   M /trunk/gtk/sctp_stat.c
   M /trunk/gtk/sctp_stat.h

From Irene: Fix problems with off screen drawings
            Make rectangle clickable.

------------------------------------------------------------------------
r17777 | lego | 2006-03-30 14:29:36 -0600 (Thu, 30 Mar 2006) | 3 lines
Changed paths:
   M /trunk/gtk/stats_tree_stat.c

fix for  Bug 849


------------------------------------------------------------------------
r17776 | lego | 2006-03-30 14:15:59 -0600 (Thu, 30 Mar 2006) | 3 lines
Changed paths:
   M /trunk/gtk/funnel_stat.c

remove some useless code.


------------------------------------------------------------------------
r17775 | lego | 2006-03-30 13:56:33 -0600 (Thu, 30 Mar 2006) | 3 lines
Changed paths:
   M /trunk/packaging/nsis/ethereal.nsi

Delete init.lua when asked to delete global settings.


------------------------------------------------------------------------
r17774 | lego | 2006-03-30 13:48:05 -0600 (Thu, 30 Mar 2006) | 3 lines
Changed paths:
   M /trunk/plugins/lua/elua_field.c

Fix FieldInfo and add an attribute  for the filter name.


------------------------------------------------------------------------
r17773 | lego | 2006-03-30 13:42:49 -0600 (Thu, 30 Mar 2006) | 7 lines
Changed paths:
   M /trunk/epan/funnel.h
   M /trunk/gtk/funnel_stat.c
   M /trunk/plugins/lua/elua_gui.c
   M /trunk/tap-funnel.c

TextWindow:
  - add buttons
  - make editable




------------------------------------------------------------------------
r17772 | etxrab | 2006-03-30 10:46:36 -0600 (Thu, 30 Mar 2006) | 1 line
Changed paths:
   M /trunk/asn1/MAP_Dialogue/Makefile.nmake
   M /trunk/asn1/Makefile.nmake
   M /trunk/asn1/cmip/Makefile.nmake
   M /trunk/asn1/ftam/Makefile.nmake
   M /trunk/asn1/ftbp/Makefile.nmake
   M /trunk/asn1/gnm/Makefile.nmake
   M /trunk/asn1/gsm_ss/Makefile.nmake
   M /trunk/asn1/gsmmap/GSMMAP.asn
   M /trunk/asn1/gsmmap/gsmmap.cnf
   M /trunk/asn1/gsmmap/packet-gsm_map-template.c
   M /trunk/asn1/gsmmap/packet-gsm_map-template.h
   M /trunk/asn1/logotype-cert-extn/Makefile.nmake
   M /trunk/asn1/mms/Makefile.nmake
   M /trunk/asn1/ns-cert-exts/Makefile.nmake
   M /trunk/asn1/ocsp/Makefile.nmake
   M /trunk/asn1/smrse/Makefile.nmake
   M /trunk/asn1/spnego/Makefile.nmake
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-gsm_map.h

call OID subdissector for private extensiions,  fix makefiles.
------------------------------------------------------------------------
r17771 | gerald | 2006-03-30 10:13:37 -0600 (Thu, 30 Mar 2006) | 2 lines
Changed paths:
   M /trunk/asn1/gsmmap/gsmmap.cnf
   M /trunk/docbook/release-notes.xml
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-gsm_map.h

Fix an off-by-one error.

------------------------------------------------------------------------
r17770 | gerald | 2006-03-30 09:34:18 -0600 (Thu, 30 Mar 2006) | 2 lines
Changed paths:
   M /trunk/docbook/release-notes.xml
   M /trunk/plugins/asn1/packet-asn1.c

Continue to play whack-a-mole with null dereferences.  Fixes CID 146.

------------------------------------------------------------------------
r17769 | jake | 2006-03-30 04:16:35 -0600 (Thu, 30 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-http.c

Update status codes from RFC 2616 and RFC 2518
------------------------------------------------------------------------
r17768 | jake | 2006-03-30 03:33:39 -0600 (Thu, 30 Mar 2006) | 1 line
Changed paths:
   M /trunk/plugins/Makefile.nmake

Undoing commit of private makefile in r17765
------------------------------------------------------------------------
r17767 | jmayer | 2006-03-30 01:44:03 -0600 (Thu, 30 Mar 2006) | 6 lines
Changed paths:
   M /trunk/tools/pidl/TODO
   M /trunk/tools/pidl/lib/Parse/Pidl/Compat.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/NDR.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba3/Client.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba3/Header.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba3/Parser.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba3/Template.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba3/Types.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba4/COM/Header.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba4/COM/Proxy.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba4/EJS.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba4/Header.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba4/NDR/Client.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba4/NDR/Parser.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba4/NDR/Server.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba4/TDR.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Typelist.pm
   M /trunk/tools/pidl/pidl
   M /trunk/tools/pidl/tests/Util.pm
   M /trunk/tools/pidl/tests/ndr_align.pl
   M /trunk/tools/pidl/tests/ndr_refptr.pl

Update from samba tree revision 13374 to 14805
============================ Samba log start ============
svn: When specifying working copy paths, only one target may be given
============================ Samba log end ==============


------------------------------------------------------------------------
r17766 | etxrab | 2006-03-29 23:02:06 -0600 (Wed, 29 Mar 2006) | 12 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

From Martin Mathieson:
> > This patch adds a hidden 'sip.auth' field, that will be present 
> > whenever one of the authenticiation/authorization headers is 
> > present.
> >
> > I believe this is one place where hidden fields are justified:
> > - it is a substring of several sip.auth.* fields, so its reassuring 
> > to see the field turn green as you're typing in one of the visible 
> > fields
> > - it lets you quickly find all of the frames with any of these fields
> > (there are 4 different SIP headers that can contain the auth fields)

------------------------------------------------------------------------
r17765 | etxrab | 2006-03-29 22:58:06 -0600 (Wed, 29 Mar 2006) | 12 lines
Changed paths:
   M /trunk/mergecap.c
   M /trunk/plugins/Makefile.nmake
   M /trunk/wiretap/README.developer
   M /trunk/wiretap/wtap.c

From Martin Mathieson:

wiretap/README.developer
- the referenced default seek_read function doesn't exist now

wiretap/wtap.c
- a "hole" in encap_table was causing the wrong encap value for later 
types to be looked up (by name)

mergecap.c
- fix a couple of program name copy+paste errors from editcap.c

------------------------------------------------------------------------
r17764 | guy | 2006-03-29 16:11:42 -0600 (Wed, 29 Mar 2006) | 2 lines
Changed paths:
   M /trunk/asn1/x411/packet-x411-template.c
   M /trunk/epan/dissectors/packet-x411.c

Get rid of an unused variable.

------------------------------------------------------------------------
r17763 | guy | 2006-03-29 16:05:57 -0600 (Wed, 29 Mar 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-3g-a11.c

Get rid of some unused variables.

------------------------------------------------------------------------
r17762 | guy | 2006-03-29 16:04:37 -0600 (Wed, 29 Mar 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icmpv6.c

Get rid of an unused function argument.

Clean up indentation.

------------------------------------------------------------------------
r17761 | guy | 2006-03-29 16:03:21 -0600 (Wed, 29 Mar 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a.c

Close a comment to squelch a compiler warning.

------------------------------------------------------------------------
r17760 | guy | 2006-03-29 15:57:58 -0600 (Wed, 29 Mar 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tipc.c

Squelch a compiler warning (for a problem that can't happen).

Fix up indentaton.

------------------------------------------------------------------------
r17759 | guy | 2006-03-29 15:54:22 -0600 (Wed, 29 Mar 2006) | 2 lines
Changed paths:
   M /trunk/epan/to_str.c

Squelch a compiler warning.

------------------------------------------------------------------------
r17758 | guy | 2006-03-29 15:53:26 -0600 (Wed, 29 Mar 2006) | 2 lines
Changed paths:
   M /trunk/epan/proto.c

Squelch a compiler warning (for a problem that doesn't actually occur).

------------------------------------------------------------------------
r17757 | etxrab | 2006-03-29 11:00:16 -0600 (Wed, 29 Mar 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gre.c
   M /trunk/epan/dissectors/packet-sccp.c

sccp - fix a typo
gre - fix a length error, and change the way to display 3GPP atributes.
------------------------------------------------------------------------
r17756 | jake | 2006-03-29 10:06:57 -0600 (Wed, 29 Mar 2006) | 3 lines
Changed paths:
   M /trunk/wiretap/iseries.c

The header will be there, just make sure the date is put in.
Coverity bug 148

------------------------------------------------------------------------
r17755 | jake | 2006-03-29 04:03:50 -0600 (Wed, 29 Mar 2006) | 1 line
Changed paths:
   M /trunk/plugins/lua/Makefile.nmake

Get elua to build on IA32
------------------------------------------------------------------------
r17754 | gerald | 2006-03-28 17:06:11 -0600 (Tue, 28 Mar 2006) | 3 lines
Changed paths:
   M /trunk/gtk/win32-file-dlg.c
   M /trunk/image/win32-file-dlg.rc

Make sure the export dialog is large enough.  Fix a Unicode issue while
we're at it.

------------------------------------------------------------------------
r17753 | jake | 2006-03-28 15:03:01 -0600 (Tue, 28 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-scsi.c

From Ming Zhang: the track # in read toc command dissector should be 1 instead of 4.
------------------------------------------------------------------------
r17752 | jake | 2006-03-28 14:54:59 -0600 (Tue, 28 Mar 2006) | 1 line
Changed paths:
   M /trunk/asn1/pkixcmp/packet-cmp-template.c
   M /trunk/epan/dissectors/packet-cmp.c

Function should return a value.
------------------------------------------------------------------------
r17751 | gerald | 2006-03-28 13:25:48 -0600 (Tue, 28 Mar 2006) | 2 lines
Changed paths:
   M /trunk/plugins/lua/Makefile.nmake
   M /trunk/plugins/lua/elua_field.c

Fix compilation under Windows.

------------------------------------------------------------------------
r17750 | kukosa | 2006-03-28 04:35:26 -0600 (Tue, 28 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/libethereal.def

exort functions related to bitfield and GUID
------------------------------------------------------------------------
r17749 | lego | 2006-03-27 16:47:20 -0600 (Mon, 27 Mar 2006) | 3 lines
Changed paths:
   M /trunk/plugins/lua/Makefile.nmake

elua_field.c was added to $MODULES but not to $OBJECTS


------------------------------------------------------------------------
r17748 | lego | 2006-03-27 16:37:11 -0600 (Mon, 27 Mar 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipsec.c

Some compilers do not handle very long lines...
 Shouldn't this  preference description be somewhere else?


------------------------------------------------------------------------
r17747 | jake | 2006-03-27 15:00:16 -0600 (Mon, 27 Mar 2006) | 1 line
Changed paths:
   M /trunk/asn1/ansi_map/README
   M /trunk/asn1/h235/h235-exp.cnf
   M /trunk/asn1/snmp/README.txt
   M /trunk/docbook/edg_src/EDG_chapter_build_intro.xml
   M /trunk/docbook/edg_src/EDG_chapter_dissection.xml
   M /trunk/epan/dissectors/packet-acp133.h
   M /trunk/epan/dissectors/pidl/idl_types.h
   M /trunk/epan/dissectors/pidl/wkssvc.idl
   M /trunk/idl/parlay/README.parlay
   M /trunk/image/capinfos.rc.in
   M /trunk/image/clist_ascend.xpm
   M /trunk/image/clist_descend.xpm
   M /trunk/image/dn_arrow.xpm
   M /trunk/image/editcap.rc.in
   M /trunk/image/eexcl3d64.xpm
   M /trunk/image/eicon3d16.xpm
   M /trunk/image/eicon3d32.xpm
   M /trunk/image/eicon3d48.xpm
   M /trunk/image/eicon3d64.xpm
   M /trunk/image/eiconcap16.xpm
   M /trunk/image/eiconcap32.xpm
   M /trunk/image/eiconcap48.xpm
   M /trunk/image/ethereal.exe.manifest.in
   M /trunk/image/ethereal.rc.in
   M /trunk/image/icon-ethereal.xpm
   M /trunk/image/icon-excl.xpm
   M /trunk/image/icon_layout_1.xpm
   M /trunk/image/icon_layout_2.xpm
   M /trunk/image/icon_layout_3.xpm
   M /trunk/image/icon_layout_4.xpm
   M /trunk/image/icon_layout_5.xpm
   M /trunk/image/icon_layout_6.xpm
   M /trunk/image/libethereal.rc.in
   M /trunk/image/mergecap.rc.in
   M /trunk/image/stock_dialog_error_48.xpm
   M /trunk/image/stock_dialog_info_48.xpm
   M /trunk/image/stock_dialog_question_48.xpm
   M /trunk/image/stock_dialog_stop_48.xpm
   M /trunk/image/stock_dialog_warning_48.xpm
   M /trunk/image/toolbar/autoscroll_24.xpm
   M /trunk/image/toolbar/capture_filter_24.xpm
   M /trunk/image/toolbar/capture_interfaces_24.xpm
   M /trunk/image/toolbar/capture_options_24.xpm
   M /trunk/image/toolbar/capture_restart_24.xpm
   M /trunk/image/toolbar/capture_start_24.xpm
   M /trunk/image/toolbar/capture_stop_24.xpm
   M /trunk/image/toolbar/checkbox_16.xpm
   M /trunk/image/toolbar/colorize_24.xpm
   M /trunk/image/toolbar/conversations_16.xpm
   M /trunk/image/toolbar/decode_as_16.xpm
   M /trunk/image/toolbar/display_filter_24.xpm
   M /trunk/image/toolbar/endpoints_16.xpm
   M /trunk/image/toolbar/file_set_list_16.xpm
   M /trunk/image/toolbar/file_set_next_16.xpm
   M /trunk/image/toolbar/file_set_previous_16.xpm
   M /trunk/image/toolbar/graphs_16.xpm
   M /trunk/image/toolbar/internet_24.xpm
   M /trunk/image/toolbar/resize_columns_24.xpm
   M /trunk/image/toolbar/stock_add_24.xpm
   M /trunk/image/toolbar/stock_bottom_24.xpm
   M /trunk/image/toolbar/stock_clear_24.xpm
   M /trunk/image/toolbar/stock_close_24.xpm
   M /trunk/image/toolbar/stock_colorselector_24.xpm
   M /trunk/image/toolbar/stock_help_24.xpm
   M /trunk/image/toolbar/stock_jump_to_24.xpm
   M /trunk/image/toolbar/stock_left_arrow_24.xpm
   M /trunk/image/toolbar/stock_ok_20.xpm
   M /trunk/image/toolbar/stock_open_24.xpm
   M /trunk/image/toolbar/stock_preferences_24.xpm
   M /trunk/image/toolbar/stock_print_24.xpm
   M /trunk/image/toolbar/stock_properties_24.xpm
   M /trunk/image/toolbar/stock_refresh_24.xpm
   M /trunk/image/toolbar/stock_right_arrow_24.xpm
   M /trunk/image/toolbar/stock_save_24.xpm
   M /trunk/image/toolbar/stock_save_as_24.xpm
   M /trunk/image/toolbar/stock_search_24.xpm
   M /trunk/image/toolbar/stock_stop_24.xpm
   M /trunk/image/toolbar/stock_top_24.xpm
   M /trunk/image/toolbar/stock_zoom_1_24.xpm
   M /trunk/image/toolbar/stock_zoom_in_24.xpm
   M /trunk/image/toolbar/stock_zoom_out_24.xpm
   M /trunk/image/toolbar/telephony_16.xpm
   M /trunk/image/toolbar/time_24.xpm
   M /trunk/image/toolbar/web_support_24.xpm
   M /trunk/image/toolbar/wiki_24.xpm
   M /trunk/image/up_arrow.xpm
   M /trunk/image/win32-file-dlg.rc
   M /trunk/plugins/lua/elua_dumper.c
   M /trunk/plugins/lua/elua_makedoc.pl
   M /trunk/plugins/lua/elua_makereg.pl
   M /trunk/plugins/lua/make-init-lua.pl
   M /trunk/tools/netscreen2dump.py
   M /trunk/tools/pidl/Makefile.PL
   M /trunk/tools/pidl/pidl
   M /trunk/tools/pidl/tests/parse_idl.pl

Major properties cleanup
------------------------------------------------------------------------
r17746 | gerald | 2006-03-27 14:36:22 -0600 (Mon, 27 Mar 2006) | 2 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

The SIP statistics bug was limited to the UI.

------------------------------------------------------------------------
r17745 | gerald | 2006-03-27 13:45:07 -0600 (Mon, 27 Mar 2006) | 2 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

Updates for CID 42.

------------------------------------------------------------------------
r17744 | gerald | 2006-03-27 13:43:17 -0600 (Mon, 27 Mar 2006) | 3 lines
Changed paths:
   M /trunk/plugins/asn1/packet-asn1.c

Be more paranoid about dereferencing pointers (and improve readability
IMHO).  This should hopefully take care of bug 826 / CID 42.

------------------------------------------------------------------------
r17743 | lego | 2006-03-27 13:35:57 -0600 (Mon, 27 Mar 2006) | 5 lines
Changed paths:
   M /trunk/plugins/lua/elua_field.c

This worked because I've edited elua_field.h as .c and the only thing in elua_field was #include "elua_field.h"

This is the actual elua_field.c 


------------------------------------------------------------------------
r17742 | lego | 2006-03-27 13:31:30 -0600 (Mon, 27 Mar 2006) | 3 lines
Changed paths:
   M /trunk/plugins/lua/Makefile.am
   M /trunk/plugins/lua/Makefile.nmake
   M /trunk/plugins/lua/elua.h
   A /trunk/plugins/lua/elua_field.c
   M /trunk/plugins/lua/elua_tap.c

Improve Field Extraction by returning a handle to a field_info instead of just the value.


------------------------------------------------------------------------
r17741 | lego | 2006-03-27 13:28:02 -0600 (Mon, 27 Mar 2006) | 3 lines
Changed paths:
   M /trunk/epan/libethereal.def
   M /trunk/epan/proto.c
   M /trunk/epan/proto.h

add proto_all_finfos() that will return a GPtrArray containing every finfo found in a tree.


------------------------------------------------------------------------
r17740 | lego | 2006-03-27 13:24:34 -0600 (Mon, 27 Mar 2006) | 3 lines
Changed paths:
   A /trunk/epan/dissectors/packet-smpp.h

Forgotten in previuous commit....


------------------------------------------------------------------------
r17739 | etxrab | 2006-03-27 12:48:33 -0600 (Mon, 27 Mar 2006) | 5 lines
Changed paths:
   M /trunk/asn1/gsmmap/gsmmap.cnf
   M /trunk/asn1/gsmmap/packet-gsm_map-template.c
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-smpp.c

From Jacques, Olivier

Here is a patch for gsm_map dissector that adds USSD string decoding (mainly used in processUnstructuredSS-Request, UnstructuredSS-Request, UnstructuredSS-Notify). For now, it assumes that it will be GSM 7 bits.
It re-use packet-gsm_sms.c "gsm_sms_char_7bit_unpack" and "gsm_sms_char_ascii_decode" functions, as well as packet-smpp.c "smpp_handle_dcs" function.

------------------------------------------------------------------------
r17738 | etxrab | 2006-03-27 12:37:20 -0600 (Mon, 27 Mar 2006) | 1 line
Changed paths:
   M /trunk/AUTHORS

Add W. Borgert to Authors.
------------------------------------------------------------------------
r17737 | etxrab | 2006-03-27 12:24:26 -0600 (Mon, 27 Mar 2006) | 9 lines
Changed paths:
   M /trunk/wiretap/iseries.c

From Martin Warnes:

> I've attached a fix that cleans up this code, actually since my last 
> update of this module the particular call in question was fairly 
> redundant so I just went ahead and removed it and updated the constant 
> that specifies the maximum possible line length instead.
>
> Thanks for bring this to my attention.

------------------------------------------------------------------------
r17736 | gerald | 2006-03-27 10:57:05 -0600 (Mon, 27 Mar 2006) | 2 lines
Changed paths:
   M /trunk/plugins/asn1/packet-asn1.c

Remove some unused #defines.

------------------------------------------------------------------------
r17735 | etxrab | 2006-03-27 10:28:43 -0600 (Mon, 27 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-giop.c

Comment out the unused code.
------------------------------------------------------------------------
r17734 | etxrab | 2006-03-27 10:25:35 -0600 (Mon, 27 Mar 2006) | 36 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipsec.c

From Frederic Roudaut:
With a change :

#ifdef HAVE_LIBCRYPT
#define __USE_LIBGCRYPT__ 
#endif

>> > finally, I have updated my dissector using libgcrypt.
>> > It does not use openssl anymore.
>> > If gnutls is installed, all should work.
>> > Thus, now it should decrypt and dissect (transport/tunnel/several 
>> > encapsulations ...) :
>> >
>> > - NULL Encryption Algorithm
>> > - TripleDES-CBC [RFC2451] : keylen 192 bits.
>> > - AES-CBC with 128-bit keys [RFC3602] : keylen 128 and 192/256 
>> > bits.
>> > - AES-CTR [RFC3686] : keylen 160/224/288 bits. The remaining
>> > 32 bits will be used as nonce.
>> > - DES-CBC [RFC2405] : keylen 64 bits
>> >
>> > I also have added :
>> >
>> > - BLOWFISH-CBC : keylen 128 bits.
>> > - TWOFISH-CBC : keylen 128/256 bits.
>> >
>> > You have to indicate the Authentication algorithm even if all 
>> > Algorithms since it uses 12 bytes in the Auth field should work 
>> > (have a look to the README to understand why I put it
>> > ;-) ). If you consider I have to throw it away please tell me.
>> >
>> > HMAC-SHA1-96 [RFC2404]
>> > NULL
>> > AES-XCBC-MAC-96 [RFC3566]
>> > HMAC-MD5-96 [RFC2403]

------------------------------------------------------------------------
r17733 | etxrab | 2006-03-27 10:23:00 -0600 (Mon, 27 Mar 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-3g-a11.c
   M /trunk/epan/dissectors/packet-gre.c
   M /trunk/epan/dissectors/packet-ppp.c

From Ravi Valmikam:
 a minor fix for 3GPP2 A11 Session Updat

From me:
 a fix to packet-ppp.c to dissect the payload
and some changes in the gre dissector to display the 3GPP values.
------------------------------------------------------------------------
r17732 | gerald | 2006-03-27 10:09:47 -0600 (Mon, 27 Mar 2006) | 3 lines
Changed paths:
   M /trunk/wiretap/iseries.c

Fix a possible NULL dereference (bug 827 / CID 145).  Add an SVN
ID.  Fix up whitespace.

------------------------------------------------------------------------
r17731 | gerald | 2006-03-27 09:44:09 -0600 (Mon, 27 Mar 2006) | 2 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

Add the recent fix for CID 105.

------------------------------------------------------------------------
r17730 | jake | 2006-03-26 02:08:51 -0600 (Sun, 26 Mar 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

Fix for bug 840

------------------------------------------------------------------------
r17729 | ulfl | 2006-03-25 13:04:52 -0600 (Sat, 25 Mar 2006) | 1 line
Changed paths:
   M /trunk/capture-pcap-util.h

fix a wrong comment: AF_INET -> AT_IPv4
------------------------------------------------------------------------
r17728 | gal | 2006-03-25 11:10:07 -0600 (Sat, 25 Mar 2006) | 1 line
Changed paths:
   M /trunk/asn1/x509ce/CertificateExtensions.asn
   M /trunk/asn1/x509ce/packet-x509ce-template.c
   M /trunk/asn1/x509ce/x509ce-exp.cnf
   M /trunk/asn1/x509ce/x509ce.cnf
   M /trunk/epan/dissectors/packet-x509ce.c

Support for otherName and x400address in a GeneralName
------------------------------------------------------------------------
r17727 | gal | 2006-03-25 10:48:28 -0600 (Sat, 25 Mar 2006) | 1 line
Changed paths:
   M /trunk/asn1/x411/packet-x411-template.c
   M /trunk/asn1/x411/x411.asn
   M /trunk/asn1/x411/x411.cnf
   M /trunk/epan/dissectors/packet-x411.c

Support for P1 Strong Authentication
------------------------------------------------------------------------
r17726 | gal | 2006-03-25 10:32:46 -0600 (Sat, 25 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c
   M /trunk/epan/dissectors/packet-ses.c

Support for Session Extended User Data and IMPLICIT APPLICATION tagged bitstrings
------------------------------------------------------------------------
r17725 | jake | 2006-03-25 01:57:11 -0600 (Sat, 25 Mar 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi.c

From Ming Zhang: fix for several wrong use of ntohs in packet-scsi.c

------------------------------------------------------------------------
r17724 | lego | 2006-03-24 17:26:10 -0600 (Fri, 24 Mar 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-alcap.c

- Actually Fix Coverity CID 105 It is true...
- avoid derreferencing an uninitialized leg->dest_nsap

------------------------------------------------------------------------
r17723 | gerald | 2006-03-24 15:48:00 -0600 (Fri, 24 Mar 2006) | 2 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

Finish adding the Coverity IDs.  That brings us to 29 security flaws.

------------------------------------------------------------------------
r17722 | sahlberg | 2006-03-24 15:41:01 -0600 (Fri, 24 Mar 2006) | 17 lines
Changed paths:
   M /trunk/epan/dissectors/packet-kerberos.c

start decoding PA_PW_SALT in the PA-DATA structure.


for the time being   since i have never seen this salt being used elsewhere,
assume everything is the MS style salt:

guint32 nt_status
guint32 unknown
guint32 unknown


if the MS KDC does nopt allow a client to grab a ticket (due to policy   client can only log in at certain hours or such)
KDC will repsond with a failuer with edata like above   and nt-status ==  STATUS_LOGON_HOURS




------------------------------------------------------------------------
r17721 | sahlberg | 2006-03-24 15:16:47 -0600 (Fri, 24 Mar 2006) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-kerberos.c

the edata field is PA-DATA for error PREAUTH_FAILED    just the same as for PREAUTH_REQUIRED


add decode of edata field for the error code PREAUTH_FAILED



------------------------------------------------------------------------
r17720 | jake | 2006-03-24 08:26:01 -0600 (Fri, 24 Mar 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isup.c
   M /trunk/epan/to_str.c

From Olivier Jacques:
- to_str.c: add support of "AT_NONE" address type in address_to_str_buf (avoid the assert failed later on
when messages have address type of AT_NONE - which can be the case for an MTP2 capture with FISU messages)
- packet-isup.c: changed source and destination addresses from (net_src and net_dst) to (src and dst) so 
that addresses taken into account in the statistics are the SS7 point codes

------------------------------------------------------------------------
r17719 | ulfl | 2006-03-24 05:05:46 -0600 (Fri, 24 Mar 2006) | 1 line
Changed paths:
   M /trunk/capture_sync.c

disable the call to sync_pipe_errmsg_to_parent for now, if execv failed (so at least the *NIX versions compile again)
------------------------------------------------------------------------
r17718 | etxrab | 2006-03-24 01:10:22 -0600 (Fri, 24 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-lldp.c

Mark the value_strings static.
------------------------------------------------------------------------
r17717 | etxrab | 2006-03-24 01:09:35 -0600 (Fri, 24 Mar 2006) | 9 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-3g-a11.c
   M /trunk/epan/dissectors/packet-ethertype.c
   M /trunk/epan/dissectors/packet-gre.c

From Ravi Valmikam
1. Decode A11 Session Update message
 
2. Decode A10 3GPP2 (GRE Payload Type 0x88D2) packets with the following attributes
    - Flow Control
    - Segmentation
    - SDI Indicator
    - Flow Discriminator

------------------------------------------------------------------------
r17716 | guy | 2006-03-23 23:05:14 -0600 (Thu, 23 Mar 2006) | 2 lines
Changed paths:
   M /trunk/capture_sync.c

Dumpcap probably has *no* windows.

------------------------------------------------------------------------
r17715 | ulfl | 2006-03-23 20:40:59 -0600 (Thu, 23 Mar 2006) | 1 line
Changed paths:
   M /trunk/capture_loop.c
   M /trunk/capture_opts.c

remove some XXX markers in comments which are no (longer) ToDo items
------------------------------------------------------------------------
r17714 | ulfl | 2006-03-23 20:23:48 -0600 (Thu, 23 Mar 2006) | 1 line
Changed paths:
   M /trunk/capture_sync.c
   M /trunk/capture_sync.h
   M /trunk/dumpcap.c
   M /trunk/tethereal.c

Various code cleanup in the capture pipe stuff
------------------------------------------------------------------------
r17713 | ulfl | 2006-03-23 20:20:37 -0600 (Thu, 23 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-lldp.c

add another comment what's currently missing in the PROFINET specific parts
------------------------------------------------------------------------
r17712 | jake | 2006-03-23 17:04:43 -0600 (Thu, 23 Mar 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-q931.c

Completed Channel Identification IE with Channel number/Slot map field

------------------------------------------------------------------------
r17711 | gerald | 2006-03-23 17:03:22 -0600 (Thu, 23 Mar 2006) | 2 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

Add Coverity IDs 44-109, plus others.  More tomorrow after my eyes rest.

------------------------------------------------------------------------
r17710 | gerald | 2006-03-23 14:13:00 -0600 (Thu, 23 Mar 2006) | 3 lines
Changed paths:
   M /trunk/plugins/asn1/packet-asn1.c

Further refinements for Coverity CID 42.  Make some "0"s (which were 
confusing my feeble mind) NULLs.  Fix up whitespace.

------------------------------------------------------------------------
r17709 | etxrab | 2006-03-23 12:42:25 -0600 (Thu, 23 Mar 2006) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-jxta.c

From Mike Duigou:

> I have improved the heuristics and the display tree building code in
> dissect_jxta_udp() and dissect_jxta_stream() to avoid this problem.

------------------------------------------------------------------------
r17708 | gerald | 2006-03-23 12:22:42 -0600 (Thu, 23 Mar 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb-pipe.c

Coverity CID 48 is still complaining about a NULL dereference.  Hopefully 
this will fix it.

------------------------------------------------------------------------
r17707 | etxrab | 2006-03-23 11:01:51 -0600 (Thu, 23 Mar 2006) | 1 line
Changed paths:
   M /trunk/tools/lemon/lemon.html

Doc update from Sqlite
------------------------------------------------------------------------
r17706 | etxrab | 2006-03-23 11:01:14 -0600 (Thu, 23 Mar 2006) | 1 line
Changed paths:
   M /trunk/radius/dictionary.microsoft

Minor update to the dictionary
------------------------------------------------------------------------
r17705 | etxrab | 2006-03-23 11:00:32 -0600 (Thu, 23 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-cops.c

Covierty bug fix.
------------------------------------------------------------------------
r17704 | etxrab | 2006-03-23 10:59:48 -0600 (Thu, 23 Mar 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_map.c

Fix bug:
825 setup message has an error in gsm-a-dtap 
------------------------------------------------------------------------
r17703 | etxrab | 2006-03-23 10:58:50 -0600 (Thu, 23 Mar 2006) | 4 lines
Changed paths:
   M /trunk/asn1/gsmmap/GSMMAP.asn
   M /trunk/asn1/gsmmap/packet-gsm_map-template.c
   M /trunk/epan/dissectors/packet-gsm_a.c

Fix Bugs
820     gsm-map checkIMEI decoding error  
821     gsm-map sendIMSI decoding error  

------------------------------------------------------------------------
r17702 | lego | 2006-03-22 18:57:56 -0600 (Wed, 22 Mar 2006) | 4 lines
Changed paths:
   M /trunk/epan/radius_dict.l

Bug 796
the dictionary parser could not handle more than one attribute with parameters per file 


------------------------------------------------------------------------
r17701 | tuexen | 2006-03-22 18:36:35 -0600 (Wed, 22 Mar 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sctp.c

Update to draft-ietf-tsvwg-sctp-auth-02.txt.

------------------------------------------------------------------------
r17700 | gerald | 2006-03-22 15:39:32 -0600 (Wed, 22 Mar 2006) | 2 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

Add entries for several bugs, including Coverity IDs 1 - 43.

------------------------------------------------------------------------
r17699 | etxrab | 2006-03-22 11:37:04 -0600 (Wed, 22 Mar 2006) | 6 lines
Changed paths:
   M /trunk/wiretap/iseries.c

From Mertin Wrnes:
Following my last submitted patch I did some further investigation on the different types of iSeries  Comms Traces, although the field formats are constant, things such as page throws and line spacing vary depending on the tool used to pull the trace form the iSeries spool.

This patch should better handle the different formats and more importantly exit in a graceful manner if an unknown format is encountered.


------------------------------------------------------------------------
r17698 | etxrab | 2006-03-22 11:19:56 -0600 (Wed, 22 Mar 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-netflow.c

From Motonori Shindo:
find attached the patch that reflects this interpretation of 
> this field accordingly. It also fixes a few minor bugs associated with 
> the handling of 'UNIX Secs' field and two field types
> (LAST_SWITCHED(21) and FIRST_SWITCHED(22)) in case of NetFlow V9.

------------------------------------------------------------------------
r17697 | etxrab | 2006-03-22 11:13:09 -0600 (Wed, 22 Mar 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mtp3mg.c

From Jeff Morris
fix http://bugs.ethereal.com/bugzilla/show_bug.cgi?id=332
------------------------------------------------------------------------
r17696 | etxrab | 2006-03-22 11:11:31 -0600 (Wed, 22 Mar 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nsip.c

Handle two octet lengths correctly and remove optional decoding of sns_config, as I read the standard there is no difference.



------------------------------------------------------------------------
r17695 | etxrab | 2006-03-22 11:10:19 -0600 (Wed, 22 Mar 2006) | 1 line
Changed paths:
   M /trunk/asn1/gsmmap/packet-gsm_map-template.c
   M /trunk/epan/dissectors/packet-gsm_map.c

Fix http://bugs.ethereal.com/bugzilla/show_bug.cgi?id=820
------------------------------------------------------------------------
r17694 | guy | 2006-03-21 17:55:30 -0600 (Tue, 21 Mar 2006) | 9 lines
Changed paths:
   M /trunk/tools/lemon/lemon.c

Use "opt_func_string_t" so that we get some more type checking done.

Use safe_ versions of <ctype.h> macros, so we don't get hosed by
characters with the 8th bit set.

Define "tplt_linedir()" with a function prototype.

Constify some stuff to squelch compiler warnings.

------------------------------------------------------------------------
r17693 | guy | 2006-03-21 17:17:15 -0600 (Tue, 21 Mar 2006) | 8 lines
Changed paths:
   M /trunk/tools/lemon/lemon.c

Make it a bit more like the SQLite lemon.c 1.36.

Get rid of some function pointer casting.

Get rid of an unused routine, and make some routines static.

Remove trailing white space.

------------------------------------------------------------------------
r17692 | etxrab | 2006-03-21 14:03:56 -0600 (Tue, 21 Mar 2006) | 2 lines
Changed paths:
   M /trunk/tools/lemon/lemon.c

Mimmicing lemon.c 1.36 exactly for Symbolcmpp does not make MSVC completly happy, see what FC4 says.

------------------------------------------------------------------------
r17691 | etxrab | 2006-03-21 12:56:34 -0600 (Tue, 21 Mar 2006) | 1 line
Changed paths:
   M /trunk/tools/lemon/lemon.c
   M /trunk/tools/lemon/lempar.c

Upadates to squlite:s lemon 1.36
------------------------------------------------------------------------
r17690 | guy | 2006-03-21 03:36:07 -0600 (Tue, 21 Mar 2006) | 2 lines
Changed paths:
   M /trunk/capture_loop.c
   M /trunk/capture_loop.h
   M /trunk/tethereal.c

Simplify the argument list to cap_pipe_dispatch().

------------------------------------------------------------------------
r17689 | jake | 2006-03-21 00:54:12 -0600 (Tue, 21 Mar 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-loop.c

From Bill Meier:
Ensure "relevant function" logic works for loopback packets containing multiple forwarding addresses.


------------------------------------------------------------------------
r17688 | ulfl | 2006-03-20 18:17:40 -0600 (Mon, 20 Mar 2006) | 1 line
Changed paths:
   M /trunk/docbook/release-notes.xml

fix Docbook/XML DTD conformance
------------------------------------------------------------------------
r17687 | gerald | 2006-03-20 14:27:52 -0600 (Mon, 20 Mar 2006) | 5 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

Add security bugs found after canary checking was added.  Coverity bugs
will be added separately.

Add other release items.

------------------------------------------------------------------------
r17686 | etxrab | 2006-03-20 13:53:07 -0600 (Mon, 20 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/dtd.h

svn properties
------------------------------------------------------------------------
r17685 | etxrab | 2006-03-20 13:51:06 -0600 (Mon, 20 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/dtd_parse.h

svn properties
------------------------------------------------------------------------
r17684 | etxrab | 2006-03-20 13:46:04 -0600 (Mon, 20 Mar 2006) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-diameter.c

From Martin Mathieson:
Some cosmetic changes:
- when working out the application id description to show in the info 
column, also consider vendor application identifiers
- make sure application ids and command codes are always shown as 
decimal numbers
- a little whitespace tidyup

------------------------------------------------------------------------
r17683 | etxrab | 2006-03-20 13:40:09 -0600 (Mon, 20 Mar 2006) | 1 line
Changed paths:
   M /trunk/tools/lemon/lemon.c
   M /trunk/tools/lemon/lempar.c

Try again, this should take us to lemon version 1.16 http://www.sqlite.org/cvstrac/rlog?f=sqlite/tool/lemon.c
------------------------------------------------------------------------
r17682 | jake | 2006-03-20 05:45:36 -0600 (Mon, 20 Mar 2006) | 2 lines
Changed paths:
   M /trunk/doc/text2pcap.pod

Provide options to work with defaults of text2pcap.

------------------------------------------------------------------------
r17681 | sahlberg | 2006-03-20 04:52:53 -0600 (Mon, 20 Mar 2006) | 10 lines
Changed paths:
   M /trunk/asn1/pkixcmp/packet-cmp-template.c
   M /trunk/epan/dissectors/packet-aim-chat.c
   M /trunk/epan/dissectors/packet-aim.c
   M /trunk/epan/dissectors/packet-bittorrent.c
   M /trunk/epan/dissectors/packet-cast.c
   M /trunk/epan/dissectors/packet-cmp.c
   M /trunk/epan/dissectors/packet-cops.c
   M /trunk/epan/dissectors/packet-dec-dnart.c
   M /trunk/epan/dissectors/packet-dhcp-failover.c
   M /trunk/epan/dissectors/packet-dlsw.c
   M /trunk/epan/dissectors/packet-dns.c
   M /trunk/epan/dissectors/packet-dsi.c
   M /trunk/epan/dissectors/packet-edonkey.c
   M /trunk/epan/dissectors/packet-gnutella.c
   M /trunk/epan/dissectors/packet-icep.c
   M /trunk/epan/dissectors/packet-ipdc.c
   M /trunk/epan/dissectors/packet-isns.c
   M /trunk/epan/dissectors/packet-kerberos.c
   M /trunk/epan/dissectors/packet-kpasswd.c
   M /trunk/epan/dissectors/packet-laplink.c
   M /trunk/epan/dissectors/packet-mq.c
   M /trunk/epan/dissectors/packet-mysql.c
   M /trunk/epan/dissectors/packet-nbns.c
   M /trunk/epan/dissectors/packet-ndmp.c
   M /trunk/epan/dissectors/packet-ndps.c
   M /trunk/epan/dissectors/packet-netsync.c
   M /trunk/epan/dissectors/packet-pgsql.c
   M /trunk/epan/dissectors/packet-rpc.c
   M /trunk/epan/dissectors/packet-s5066.c
   M /trunk/epan/dissectors/packet-skinny.c
   M /trunk/epan/dissectors/packet-slsk.c
   M /trunk/epan/dissectors/packet-socks.c
   M /trunk/epan/dissectors/packet-srvloc.c
   M /trunk/epan/dissectors/packet-ssh.c
   M /trunk/epan/dissectors/packet-tali.c
   M /trunk/epan/dissectors/packet-tcp.c
   M /trunk/epan/dissectors/packet-tcp.h
   M /trunk/epan/dissectors/packet-tns.c
   M /trunk/epan/dissectors/packet-xot.c
   M /trunk/epan/dissectors/packet-ymsg.c
   M /trunk/gtk/conversations_tcpip.c
   M /trunk/gtk/flow_graph.c
   M /trunk/gtk/hostlist_tcpip.c
   M /trunk/gtk/tcp_graph.c
   M /trunk/plugins/agentx/packet-agentx.c
   M /trunk/plugins/asn1/packet-asn1.c
   M /trunk/plugins/gryphon/packet-gryphon.c
   M /trunk/plugins/opsi/packet-opsi.c
   M /trunk/tap-iousers.c

waste a couple of bytes per tcp conversation and make the tree for acked_packets (i.e. packets that have interesting tcp properties such as being retransmissions etc) hang off the per conversation tcpd struct instead of being global.


while this should improve performance by unmeasurably little it does have the sideeffect that once we finish the rewrite   tcp analysis might actually work and work well even for tcp over tcp tunnelling. 

this also means that if you include packet-tcp.h   you also need to include emem.h .




------------------------------------------------------------------------
r17680 | etxrab | 2006-03-20 02:16:03 -0600 (Mon, 20 Mar 2006) | 1 line
Changed paths:
   M /trunk/tools/lemon/lemon.c
   M /trunk/tools/lemon/lempar.c

Back out the previous changes (:
------------------------------------------------------------------------
r17679 | etxrab | 2006-03-20 00:41:08 -0600 (Mon, 20 Mar 2006) | 3 lines
Changed paths:
   M /trunk/tools/lemon/lemon.c
   M /trunk/tools/lemon/lempar.c

Insert the code from sqlite http://www.sqlite.org/cvstrac/rlog?f=sqlite/tool/lemon.c:
2002-Mar-10 21:21    1.11    Check-in [425] : Bug fix: updates within a transaction would fail if there was existed a temporary table. By drh. (diff)  
2002-Mar-03 02:49    1.10    Check-in [411] : Bug fixes and additional tests for the subquery flattener. By drh. (diff)  
------------------------------------------------------------------------
r17678 | guy | 2006-03-19 16:44:47 -0600 (Sun, 19 Mar 2006) | 2 lines
Changed paths:
   M /trunk/epan/libethereal.def

Add guid_to_str to the list of exported functions.

------------------------------------------------------------------------
r17677 | lego | 2006-03-19 16:18:57 -0600 (Sun, 19 Mar 2006) | 4 lines
Changed paths:
   M /trunk/plugins/lua/elua_pinfo.c

Add pinfo.lo and pinfo.hi been thise the lower and the higher between pinfo.src and pinfo.dst.
Do not faill if Columns is NULL, as it can normally be NULL. 


------------------------------------------------------------------------
r17676 | guy | 2006-03-19 14:45:45 -0600 (Sun, 19 Mar 2006) | 14 lines
Changed paths:
   M /trunk/asn1/h225/h225.cnf
   M /trunk/asn1/h225/packet-h225-template.c
   M /trunk/asn1/h225/packet-h225-template.h
   M /trunk/epan/dissectors/packet-h225.c
   M /trunk/epan/dissectors/packet-h225.h
   M /trunk/epan/ftypes/ftype-guid.c
   M /trunk/epan/guid-utils.h
   M /trunk/epan/h225-persistentdata.c
   M /trunk/epan/h225-persistentdata.h
   M /trunk/gtk/voip_calls.c
   M /trunk/gtk/voip_calls.h
   M /trunk/gtk/voip_calls_dlg.c

Make the GUIDs in various data structures e_guid_t's rather than arrays
of 16 bytes.  Use "sizeof" for the size of e_guid_t's, and use structure
assignment to copy GUID values.

Make functions such as append_h225ras_call() and new_h225ras_call() take
pointers to e_guid_t's as arguments.

Define GUID_LEN in epan/guid-utils.h and use it as the length of a GUID
in a packet.  (Note that "sizeof e_guid_t" is not guaranteed to be 16,
although it is guaranteed to be the size of an e_guid_t.)

When constructing a display filter that matches a GUID, use
guid_to_str() to construct the string for the GUID.

------------------------------------------------------------------------
r17675 | guy | 2006-03-19 14:39:49 -0600 (Sun, 19 Mar 2006) | 3 lines
Changed paths:
   M /trunk/capture_sync.c

Fix pipe_read_bytes() to return the total number of bytes read, not just
the number of bytes read in the last read() call done.

------------------------------------------------------------------------
r17674 | guy | 2006-03-19 14:26:45 -0600 (Sun, 19 Mar 2006) | 6 lines
Changed paths:
   M /trunk/gtk/expert_comp_table.c

Get rid of extra arguments in g_strdup_printf() calls (the end of the
list of arguments is determined by the format string; there's no need
for a NULL terminator).

Fix indentation.

------------------------------------------------------------------------
r17673 | guy | 2006-03-19 14:23:59 -0600 (Sun, 19 Mar 2006) | 2 lines
Changed paths:
   M /trunk/gtk/tcp_graph.c

Get rid of a declaration of a non-existent function.

------------------------------------------------------------------------
r17672 | guy | 2006-03-19 14:23:17 -0600 (Sun, 19 Mar 2006) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi.c

Fix some format strings to display all fields in some mode sense page
bytes.

Constify some variables to squelch compiler warnings.

------------------------------------------------------------------------
r17671 | guy | 2006-03-19 14:21:56 -0600 (Sun, 19 Mar 2006) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-nt.c

Turn the handle types into an enum, so that they're more likely to be
displayed by name in debuggers and so that switch statements can check
whether all types are handled.

Add a check for an unknown handle type, to squelch compiler warnings
(and to catch missing handle type code at run-time, if new handle types
are added).

------------------------------------------------------------------------
r17670 | guy | 2006-03-19 14:19:40 -0600 (Sun, 19 Mar 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bacapp.h

Fix typo.

------------------------------------------------------------------------
r17669 | jake | 2006-03-19 11:32:21 -0600 (Sun, 19 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-cdp.c

No negative power consumption, so unsigned value.
------------------------------------------------------------------------
r17668 | etxrab | 2006-03-19 07:59:44 -0600 (Sun, 19 Mar 2006) | 6 lines
Changed paths:
   M /trunk/tools/lemon/lemon.c
   M /trunk/tools/lemon/lempar.c

Sqlite lemon 1.8 ( 1.7 Make lemon 64-bit clean skipped) :
Bugfix Check-in [388] : Bug fix in lemon: 3-way conflicts (SHIFT/REDUCE/REDUCE) were not detected or resolved. This is now fixed. Also, table compression works a little better. By drh. (diff) 

http://www.sqlite.org/cvstrac/rlog?f=sqlite/tool/lemon.c 


------------------------------------------------------------------------
r17667 | jake | 2006-03-19 06:28:21 -0600 (Sun, 19 Mar 2006) | 15 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bacapp.c

Patch that fixes bug 793 and a few other things mostly revolving around
BACnet schedules.  Could someone please take care of this?

1) fDate - correctly handle wild card year
2) fTime - rename local variables cut-and-pasted from fDate
3) fCalendarEntry - do single-pass decoding rather than while loop since the structure cannot be repeated.
4) fDailySchedule - correctly handle enclosing context tags.
5) fWeeklySchedule - correctly handle enclosing context tags
6) fAcknowledgeAlarmRequest - fix function name spelling and tags 3 and 5 are timeStamp, not time.
7) fSpecialEvent - handle context tags correctly.
8) fReadRangeRequest - Add cases from 2004 spec

Dave Richards


------------------------------------------------------------------------
r17666 | etxrab | 2006-03-19 02:54:00 -0600 (Sun, 19 Mar 2006) | 2 lines
Changed paths:
   M /trunk/tools/lemon/lemon.c
   M /trunk/tools/lemon/lempar.c

Align lemon/lempar.c with Squlite ver 1.2 http://www.sqlite.org/cvstrac/rlog?f=sqlite/tool/lempar.c 

------------------------------------------------------------------------
r17665 | lroland | 2006-03-18 14:28:40 -0600 (Sat, 18 Mar 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

- dissect sip headers properly when they are extended over multiple lines
- skip white space characters, including CR and LF on various places (not complete yet, but better than before)
------------------------------------------------------------------------
r17664 | sahlberg | 2006-03-18 03:01:42 -0600 (Sat, 18 Mar 2006) | 4 lines
Changed paths:
   M /trunk/epan/emem.c
   M /trunk/epan/emem.h
   M /trunk/epan/libethereal.def

rename se_tree_lookup32_less_than_or_equal()
to se_tree_lookup32_le()


------------------------------------------------------------------------
r17663 | sahlberg | 2006-03-18 00:15:39 -0600 (Sat, 18 Mar 2006) | 4 lines
Changed paths:
   M /trunk/epan/emem.c
   M /trunk/epan/emem.h

add new   se_tree_lookup32_less_than_or_equal() call



------------------------------------------------------------------------
r17662 | lroland | 2006-03-17 22:40:11 -0600 (Fri, 17 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

Make some string comparisons case insensitive in the sip dissector
------------------------------------------------------------------------
r17661 | lroland | 2006-03-17 21:32:10 -0600 (Fri, 17 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/Makefile.nmake

Add some dependencies for libethereal.dll, so it gets re-build, if someone just changes a source file in a subdirectory (e.g. a dissector)
------------------------------------------------------------------------
r17660 | lroland | 2006-03-17 21:23:26 -0600 (Fri, 17 Mar 2006) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

based on a patch from Martin Mathieson: 
- dissection of SIP headers containing credentials and challenges.

from me:
- add filter fields for some missing related parameters from RFC 3261
- improve calculation of parameter length.

This implements enhancement request (bug id 812)
------------------------------------------------------------------------
r17659 | gerald | 2006-03-17 16:59:24 -0600 (Fri, 17 Mar 2006) | 3 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

Remove unused internal entities.  Update some bug entries.  Fixup
whitespace.

------------------------------------------------------------------------
r17658 | ulfl | 2006-03-17 15:41:56 -0600 (Fri, 17 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-dcom-dispatch.c
   M /trunk/epan/dissectors/packet-dcom.c

add missing IDispatch methods and related dissections
------------------------------------------------------------------------
r17657 | sahlberg | 2006-03-17 15:03:14 -0600 (Fri, 17 Mar 2006) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc.c

fix for coverity bug 41

if decryption failed there was a possibility to dereference a null pointer


------------------------------------------------------------------------
r17656 | jake | 2006-03-17 05:46:07 -0600 (Fri, 17 Mar 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

Fix bug 819: make sure to always return a tvb pointer.

------------------------------------------------------------------------
r17655 | jake | 2006-03-17 00:59:27 -0600 (Fri, 17 Mar 2006) | 5 lines
Changed paths:
   M /trunk/wiretap/iseries.c

From Martin Warnes:
Attached is a fix that addresses a problem reading certain IBM iSeries
Communications traces.


------------------------------------------------------------------------
r17654 | etxrab | 2006-03-17 00:26:14 -0600 (Fri, 17 Mar 2006) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi.c

From Ming Zhang:
added 3 MCC mode pages decode support.

MRW page
Write param page
capacity page

also fixed several wrong tvb_get_ntohs usage introduced in previous patch.

------------------------------------------------------------------------
r17653 | ulfl | 2006-03-16 17:18:15 -0600 (Thu, 16 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/packet.c

fix some typos in a comment
------------------------------------------------------------------------
r17652 | ulfl | 2006-03-16 17:16:35 -0600 (Thu, 16 Mar 2006) | 1 line
Changed paths:
   M /trunk/plugins/lua/elua.c

we don't need to "ban" the print call any longer
------------------------------------------------------------------------
r17651 | etxrab | 2006-03-16 16:18:15 -0600 (Thu, 16 Mar 2006) | 1 line
Changed paths:
   M /trunk/tools/lemon/lemon.c

Copy a bugfix from http://www.sqlite.org/cvstrac/tktview?tn=313
------------------------------------------------------------------------
r17650 | etxrab | 2006-03-16 15:16:30 -0600 (Thu, 16 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-bssgp.c

Fix dissection of QoS.
------------------------------------------------------------------------
r17649 | etxrab | 2006-03-16 14:14:47 -0600 (Thu, 16 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ip.c

If version is v6 let the IPv6 dissetor handle it.
------------------------------------------------------------------------
r17648 | etxrab | 2006-03-16 14:13:17 -0600 (Thu, 16 Mar 2006) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

Add some extension IE:s
 - APN Restriction
 - RAT Type
-  IMEI(SV)

------------------------------------------------------------------------
r17647 | lego | 2006-03-16 13:45:02 -0600 (Thu, 16 Mar 2006) | 5 lines
Changed paths:
   M /trunk/editcap.c

- Have strptime prototype being included.
- clear struct tm s before passing them to strptime.
- make sure stopttime is a valid value on every plattform.


------------------------------------------------------------------------
r17646 | jake | 2006-03-16 11:47:45 -0600 (Thu, 16 Mar 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-loop.c

Fixed skipCount decoding. Added "relevant function" tag and put relevant function into INFO column.

------------------------------------------------------------------------
r17645 | jake | 2006-03-16 06:27:50 -0600 (Thu, 16 Mar 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl-utils.c

Superfluous check on 'secret' removed.
Coverity CID 31

------------------------------------------------------------------------
r17644 | jake | 2006-03-16 06:12:51 -0600 (Thu, 16 Mar 2006) | 3 lines
Changed paths:
   M /trunk/gtk/stats_tree_stat.c

Check struct pointer before dereferencing it. 
Coverity CID 142

------------------------------------------------------------------------
r17643 | lego | 2006-03-16 04:23:09 -0600 (Thu, 16 Mar 2006) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mtp3.c

From: Peter Johansson
have mtp3_pc_hash() explicitly returning pc.

From me:
 break; execution inside the switch.


------------------------------------------------------------------------
r17642 | sahlberg | 2006-03-16 02:47:19 -0600 (Thu, 16 Mar 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-lsa.c

the new type of sid/rid structure is for lookupnames2   not lookupnames


------------------------------------------------------------------------
r17641 | lego | 2006-03-15 16:58:40 -0600 (Wed, 15 Mar 2006) | 3 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/config.nmake

One day I'll be able to do change something in windows in a single attempt


------------------------------------------------------------------------
r17640 | lego | 2006-03-15 16:30:28 -0600 (Wed, 15 Mar 2006) | 3 lines
Changed paths:
   M /trunk/config.h.win32

Define HAVE_LUA_5_1 on windows as that what we have.


------------------------------------------------------------------------
r17639 | jake | 2006-03-15 15:22:11 -0600 (Wed, 15 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ncp2222.inc

Add missing preference storage. 
------------------------------------------------------------------------
r17638 | lego | 2006-03-15 14:52:37 -0600 (Wed, 15 Mar 2006) | 3 lines
Changed paths:
   M /trunk/editcap.c

use time_t instead of an unsigned integer to sstore the time.


------------------------------------------------------------------------
r17637 | etxrab | 2006-03-15 12:57:47 -0600 (Wed, 15 Mar 2006) | 1 line
Changed paths:
   M /trunk/asn1/snmp/packet-snmp-template.c
   M /trunk/asn1/snmp/snmp.asn
   M /trunk/asn1/snmp/snmp.cnf

Some more variable bindings and add some mising PDU types.
------------------------------------------------------------------------
r17636 | etxrab | 2006-03-15 12:56:35 -0600 (Wed, 15 Mar 2006) | 19 lines
Changed paths:
   M /trunk/epan/dissectors/ncp2222.py
   M /trunk/epan/dissectors/packet-ncp-int.h
   M /trunk/epan/dissectors/packet-ncp.c
   M /trunk/epan/proto.h
   M /trunk/gtk/expert_dlg.c

From Greg Morris:

Modification to (proto.h) is made to add an additional expert group type of PI_REQUEST_CODE to allow Request tag information to be passed to the expert tap. This is for such reasons where a dissector would like to echo specific information about certain types of requests. For example: NCP connection request is really a request not a REPLY_CODE. Same is true for the TCP SYN request.

Changes to packet-ncp.c
1. Server broadcast message flag. Now indicates if the message is a pending message or an oplock clear notification.
2. Cleanup of packet signature detection process. Previous method had some flaws so I redesigned it. Appears to be solid now.
3. Echo NCP Server Session information to expert tap.
 
Note on item #3: NCP Connection+Task = NCP Session, a Single connection can have many tasks. The server sees each connection/task as a unique session. For this reason the NCP session information is now echoed to the expert composite statistics so that you can easily identify the different NCP processes and sessions. It is important to NCP analysis to understand that each session is most likely a different program on the requesting host sharing the same NCP connection.
 
Changes to packet-ncp2222.inc
1. Comment out the echo of NCP connection info to expert tap. Replaced by NCP sessions.
2. Add displayEID in request decode (resolves Coverity defect for dead code in NCP dissector)
 
Changes to ncp2222.py
1. Fix for endian display of bindery object type in NCP 0x1720.
2. Fix for size of bindery object type to 2 bytes instead of 4 to match other bindery NCP's.

------------------------------------------------------------------------
r17635 | etxrab | 2006-03-15 12:55:12 -0600 (Wed, 15 Mar 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-diameter.c

from Martim Mattieson:
This small patch will cause the current AVP dictionary to be freed and 
repopulated when relevant preferences have changed.

------------------------------------------------------------------------
r17634 | etxrab | 2006-03-15 12:53:54 -0600 (Wed, 15 Mar 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bgp.c

From RABRET Laurent RD-MAPS-ISS:
Please find enclosed a patch for the BGP dissector.
A 0 length IP address is valid in NLRI dissection. It just means "0/0 address".
------------------------------------------------------------------------
r17633 | jmayer | 2006-03-15 04:53:33 -0600 (Wed, 15 Mar 2006) | 2 lines
Changed paths:
   M /trunk/manuf
   M /trunk/wka.tmpl

Update/add some Cisco multicast addresses

------------------------------------------------------------------------
r17632 | sahlberg | 2006-03-15 02:26:21 -0600 (Wed, 15 Mar 2006) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-lsa.c

lookupnames2 takes a different sid structure compared to lookupnames

update it to dissect it as such and create new helpers for the new structure  that takes one extra guint32 at the end of the previous structure.


------------------------------------------------------------------------
r17631 | etxrab | 2006-03-15 00:20:23 -0600 (Wed, 15 Mar 2006) | 1 line
Changed paths:
   M /trunk/asn1/snmp/packet-snmp-template.c
   M /trunk/asn1/snmp/snmp.asn
   M /trunk/asn1/snmp/snmp.cnf

Start implementing the variable binding part.
------------------------------------------------------------------------
r17630 | etxrab | 2006-03-15 00:19:15 -0600 (Wed, 15 Mar 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-netflow.c

From Motonori Shindo:
 The code assumes Template FlowSet contains only one Template Record, which is not necessarily true. Please find attached the patch to fix it.
------------------------------------------------------------------------
r17629 | etxrab | 2006-03-15 00:17:35 -0600 (Wed, 15 Mar 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pop.c

From Martin Mathieson:
> This patch:
> - adds a few filterable fields (currently there are only hidden
> boolean fields for request and response).
------------------------------------------------------------------------
r17628 | etxrab | 2006-03-15 00:16:12 -0600 (Wed, 15 Mar 2006) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-diameter.c

From Martin Mathieson

>>>This patch:
>>>- makes it possible to turn off use of the XML AVP dictionary (which 
>>>relies upon the XML lib being installed).  A failed load results in 3 
>>>annoying dialogs popping up the first time a diameter packet is read. 
>>>Default is previous behaviour.

------------------------------------------------------------------------
r17627 | lego | 2006-03-14 19:41:39 -0600 (Tue, 14 Mar 2006) | 9 lines
Changed paths:
   M /trunk/epan/stats_tree.c
   M /trunk/epan/stats_tree_priv.h
   M /trunk/gtk/stats_tree_stat.c

Fix bug 710 and avoid having it crash when more than one instance are open at once.

I think that whoever wrote the whole stats_tree thing should rewrite it ASAP, because it sucks!

I did ?!?!??

ooops!


------------------------------------------------------------------------
r17626 | sahlberg | 2006-03-14 02:11:18 -0600 (Tue, 14 Mar 2006) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nfs.c

coverity bug 139


actually allow dissection of RELEASE_LOCKOWNER call
instead of letting it hang as dead code



------------------------------------------------------------------------
r17625 | sahlberg | 2006-03-14 01:47:19 -0600 (Tue, 14 Mar 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

coverity bug 68


prevent a very very long loop


------------------------------------------------------------------------
r17624 | sahlberg | 2006-03-14 01:38:43 -0600 (Tue, 14 Mar 2006) | 3 lines
Changed paths:
   M /trunk/plugins/asn1/packet-asn1.c

coverity bug 43


------------------------------------------------------------------------
r17623 | etxrab | 2006-03-14 00:42:58 -0600 (Tue, 14 Mar 2006) | 1 line
Changed paths:
   M /trunk/Makefile.nmake

Add strptime.obj to outfiles as well.
------------------------------------------------------------------------
r17622 | etxrab | 2006-03-13 23:49:15 -0600 (Mon, 13 Mar 2006) | 3 lines
Changed paths:
   M /trunk/gtk/flow_graph.c
   M /trunk/gtk/graph_analysis.c

From  Laurent Rabret, 

 2 patches for the "flow graph" display. It is better not to insert invalid packets into the list than to control the list is correct while using it...
------------------------------------------------------------------------
r17621 | sahlberg | 2006-03-13 23:38:47 -0600 (Mon, 13 Mar 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb-pipe.c

coverity bug 44


------------------------------------------------------------------------
r17620 | sahlberg | 2006-03-13 23:30:26 -0600 (Mon, 13 Mar 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb-mailslot.c

handle coverity bug  36



------------------------------------------------------------------------
r17619 | sahlberg | 2006-03-13 22:56:40 -0600 (Mon, 13 Mar 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi.c

put the opcode as a generated field inside data pdus for scsi



------------------------------------------------------------------------
r17618 | sahlberg | 2006-03-13 19:18:43 -0600 (Mon, 13 Mar 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi.c

prettifu getconfiguration response


------------------------------------------------------------------------
r17617 | lego | 2006-03-13 18:17:22 -0600 (Mon, 13 Mar 2006) | 3 lines
Changed paths:
   M /trunk/Makefile.nmake

missed to add strptime.obj to the editcap.


------------------------------------------------------------------------
r17616 | sahlberg | 2006-03-13 16:35:14 -0600 (Mon, 13 Mar 2006) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi.c

set current_proto to SCSI   so that the exception handler will show the correct protocol


fix length in getconfiguration()  so that we provide the proper one (+4)
to avoid marking valid packets as malformed.



------------------------------------------------------------------------
r17615 | lego | 2006-03-13 16:22:17 -0600 (Mon, 13 Mar 2006) | 3 lines
Changed paths:
   M /trunk/plugins/lua/elua_gui.c

Use checkTextWindow instead of shiftTextWindow to fetch the window object from the stack, shiftXxx will happily (and rightfully) return a null pointer without an error.


------------------------------------------------------------------------
r17614 | lego | 2006-03-13 16:20:07 -0600 (Mon, 13 Mar 2006) | 3 lines
Changed paths:
   M /trunk/doc/editcap.pod
   M /trunk/editcap.c

Add -A <start time> and -B <stop time> options to editcap


------------------------------------------------------------------------
r17613 | ulfl | 2006-03-13 16:19:36 -0600 (Mon, 13 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-scsi.c

remove a compiler warning
------------------------------------------------------------------------
r17612 | sahlberg | 2006-03-13 14:50:50 -0600 (Mon, 13 Mar 2006) | 12 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

if tcp checksum validation is enabled 
and if the checksum is wrong
and if the checksum field is 0x0000

mark the packet as [Checksum Offloaded] and still allow reassembly of
tcp segmetns


since it is most likely just a tco checksum offload engine and not a real checksum error



------------------------------------------------------------------------
r17611 | sahlberg | 2006-03-13 04:29:00 -0600 (Mon, 13 Mar 2006) | 20 lines
Changed paths:
   M /trunk/epan/dissectors/packet-frame.c
   M /trunk/epan/dissectors/packet-scsi.c
   M /trunk/epan/exceptions.h

SCSI is fairly unique among the ethereal protocols in that it is sometimes normal for a PDU we receive back froma  device to be truncated.
(report luns with allocation length 8 for example)

Therefore it is a bit wrong to mark these packets as [malformed packets]
Since they are truncated by scsi   and this is NOTY an error condition.


Add a new exception type  :  ScsiBoundsError
If this exception is caught by packet-frame, then print an appropriate message
instead of [malformed packet]

For SCSI, add helper macros TRY_SCSI_SHORT_PACKET   and END_...


If the packet was not short in the normal sense (snaplen < packetlen) then intercept the exception for BoundsError and rethrow it as ScsiBoundsError instead.





------------------------------------------------------------------------
r17610 | etxrab | 2006-03-13 00:23:59 -0600 (Mon, 13 Mar 2006) | 12 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi.c

From Ming Zhang

added another command preventallowmediaremoval besides those 3.

> enhanced packet-scsi.c a bit to decode 3 more scsi commands
> 
> getperformance
> setcdspeed
> readdiscstructure.



------------------------------------------------------------------------
r17609 | lego | 2006-03-12 18:31:04 -0600 (Sun, 12 Mar 2006) | 4 lines
Changed paths:
   M /trunk/plugins/lua/elua_tree.c

Expert info is going to be used in runtime.
For the sake of speed use integers instead of strings to then be converted into integers.


------------------------------------------------------------------------
r17608 | ulfl | 2006-03-12 18:30:51 -0600 (Sun, 12 Mar 2006) | 5 lines
Changed paths:
   M /trunk/capture.c
   M /trunk/capture.h
   M /trunk/capture_loop.c
   M /trunk/capture_sync.c
   M /trunk/dumpcap.c

fix bug #803: sync pipe on Win32 wasn't set to binary mode, so error message transport failed between Ethereal and dumpcap.

I've also changed the way the secondary error message is transported from former "header message 0 secondary 0" to "header header message 0 header secondary 0" as that might be a bit more clearer, and I'll need it for further development anyway.

I was using this while debugging and not recognizing the real problem - for about four hours :-(. I'll need this feature when doing the interface (and link layer type) browsing later (transferring this data from dumpcap to Ethereal) to get a full blown privilege seperation.
------------------------------------------------------------------------
r17607 | lego | 2006-03-12 15:45:18 -0600 (Sun, 12 Mar 2006) | 3 lines
Changed paths:
   M /trunk/packaging/nsis/ethereal.nsi
   M /trunk/plugins/Makefile.nmake

This time, should be the good one!


------------------------------------------------------------------------
r17606 | ulfl | 2006-03-12 15:15:01 -0600 (Sun, 12 Mar 2006) | 1 line
Changed paths:
   M /trunk/packaging/nsis/ethereal.nsi

is that what you meant?
------------------------------------------------------------------------
r17605 | lego | 2006-03-12 14:48:14 -0600 (Sun, 12 Mar 2006) | 3 lines
Changed paths:
   M /trunk/packaging/nsis/ethereal.nsi

Let's see if at the third attempt I get it right...


------------------------------------------------------------------------
r17604 | lego | 2006-03-12 13:47:29 -0600 (Sun, 12 Mar 2006) | 3 lines
Changed paths:
   M /trunk/packaging/nsis/ethereal.nsi

Let's try again!


------------------------------------------------------------------------
r17603 | lego | 2006-03-12 12:57:38 -0600 (Sun, 12 Mar 2006) | 3 lines
Changed paths:
   M /trunk/packaging/nsis/ethereal.nsi
   M /trunk/plugins/lua/Makefile.nmake

I Hope this works


------------------------------------------------------------------------
r17602 | lego | 2006-03-12 11:39:46 -0600 (Sun, 12 Mar 2006) | 3 lines
Changed paths:
   M /trunk/plugins/lua/Makefile.am
   A /trunk/plugins/lua/make-init-lua.pl
   A /trunk/plugins/lua/template-init.lua

Move make-init-lua.pl and family to plugins/lua and have init.lua installed in the right place


------------------------------------------------------------------------
r17601 | jake | 2006-03-12 10:42:10 -0600 (Sun, 12 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/expert.c

Assure that pinfo is a valid pointer. Related to Coverity CID 112
------------------------------------------------------------------------
r17600 | lego | 2006-03-12 10:41:34 -0600 (Sun, 12 Mar 2006) | 3 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/Makefile.nmake
   D /trunk/make-init-lua.pl
   D /trunk/template-init.lua

Move init.lua and family to plugins/lua


------------------------------------------------------------------------
r17599 | lego | 2006-03-12 09:31:33 -0600 (Sun, 12 Mar 2006) | 4 lines
Changed paths:
   M /trunk/plugins/lua/elua.h
   M /trunk/plugins/lua/elua_tree.c

reenable TreeItem,
shiftXXX() was broken


------------------------------------------------------------------------
r17598 | lego | 2006-03-12 07:03:18 -0600 (Sun, 12 Mar 2006) | 3 lines
Changed paths:
   M /trunk/plugins/lua/elua_proto.c

Protocols are now invoked.


------------------------------------------------------------------------
r17597 | sahlberg | 2006-03-11 17:16:34 -0600 (Sat, 11 Mar 2006) | 4 lines
Changed paths:
   M /trunk/epan/emem.c

revert back to svn 17587



------------------------------------------------------------------------
r17596 | sahlberg | 2006-03-11 16:40:52 -0600 (Sat, 11 Mar 2006) | 6 lines
Changed paths:
   M /trunk/epan/emem.c

oops   removed one check too many

when we lookup grandparent,   check that we actually have a grandparent.



------------------------------------------------------------------------
r17595 | lego | 2006-03-11 16:26:08 -0600 (Sat, 11 Mar 2006) | 3 lines
Changed paths:
   M /trunk/plugins/lua/elua_proto.c

Remove debug code...


------------------------------------------------------------------------
r17594 | lego | 2006-03-11 16:05:40 -0600 (Sat, 11 Mar 2006) | 3 lines
Changed paths:
   M /trunk/plugins/lua/elua.c
   M /trunk/plugins/lua/elua.h
   M /trunk/plugins/lua/elua_makereg.pl
   M /trunk/plugins/lua/elua_proto.c

Protocols register OK.


------------------------------------------------------------------------
r17593 | ulfl | 2006-03-11 14:19:20 -0600 (Sat, 11 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-snmp.c

mark parser error messages as Ethereal generated
------------------------------------------------------------------------
r17592 | ulfl | 2006-03-11 12:51:57 -0600 (Sat, 11 Mar 2006) | 1 line
Changed paths:
   M /trunk/docbook/release-notes.xml

add dumpcap to the list of new features
------------------------------------------------------------------------
r17591 | lego | 2006-03-11 12:19:48 -0600 (Sat, 11 Mar 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-k12.c
   M /trunk/epan/dtd_preparse.l

Close the files after reading!


------------------------------------------------------------------------
r17590 | lego | 2006-03-11 09:30:52 -0600 (Sat, 11 Mar 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-sccp.c
   A /trunk/epan/dissectors/packet-sccp.h

use se_trees instead of GHashTables,
rename binding into assoc(iation) which is the AOC name.
move the definition of sccp_assoc_t to packet-sccp.h so that information regarding sccp associations it can be used by user protocols



------------------------------------------------------------------------
r17589 | sahlberg | 2006-03-11 07:36:22 -0600 (Sat, 11 Mar 2006) | 3 lines
Changed paths:
   M /trunk/epan/emem.c

remove some redundant calls and checks and pass the required pointers as parameters instead to make it slightly faster


------------------------------------------------------------------------
r17588 | sahlberg | 2006-03-11 07:21:41 -0600 (Sat, 11 Mar 2006) | 3 lines
Changed paths:
   M /trunk/doc/README.binarytrees

document the char *name parameter to the create tree functions


------------------------------------------------------------------------
r17587 | sahlberg | 2006-03-11 07:02:41 -0600 (Sat, 11 Mar 2006) | 3 lines
Changed paths:
   M /trunk/asn1/h248/packet-h248-template.c
   M /trunk/epan/dissectors/packet-alcap.c
   M /trunk/epan/dissectors/packet-h248.c
   M /trunk/epan/dissectors/packet-nfs.c
   M /trunk/epan/dissectors/packet-tcp.c
   M /trunk/epan/emem.c
   M /trunk/epan/emem.h

give se_trees names     so that it is easier to debug and to log how often certain trees are accessed


------------------------------------------------------------------------
r17586 | sahlberg | 2006-03-11 06:33:15 -0600 (Sat, 11 Mar 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bssap.c

remove some unusued parameters


------------------------------------------------------------------------
r17585 | lego | 2006-03-11 06:12:10 -0600 (Sat, 11 Mar 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mtp3.c

Avoid a coverity false positive (CID 38) from being considered.


------------------------------------------------------------------------
r17584 | lego | 2006-03-11 06:07:00 -0600 (Sat, 11 Mar 2006) | 10 lines
Changed paths:
   M /trunk/plugins/mate/mate_parser.l

 Mark coverity CID 117 as a false positive.

Lex code is often hard for humans to understand... neither of the error conditions found would be happening...

One was marked as error because coverity does not understand that yyterminate() breaks execution.

The other marked as an error because coverity is not able to figure out that the error appears in an actions against two different rules that will not ever match toghether.



------------------------------------------------------------------------
r17583 | sahlberg | 2006-03-11 06:03:28 -0600 (Sat, 11 Mar 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bssap.c

second try to fix the bug


------------------------------------------------------------------------
r17582 | sahlberg | 2006-03-11 06:00:59 -0600 (Sat, 11 Mar 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bssap.c

the code forgot to update offset    *offset++ is not the same as offset++   :-)



------------------------------------------------------------------------
r17581 | lego | 2006-03-11 05:55:49 -0600 (Sat, 11 Mar 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-alcap.c

Mark coverity's CID 105 as a false positive.
(The macro GET_MSG_TYPE does propper bounds checking but coverity doesn't consider it (may not be able to resolve the ?: operator) )


------------------------------------------------------------------------
r17580 | lego | 2006-03-11 05:48:35 -0600 (Sat, 11 Mar 2006) | 4 lines
Changed paths:
   M /trunk/wiretap/netxray.c

Remove an entire horde of off-by-one errors pointed out by Coverity's CID: 83
(Coverity finds just one at a time...)


------------------------------------------------------------------------
r17579 | lego | 2006-03-11 05:45:36 -0600 (Sat, 11 Mar 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-alcap.c

replace GHashTables with se_trees


------------------------------------------------------------------------
r17578 | sahlberg | 2006-03-11 05:18:56 -0600 (Sat, 11 Mar 2006) | 9 lines
Changed paths:
   M /trunk/epan/asn1.c

include emem.h

otherwise ep_strdup() defaults to int   which will break
if pointers are bigger than integers.


this should fix bugs 797  802  805 806


------------------------------------------------------------------------
r17577 | ulfl | 2006-03-11 03:09:55 -0600 (Sat, 11 Mar 2006) | 1 line
Changed paths:
   M /trunk/plugins/profinet/packet-dcerpc-pn-io.c

... and don't forget to include emem.h!
------------------------------------------------------------------------
r17576 | ulfl | 2006-03-11 03:08:18 -0600 (Sat, 11 Mar 2006) | 1 line
Changed paths:
   M /trunk/plugins/profinet/packet-dcerpc-pn-io.c
   M /trunk/plugins/profinet/packet-pn-dcp.c

replace g_malloc and alike by their corresponding ep_ functions
------------------------------------------------------------------------
r17575 | sahlberg | 2006-03-11 00:12:36 -0600 (Sat, 11 Mar 2006) | 3 lines
Changed paths:
   M /trunk/epan/emem.c

forgot to paint a node   causing massively unbalanced tree


------------------------------------------------------------------------
r17574 | jmayer | 2006-03-10 19:45:42 -0600 (Fri, 10 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/ftypes/ftype-guid.c
   M /trunk/epan/guid-utils.h

propset...
------------------------------------------------------------------------
r17573 | sahlberg | 2006-03-10 18:58:16 -0600 (Fri, 10 Mar 2006) | 4 lines
Changed paths:
   M /trunk/asn1/h248/packet-h248-template.c
   M /trunk/epan/dissectors/packet-h248.c
   M /trunk/epan/dissectors/packet-h248.h

dont declare variables in the middle of a code block.   many compilers do not like that.



------------------------------------------------------------------------
r17572 | lego | 2006-03-10 16:05:23 -0600 (Fri, 10 Mar 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mtp3.c
   M /trunk/epan/dissectors/packet-mtp3.h

Add a function that returns an unique guint32 for each dpc.


------------------------------------------------------------------------
r17571 | lego | 2006-03-10 16:01:10 -0600 (Fri, 10 Mar 2006) | 4 lines
Changed paths:
   M /trunk/asn1/h248/h248.cnf
   M /trunk/asn1/h248/packet-h248-template.c
   M /trunk/asn1/h248/packet-h248-template.h
   M /trunk/epan/dissectors/packet-h248.c
   M /trunk/epan/dissectors/packet-h248.h

fix coverity CIDs 113 and 114.
while at it change the h248 context analysis to use se_trees instead of GHashTables


------------------------------------------------------------------------
r17570 | lego | 2006-03-10 15:58:49 -0600 (Fri, 10 Mar 2006) | 2 lines
Changed paths:
   M /trunk/epan/emem.c

avoid doing the lookup of a key twice while inserting items to a tree with an array key. 

------------------------------------------------------------------------
r17569 | ulfl | 2006-03-10 15:34:56 -0600 (Fri, 10 Mar 2006) | 1 line
Changed paths:
   M /trunk/plugins/profinet/packet-pn-dcp.c

various code cleanup (e.g. remove unrequired length parameter), should also fix coverity id 126
------------------------------------------------------------------------
r17568 | kukosa | 2006-03-10 08:14:39 -0600 (Fri, 10 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/ftypes/ftype-guid.c

few warnings from GUID handling avoided
------------------------------------------------------------------------
r17567 | kukosa | 2006-03-10 06:57:22 -0600 (Fri, 10 Mar 2006) | 2 lines
Changed paths:
   M /trunk/epan/Makefile.common
   M /trunk/epan/tvbuff.c

add guid-utils.h to Makefile.common
remove unused variables from tvbuff.c
------------------------------------------------------------------------
r17566 | kukosa | 2006-03-10 05:58:22 -0600 (Fri, 10 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/ftypes/Makefile.am
   M /trunk/epan/ftypes/Makefile.nmake
   M /trunk/epan/ftypes/ftype-bytes.c
   A /trunk/epan/ftypes/ftype-guid.c
   M /trunk/epan/ftypes/ftypes-int.h
   M /trunk/epan/ftypes/ftypes.c
   M /trunk/epan/ftypes/ftypes.h
   A /trunk/epan/guid-utils.h
   M /trunk/epan/proto.c
   M /trunk/epan/proto.h
   M /trunk/epan/to_str.c
   M /trunk/epan/to_str.h
   M /trunk/epan/tvbuff.c
   M /trunk/epan/tvbuff.h

new FT_GUID handling - big/little endian supported
------------------------------------------------------------------------
r17565 | etxrab | 2006-03-10 01:06:21 -0600 (Fri, 10 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-slowprotocols.c

Fix CID 6 - Unused code.
------------------------------------------------------------------------
r17564 | sahlberg | 2006-03-09 23:41:40 -0600 (Thu, 09 Mar 2006) | 3 lines
Changed paths:
   M /trunk/epan/emem.c

fix missing return bug   from didier


------------------------------------------------------------------------
r17563 | sahlberg | 2006-03-09 23:39:57 -0600 (Thu, 09 Mar 2006) | 6 lines
Changed paths:
   M /trunk/epan/emem.c

make using canaries  optional


default to  use-canaries  since that is the current behaviour


------------------------------------------------------------------------
r17562 | sahlberg | 2006-03-09 23:15:52 -0600 (Thu, 09 Mar 2006) | 7 lines
Changed paths:
   M /trunk/epan/emem.c

add a define that controls explicitely whether we want to use guard pages (if available) or not.


let it default to     want-guard-pages  since the existing code does that.



------------------------------------------------------------------------
r17561 | tpot | 2006-03-09 21:03:06 -0600 (Thu, 09 Mar 2006) | 3 lines
Changed paths:
   M /trunk/epan/to_str.c

Remove a linebreak to emphasise the guid structure (doesn't change
the byte ordering).

------------------------------------------------------------------------
r17560 | gerald | 2006-03-09 17:13:49 -0600 (Thu, 09 Mar 2006) | 2 lines
Changed paths:
   M /trunk/gtk/find_dlg.c

Fix Coverity CID 129: initialize a couple of variables.

------------------------------------------------------------------------
r17559 | ulfl | 2006-03-09 16:13:51 -0600 (Thu, 09 Mar 2006) | 1 line
Changed paths:
   M /trunk/capture_sync.c

debugging helper: if (for whatever reason) the message from dumpcap was invalid, try to print it. This was already helpful e.g. as a GLib warning was confusing the pipe handling
------------------------------------------------------------------------
r17558 | ulfl | 2006-03-09 16:06:25 -0600 (Thu, 09 Mar 2006) | 3 lines
Changed paths:
   M /trunk/capture_loop.c

fix two bugs causing crashes on Win32: 
- fix buggy g_snprintf call (Win32 fails if %s is called with a NULL pointer)
- don't call file close if file wasn't open before (Win32 crashes if eth_unlink is called with a NULL pointer)
------------------------------------------------------------------------
r17557 | ulfl | 2006-03-09 15:18:44 -0600 (Thu, 09 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-jxta.c

don't use g_message() inside dissector code
------------------------------------------------------------------------
r17556 | gerald | 2006-03-09 14:48:17 -0600 (Thu, 09 Mar 2006) | 2 lines
Changed paths:
   M /trunk/wiretap/ngsniffer.c

Fix a possible NULL dereference (Coverity CID 33).

------------------------------------------------------------------------
r17555 | gerald | 2006-03-09 13:38:51 -0600 (Thu, 09 Mar 2006) | 3 lines
Changed paths:
   M /trunk/gtk/dfilter_expr_dlg.c

Make sure we can't pass NULL to strcmp.  Fixes Coverity CID 34.  Fix up 
whitespace.

------------------------------------------------------------------------
r17554 | gerald | 2006-03-09 11:58:20 -0600 (Thu, 09 Mar 2006) | 7 lines
Changed paths:
   M /trunk/gtk/tcp_graph.c

There is a one-to-one mapping between each graph and its "toplevel" and
drawing_area widgets.  Instead of canoodling around with a global list
of graphs, simply associate a graph to its widgets using OBJECT_SET_DATA.
This should take care of Coverity CIDs 50 - 59.

Clean up whitespace.

------------------------------------------------------------------------
r17553 | obiot | 2006-03-09 10:21:39 -0600 (Thu, 09 Mar 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-wsp.c

Fix coverity Error CID: 15.

------------------------------------------------------------------------
r17552 | etxrab | 2006-03-09 10:17:52 -0600 (Thu, 09 Mar 2006) | 1 line
Changed paths:
   M /trunk/plugins/lua/Makefile.am

Add lua:s nmakefile.nmake to the distribution.
------------------------------------------------------------------------
r17551 | gerald | 2006-03-09 10:00:33 -0600 (Thu, 09 Mar 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ansi_a.c
   M /trunk/epan/dissectors/packet-ber.c
   M /trunk/epan/dissectors/packet-dcerpc.c
   M /trunk/epan/dissectors/packet-scsi.c
   M /trunk/epan/dissectors/packet-smb2.c
   M /trunk/gtk/sctp_byte_graph_dlg.c
   M /trunk/gtk/sctp_graph_dlg.c

Remove MIN and MAX defines, which GLib provides.

------------------------------------------------------------------------
r17550 | gerald | 2006-03-09 08:39:44 -0600 (Thu, 09 Mar 2006) | 5 lines
Changed paths:
   M /trunk/capture_sync.c

Take care of one last UTF-8 <-> UTF-16 conversion (assuming there aren't any
hiding behind casts).  Fixes bug 798.

Clean up whitespace.

------------------------------------------------------------------------
r17549 | sahlberg | 2006-03-09 06:16:53 -0600 (Thu, 09 Mar 2006) | 5 lines
Changed paths:
   M /trunk/gtk/rtp_analysis.c

coverity #62

potential null dereference


------------------------------------------------------------------------
r17548 | sahlberg | 2006-03-09 06:11:21 -0600 (Thu, 09 Mar 2006) | 5 lines
Changed paths:
   M /trunk/plugins/asn1/packet-asn1.c

coverity bug#42

dereverencing a null variable


------------------------------------------------------------------------
r17547 | jmayer | 2006-03-09 06:05:53 -0600 (Thu, 09 Mar 2006) | 1 line
Changed paths:
   M /trunk/doc/README.binarytrees

propset ...
------------------------------------------------------------------------
r17546 | sahlberg | 2006-03-09 05:44:56 -0600 (Thu, 09 Mar 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rpc.c

coverity #40

fix null dereference 

------------------------------------------------------------------------
r17545 | sahlberg | 2006-03-09 05:34:08 -0600 (Thu, 09 Mar 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-iapp.c

coverity #5


bug causing cosmetic " " spaces to be missing between fields printed to the screen.


------------------------------------------------------------------------
r17544 | sahlberg | 2006-03-09 05:06:21 -0600 (Thu, 09 Mar 2006) | 3 lines
Changed paths:
   A /trunk/doc/README.binarytrees

add documentation on how to use the binary trees


------------------------------------------------------------------------
r17543 | jake | 2006-03-09 01:07:35 -0600 (Thu, 09 Mar 2006) | 15 lines
Changed paths:
   M /trunk/gtk/graph_analysis.c
   M /trunk/gtk/voip_calls_dlg.c

From Laurant Rabret:
Please find enclosed 2 patches.
- Voip_calls_dlg.c.patch fixes a problem that appears with a release
compiled with GTK 2.8 + Visual Studio 2003. It seems g_snprintf can
corrupt memory when a length bigger than the array size is provided in
the second parameter (even if the generated string is smaller than the
array actual size!!)
- graph_analysis.c.patch fixes a memory corruption problem easy to
reproduce. Just open the pcap file enclosed, select "Statistics"->"Flow
Graph" and activate the "Network source/destination addresses" radio
button before pressing OK. You'll see a crash dump.
Thanks to check in
Best Regards
Laurent

------------------------------------------------------------------------
r17542 | etxrab | 2006-03-09 00:02:42 -0600 (Thu, 09 Mar 2006) | 3 lines
Changed paths:
   M /trunk/asn1/h450/h4501.asn
   M /trunk/epan/dissectors/packet-h450.c

Fix Bug 725: 
0.10.14 shows "malformed packet" when showing H323 CS: FACILITY message with opcode "Calltransfer initiate" 

------------------------------------------------------------------------
r17541 | tpot | 2006-03-08 22:31:10 -0600 (Wed, 08 Mar 2006) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bootp.c

Display more info for some PXE DHCP options:

  - Display UUID for tag #97 (Client machine identifier)
  - Display UNDI major and minor version for tag #94 (Client network 
    interface identifier) 
  - Use value strings for tag #93 (Client system architecture)

The byte ordering is messed up for the GUID though.

------------------------------------------------------------------------
r17540 | lego | 2006-03-08 18:50:05 -0600 (Wed, 08 Mar 2006) | 3 lines
Changed paths:
   M /trunk/tools/lemon/lemon.c

Actually fix that leak!


------------------------------------------------------------------------
r17539 | obiot | 2006-03-08 16:52:31 -0600 (Wed, 08 Mar 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-wsp.c

Fix Coverity issue CID: 14 in wkh_accept_encoding().

------------------------------------------------------------------------
r17538 | gerald | 2006-03-08 16:42:24 -0600 (Wed, 08 Mar 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc.c

Fix a couple of compilation warnings.

------------------------------------------------------------------------
r17537 | gerald | 2006-03-08 16:13:21 -0600 (Wed, 08 Mar 2006) | 2 lines
Changed paths:
   M /trunk/epan/filesystem.c

Include tchar.h only if we're running Windows.  Fixup whitespace.

------------------------------------------------------------------------
r17536 | jake | 2006-03-08 15:48:36 -0600 (Wed, 08 Mar 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipmi.c

Consolidate duration decoding and presentation

------------------------------------------------------------------------
r17535 | ulfl | 2006-03-08 15:39:25 -0600 (Wed, 08 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-jxta.c

fix bug 772: and again, don't pass a NULL pointer to a printf like function on WIN32
------------------------------------------------------------------------
r17534 | gerald | 2006-03-08 14:55:32 -0600 (Wed, 08 Mar 2006) | 6 lines
Changed paths:
   M /trunk/config.h.win32
   M /trunk/epan/dissectors/packet-dcerpc.c
   M /trunk/epan/filesystem.c
   M /trunk/epan/libethereal.def
   M /trunk/epan/strutil.c
   M /trunk/epan/strutil.h
   M /trunk/gtk/font_utils.c
   M /trunk/gtk/main.c
   M /trunk/gtk/webbrowser.c
   M /trunk/gtk/win32-file-dlg.c

Use Unicode for all native Win32 calls.  Unicode Windows applications
use UTF-16 internally and GTK+ 2.x uses UTF-8, which means we have to
do a lots of conversions.

Add utf_8to16() and utf_16to8 convenience functions to strutil.c.

------------------------------------------------------------------------
r17533 | etxrab | 2006-03-08 12:58:08 -0600 (Wed, 08 Mar 2006) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bssgp.c

CID4 and CID3 Change
 if ((value >= 1) || (value <= 0x4a)) {

to  if ((value >= 1) && (value <= 0x4a)) {

------------------------------------------------------------------------
r17532 | etxrab | 2006-03-08 12:56:13 -0600 (Wed, 08 Mar 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-snmp.c

Fix:
 Coverity CID19 Remove an uneccesarry line
CID20 Use the code from the asn2eth generated dissector while at it.
------------------------------------------------------------------------
r17531 | lroland | 2006-03-08 12:42:16 -0600 (Wed, 08 Mar 2006) | 3 lines
Changed paths:
   M /trunk/gtk/tcp_graph.c

Make calculation of TCP Graph bounds more robust. The calculation might have failed in unusual conditions. 
This bug was discovered while looking at defects #130 and #131 discovered by  coverity. 
This patch also fixes these non-severe defects.
------------------------------------------------------------------------
r17530 | kukosa | 2006-03-08 07:50:04 -0600 (Wed, 08 Mar 2006) | 2 lines
Changed paths:
   M /trunk/asn1/ranap/ranap.cnf
   M /trunk/epan/dissectors/packet-per.c
   M /trunk/epan/dissectors/packet-per.h
   M /trunk/epan/dissectors/packet-ranap.c

better support for ASN.1 Enumerated type in PER decoding
support in asn2eth will follow
------------------------------------------------------------------------
r17529 | gram | 2006-03-08 07:36:40 -0600 (Wed, 08 Mar 2006) | 10 lines
Changed paths:
   M /trunk/epan/ipv4.c

Coverity CID 103 pointed me to this section of code. The buffer
overrun that Coverity thought existed does not exist. But I did
notice something else: a signed/unsigned disparity between
net_bits and new_nmask_bits.

So I fixed that, then realized that the function in question, a static
function named created_mask, is only used by one other function in
the file.  So I got ride of create_nmask and moved its logic into the
single calling function, ipv4_addr_set_netmask_bits.

------------------------------------------------------------------------
r17528 | sahlberg | 2006-03-08 05:09:02 -0600 (Wed, 08 Mar 2006) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bgp.c

fix minor bug  coverity 74

length_remaining could become -1 and if so the next tvb access (tvb_memcpy()) would cause an exception.    not really an ethereal since it would have no ill effects in reality.



change !=0   to >0    to make it more clear what we actually test.




------------------------------------------------------------------------
r17527 | sahlberg | 2006-03-08 04:59:05 -0600 (Wed, 08 Mar 2006) | 3 lines
Changed paths:
   M /trunk/plugins/profinet/packet-pn-dcp.c

fix coverity bug 122


------------------------------------------------------------------------
r17526 | lego | 2006-03-08 04:58:09 -0600 (Wed, 08 Mar 2006) | 4 lines
Changed paths:
   M /trunk/tools/lemon/lemon.c

An unimportant and harmless one per run leak in a tool used for building... Coverity cannot evaluate that :P
run 14 CID 107


------------------------------------------------------------------------
r17525 | lego | 2006-03-08 04:53:12 -0600 (Wed, 08 Mar 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl-utils.c

Avoid passing junk to ssl_debug_printf fmt if a weird cipher is found ().
FIxes Coverity's run 14 CID 81


------------------------------------------------------------------------
r17524 | sahlberg | 2006-03-08 04:51:33 -0600 (Wed, 08 Mar 2006) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb-pipe.c

remove a redundant if statement


this if statement always evaluate to true since it is called from a single place that is only entered if the very same expression is also true there.




------------------------------------------------------------------------
r17523 | sahlberg | 2006-03-08 04:36:28 -0600 (Wed, 08 Mar 2006) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb-pipe.c

for really really weird malformed lanman packets    it is theoretically possible
that trp is uniunitialized.



coverity bug 46



------------------------------------------------------------------------
r17522 | jake | 2006-03-08 04:24:59 -0600 (Wed, 08 Mar 2006) | 2 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

Fix a cloding tag

------------------------------------------------------------------------
r17521 | lego | 2006-03-08 04:20:09 -0600 (Wed, 08 Mar 2006) | 3 lines
Changed paths:
   M /trunk/wiretap/netxray.c

Another off by one error found by coverity (CID 83), using > instead of >= when comparing index against array size.


------------------------------------------------------------------------
r17520 | lego | 2006-03-08 04:14:51 -0600 (Wed, 08 Mar 2006) | 5 lines
Changed paths:
   M /trunk/wiretap/network_instruments.c

Coverity's run 14 CID 82.

 an off by one error (> vs >= in bounds check).


------------------------------------------------------------------------
r17519 | lego | 2006-03-08 03:49:31 -0600 (Wed, 08 Mar 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-h248.c
   M /trunk/epan/dissectors/packet-h248.h

Hide #line directives inside comments so that coverrity shows the errors it has found. It appears that Coverity doesn't look for source files but in the same dir where the generated file resides.


------------------------------------------------------------------------
r17518 | sahlberg | 2006-03-08 03:43:06 -0600 (Wed, 08 Mar 2006) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sndcp.c

coverity bug 73


dont call fragment_add   when len is -1 (or really really large if seen as a guint32)




------------------------------------------------------------------------
r17517 | sahlberg | 2006-03-08 03:03:10 -0600 (Wed, 08 Mar 2006) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb-mailslot.c

coverity turned up a false positive in cid 37


smb_info is guaranteed to always be non-NULL
so the test for !=NULL (which triggered coverity) is redundant



------------------------------------------------------------------------
r17516 | sahlberg | 2006-03-08 02:35:13 -0600 (Wed, 08 Mar 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nfs.c

remove some harmless but redundant code


coverity  cid 31


------------------------------------------------------------------------
r17515 | jake | 2006-03-08 01:06:42 -0600 (Wed, 08 Mar 2006) | 1 line
Changed paths:
   M /trunk/gtk/graph_analysis.c

Fix left open file (coverity CID 108) and g_string leak. Clean up double width line drawing.
------------------------------------------------------------------------
r17514 | gram | 2006-03-07 16:38:51 -0600 (Tue, 07 Mar 2006) | 4 lines
Changed paths:
   M /trunk/epan/osi-utils.c

Remove dead code. Due the to if() test that checks for specific
values of 'length', the code in question can never run.
This fixes Coverity bug ID #1.

------------------------------------------------------------------------
r17513 | gerald | 2006-03-07 16:14:12 -0600 (Tue, 07 Mar 2006) | 3 lines
Changed paths:
   M /trunk/gtk/main.c

Fix what Coverity CID 61 was actually complaining about:  Don't pass a NULL
value to get_interface_descriptive_name().

------------------------------------------------------------------------
r17512 | sahlberg | 2006-03-07 15:18:08 -0600 (Tue, 07 Mar 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-aim.c

potential dereference of null pointer


coverity cid 39


------------------------------------------------------------------------
r17511 | sahlberg | 2006-03-07 14:52:23 -0600 (Tue, 07 Mar 2006) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-nt.c

fix a potential assignment of a wild pointer

fixes coverity cid 128


------------------------------------------------------------------------
r17510 | etxrab | 2006-03-07 14:51:05 -0600 (Tue, 07 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sigcomp.c

Fix Coverity CID: 8 dead code.
------------------------------------------------------------------------
r17509 | sahlberg | 2006-03-07 14:47:20 -0600 (Tue, 07 Mar 2006) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb-pipe.c

fix a potential null dereference

found in coverity cid:48


------------------------------------------------------------------------
r17508 | etxrab | 2006-03-07 14:24:11 -0600 (Tue, 07 Mar 2006) | 1 line
Changed paths:
   M /trunk/tools/lemon/lemon.c

Undo the prevous unfortunate "rearrangement of code".
------------------------------------------------------------------------
r17507 | gram | 2006-03-07 14:01:42 -0600 (Tue, 07 Mar 2006) | 3 lines
Changed paths:
   M /trunk/epan/strutil.c

Remove a case statement which can never be reached, because the
previous isprint() test covers that case. This fixes Coverity bug ID #2.

------------------------------------------------------------------------
r17506 | gerald | 2006-03-07 13:53:57 -0600 (Tue, 07 Mar 2006) | 5 lines
Changed paths:
   M /trunk/docbook/release-notes.xml
   M /trunk/epan/dissectors/packet-gsm_sms.c

Fix Coverity run 12, CID 104:  Don't overflow a guint8, and don't read past
the end of an array.

Update the release notes.

------------------------------------------------------------------------
r17505 | gerald | 2006-03-07 13:17:00 -0600 (Tue, 07 Mar 2006) | 2 lines
Changed paths:
   M /trunk/conditions.c

Fix Coverity run 12 CID 110: Make sure we don't dereference a NULL pointer.

------------------------------------------------------------------------
r17504 | gerald | 2006-03-07 13:11:35 -0600 (Tue, 07 Mar 2006) | 3 lines
Changed paths:
   M /trunk/gtk/main.c

Fix Coverity run 12 CID 61:  In main_cf_cb_live_capture_update_started(),
make sure capture_opts isn't NULL before we try to use it.

------------------------------------------------------------------------
r17503 | etxrab | 2006-03-07 12:19:42 -0600 (Tue, 07 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-tipc.c

Dissect part of TIPCv2.
------------------------------------------------------------------------
r17502 | etxrab | 2006-03-07 12:18:04 -0600 (Tue, 07 Mar 2006) | 2 lines
Changed paths:
   M /trunk/tools/lemon/lemon.c

Fix a bug reported by covierty and solved by http://www.sqlite.org/cvstrac/rlog?f=sqlite/tool/lemon.c
Rearrange the code a bit to make it easier to make a diff with the sqlite version of lemon.
------------------------------------------------------------------------
r17501 | jake | 2006-03-07 10:39:54 -0600 (Tue, 07 Mar 2006) | 3 lines
Changed paths:
   M /trunk/gtk/rtp_analysis.c

Solving various uninitialized variable warnings.
coverity reports 132, 133 and 134

------------------------------------------------------------------------
r17500 | gerald | 2006-03-07 10:31:47 -0600 (Tue, 07 Mar 2006) | 10 lines
Changed paths:
   M /trunk/epan/emem.c

From Jeff Morriss:

  emem.c wouldn't compile with EP_DEBUG_FREE and SE_DEBUG_FREE defined.

  The attached patch fixes that and cleans up some warnings that showed
  up with those two were defined, too.  (In fact 95% of the patch is
  for warnings.)

Fix up whitespace.

------------------------------------------------------------------------
r17499 | gerald | 2006-03-07 10:28:25 -0600 (Tue, 07 Mar 2006) | 4 lines
Changed paths:
   M /trunk/epan/packet.c

Initialize a return value.  Found by Coverity.

Fix up whitespace.

------------------------------------------------------------------------
r17498 | jake | 2006-03-07 09:22:57 -0600 (Tue, 07 Mar 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

Catch negative return value, leading to near infinite loop. 
Filed as coverity bug 136.

------------------------------------------------------------------------
r17497 | lroland | 2006-03-07 08:44:25 -0600 (Tue, 07 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/stats_tree.c

Fix a possible NULL pointer dereference (coverity bug id 32)
------------------------------------------------------------------------
r17496 | lego | 2006-03-07 08:10:30 -0600 (Tue, 07 Mar 2006) | 4 lines
Changed paths:
   M /trunk/epan/emem.c
   M /trunk/epan/emem.h

Rename set_string_hash... into se_tree_xxx_string as proposed by ronnie for consistency whith its real nature.



------------------------------------------------------------------------
r17495 | lego | 2006-03-07 08:02:25 -0600 (Tue, 07 Mar 2006) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-alcap.c

From Jeff Morris,

Avoid an off by one error in dissect_fields_dnsea() and dissect_fields_onsea()

Fixes Bug 794


------------------------------------------------------------------------
r17494 | lroland | 2006-03-07 07:48:54 -0600 (Tue, 07 Mar 2006) | 2 lines
Changed paths:
   M /trunk/epan/packet.c

Fix a possible NULL pointer dereference discovered by coverity.
I'm not sure, if it is possible to get a NULL pointer here, but it is safer to fix it.
------------------------------------------------------------------------
r17493 | lroland | 2006-03-07 07:11:08 -0600 (Tue, 07 Mar 2006) | 1 line
Changed paths:
   M /trunk/gtk/sip_stat.c

Use g_assert to save us from dereferencing a NULL pointer. g_warning is not strong enough. This should fix a defect discovered by coverity.
------------------------------------------------------------------------
r17492 | sahlberg | 2006-03-07 04:25:42 -0600 (Tue, 07 Mar 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi.c

rewrite of some hairy code


fixes (hopefully) coverity bug 137


------------------------------------------------------------------------
r17491 | lego | 2006-03-07 00:33:47 -0600 (Tue, 07 Mar 2006) | 3 lines
Changed paths:
   M /trunk/epan/emem.c

use an elaborated key for the string keyed "hash table"


------------------------------------------------------------------------
r17490 | etxrab | 2006-03-07 00:15:06 -0600 (Tue, 07 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/sigcomp-udvm.c

Fix a bug reported by coverity.
------------------------------------------------------------------------
r17489 | lego | 2006-03-06 23:24:02 -0600 (Mon, 06 Mar 2006) | 4 lines
Changed paths:
   M /trunk/epan/asn1.c

ep_strdup stack buffer before returning it.
fixes coverity error 109.


------------------------------------------------------------------------
r17488 | lego | 2006-03-06 22:40:57 -0600 (Mon, 06 Mar 2006) | 4 lines
Changed paths:
   M /trunk/plugins/lua/elua_util.c

Remove strhash test code from lua...



------------------------------------------------------------------------
r17487 | lego | 2006-03-06 22:33:46 -0600 (Mon, 06 Mar 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-alcap.c
   M /trunk/epan/dissectors/packet-telnet.c

- contsify a variable in packet-alcap.c to see if a fake bug reported by coverty goes away.
- fix an off by one error in packet-telnet.c reported by coverty


------------------------------------------------------------------------
r17486 | lego | 2006-03-06 19:25:14 -0600 (Mon, 06 Mar 2006) | 6 lines
Changed paths:
   M /trunk/plugins/lua/elua.c
   M /trunk/plugins/lua/elua.h
   M /trunk/plugins/lua/elua_gui.c
   M /trunk/plugins/lua/elua_pinfo.c
   M /trunk/plugins/lua/elua_proto.c
   M /trunk/plugins/lua/elua_tap.c
   M /trunk/plugins/lua/elua_tree.c
   M /trunk/plugins/lua/elua_tvb.c
   M /trunk/plugins/lua/elua_util.c

- merge SubTree, ProtoTree and ProtoItem into a single TreeItem class.
- By the same token get rid of ProtoFieldArray having Proto.fields attribute been a lua "Array" containing fields.

(still untested, and probably broken)


------------------------------------------------------------------------
r17485 | lego | 2006-03-06 19:15:29 -0600 (Mon, 06 Mar 2006) | 3 lines
Changed paths:
   M /trunk/epan/emem.c
   M /trunk/epan/emem.h

Add a hash table with string keys based on the red/black tree.


------------------------------------------------------------------------
r17484 | etxrab | 2006-03-06 14:06:05 -0600 (Mon, 06 Mar 2006) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi.c

From Ming Zhang:
Update on dissector packet-scsi

* modepage processing for MMC
* support cmd Get Event Status Notification
* support cmd start stop unit for mmc

------------------------------------------------------------------------
r17483 | gerald | 2006-03-06 13:49:34 -0600 (Mon, 06 Mar 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

Handle a null pointer.  Fixes bugs 778 and 787.

------------------------------------------------------------------------
r17482 | jmayer | 2006-03-06 11:00:33 -0600 (Mon, 06 Mar 2006) | 1 line
Changed paths:
   M /trunk/FAQ
   M /trunk/help/faq.txt
   M /trunk/manuf

Update manuf, FAQ, help/faq.txt
------------------------------------------------------------------------
r17481 | gerald | 2006-03-06 10:30:45 -0600 (Mon, 06 Mar 2006) | 3 lines
Changed paths:
   M /trunk/Makefile.am

Remove the test-splint target.  Splint never did work on the Ethereal sources
and it doesn't look like that will change any time soon.

------------------------------------------------------------------------
r17480 | sahlberg | 2006-03-06 08:30:34 -0600 (Mon, 06 Mar 2006) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nfs.c
   M /trunk/epan/dissectors/packet-nfs.h
   M /trunk/epan/dissectors/packet-nlm.c
   M /trunk/epan/dissectors/packet-rpc.c

 get rid of another slow hashtable  and one global variable and
replace it with a better and memleak free se_tree



------------------------------------------------------------------------
r17479 | sahlberg | 2006-03-06 07:45:30 -0600 (Mon, 06 Mar 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nfs.c

replace one hashtable storing filehandles with a new se tree

this should make it quite a bit faster than before.



------------------------------------------------------------------------
r17478 | sahlberg | 2006-03-06 04:39:31 -0600 (Mon, 06 Mar 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nfs.c

replace a g_malloc()/g_free() pair with ep_alloc() instead


------------------------------------------------------------------------
r17477 | sahlberg | 2006-03-06 04:25:19 -0600 (Mon, 06 Mar 2006) | 20 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nfs.c
   M /trunk/epan/emem.c
   M /trunk/epan/emem.h

add helper to build (red/black) trees from a key that is a vector of guin32 arrays.

test this functionality by calling these vector insert/lookup tree functions from the nfs dissector for when filehandles are used as a key.

these vector functions could also be used to efficiently store conversations :
se_tree_key_t[6] = {
	{ addr_len/4,   &src_addr },
	{ addr_len/4,	&dst_addr },
	{ 1,		&src_port32 },
	{ 1,		&dst_port32 },
	{ 1,		&protocol32 },
	{ 0, NULL }
}


(the nfs dissector needs a LOT of work. It is very painful to work with 
very large nfs traces with all the memory it wastes (and eats) as well as how slow all the tables make it)



------------------------------------------------------------------------
r17476 | etxrab | 2006-03-06 00:21:01 -0600 (Mon, 06 Mar 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-m3ua.c

From Jeff Morriss:
The M3UA I-G and -bis specify a couple of registration result codes that 
the M3UA dissector doesn't currently understand.  The attached patch fixes that.
------------------------------------------------------------------------
r17475 | etxrab | 2006-03-06 00:19:11 -0600 (Mon, 06 Mar 2006) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-edonkey.c
   M /trunk/epan/dissectors/packet-edonkey.h

From Jhon Sullivan:
Version 0.47a of eMule extends the eDonkey protocol to support files up to 256GB in length. This patch adds support for the new packet types, and changes to existing packets, used to support this.

In addition, it seems to be getting more common to use compression on the index server connection. The packets used are just like the uncompressed versions, except transmitted as a zlib compressed stream, so I've added dissection for the contents of those too.

Plus a couple of bugfixes to the UDP packet dissection.

------------------------------------------------------------------------
r17474 | etxrab | 2006-03-05 14:21:19 -0600 (Sun, 05 Mar 2006) | 2 lines
Changed paths:
   M /trunk/asn1/ranap/ranap.cnf
   M /trunk/epan/dissectors/packet-per.c
   M /trunk/epan/dissectors/packet-per.h
   M /trunk/epan/dissectors/packet-ranap.c

Make a new PER function dissect_per_enumerated() and use it for the two places in RANAP where
extensions has been made to enumerations. asn2eth should be updated to use it.
------------------------------------------------------------------------
r17473 | etxrab | 2006-03-05 12:39:53 -0600 (Sun, 05 Mar 2006) | 1 line
Changed paths:
   M /trunk/asn1/Makefile.nmake
   A /trunk/asn1/acp133/Makefile.nmake
   A /trunk/epan/dissectors/packet-acp133.c
   A /trunk/epan/dissectors/packet-acp133.h

Add the actual dissector, win makefile and update the asn1 makefile.
------------------------------------------------------------------------
r17472 | jmayer | 2006-03-05 12:38:41 -0600 (Sun, 05 Mar 2006) | 1 line
Changed paths:
   M /trunk/asn1/acp133/Makefile
   M /trunk/asn1/acp133/acp133.asn
   M /trunk/asn1/acp133/acp133.cnf
   M /trunk/asn1/acp133/packet-acp133-template.c
   M /trunk/asn1/acp133/packet-acp133-template.h

propset ...
------------------------------------------------------------------------
r17471 | gal | 2006-03-05 05:28:13 -0600 (Sun, 05 Mar 2006) | 1 line
Changed paths:
   A /trunk/asn1/acp133
   A /trunk/asn1/acp133/Makefile
   A /trunk/asn1/acp133/acp133.asn
   A /trunk/asn1/acp133/acp133.cnf
   A /trunk/asn1/acp133/packet-acp133-template.c
   A /trunk/asn1/acp133/packet-acp133-template.h
   M /trunk/asn1/dop/dop.asn
   M /trunk/asn1/x411/x411-exp.cnf
   M /trunk/asn1/x411/x411.cnf
   M /trunk/asn1/x509if/packet-x509if-template.c
   M /trunk/asn1/x509if/x509if-exp.cnf
   M /trunk/asn1/x509if/x509if.cnf
   M /trunk/asn1/x509sat/packet-x509sat-template.c
   M /trunk/asn1/x509sat/x509sat.cnf
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-x411.c
   M /trunk/epan/dissectors/packet-x411.h
   M /trunk/epan/dissectors/packet-x509if.c
   M /trunk/epan/dissectors/packet-x509if.h
   M /trunk/epan/dissectors/packet-x509sat.c
   M /trunk/epan/dissectors/packet-x509sat.h

ACP133 attribute syntaxes and attribute definitions used by the DAP, DSP and DISP dissectors. Also includes X.402 definitions and OID registrations for object classes.
------------------------------------------------------------------------
r17470 | sahlberg | 2006-03-04 23:36:46 -0600 (Sat, 04 Mar 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

convert another hashtable for tcp into se_tree


------------------------------------------------------------------------
r17469 | guy | 2006-03-04 22:17:07 -0600 (Sat, 04 Mar 2006) | 2 lines
Changed paths:
   M /trunk/capture_loop.c

Add in a variable we need on Windows.

------------------------------------------------------------------------
r17468 | guy | 2006-03-04 22:11:57 -0600 (Sat, 04 Mar 2006) | 17 lines
Changed paths:
   M /trunk/capture_loop.c
   M /trunk/tethereal.c

In the capture_loop.c code, open the capture device for input before
doing anything with the output file, so that

	1) if the attempt to open the capture device fails, we don't
	   bother creating any output files;

	2) we could relinquish privileges permanently as soon as we
	   finish opening the capture device, so we don't have to give
	   them up temporarily when opening the output file, reclaim
	   them to open the input device, and then give them up
	   permanently;

(we already do that in Tethereal).

While we're at it, set the capture filter immediately after opening the
capture device, so we quit before opening capture devices if that fails.

------------------------------------------------------------------------
r17467 | sahlberg | 2006-03-04 22:01:34 -0600 (Sat, 04 Mar 2006) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c
   M /trunk/epan/emem.c
   M /trunk/epan/emem.h
   M /trunk/epan/libethereal.def

initial implementation of binary tree support with se allocation scope

this is to test out a basic implementation of binary trees and the api required for the helpers


------------------------------------------------------------------------
r17466 | guy | 2006-03-04 21:26:21 -0600 (Sat, 04 Mar 2006) | 2 lines
Changed paths:
   M /trunk/capture_loop.c
   M /trunk/capture_loop.h

Make some routines not used outside capture_loop.c static.

------------------------------------------------------------------------
r17465 | guy | 2006-03-04 21:14:16 -0600 (Sat, 04 Mar 2006) | 12 lines
Changed paths:
   M /trunk/capture.c
   M /trunk/capture.h
   M /trunk/capture_loop.c
   M /trunk/capture_loop.h
   M /trunk/capture_sync.c
   M /trunk/capture_sync.h
   M /trunk/dumpcap.c
   M /trunk/tethereal.c

Pass two strings in capture child messages, so the child can send
primary and secondary error messages and let the parent worry about how
to display them.  This means dumpcap doesn't need stub routines for
generating the formatting tags for the primary and secondary messages.

Have a separate message for capture filter errors, so that the parent
can check whether the capture filter looks like a display filter and
report the appropriate message.  This means that dumpcap doesn't need a
stub routine for compiling display filters (a stub routine also means
that Ethereal won't do the check for capture filters that look like
display filters!).

------------------------------------------------------------------------
r17464 | lego | 2006-03-04 20:47:00 -0600 (Sat, 04 Mar 2006) | 3 lines
Changed paths:
   M /trunk/gtk/funnel_stat.c

wrong name.


------------------------------------------------------------------------
r17463 | lego | 2006-03-04 20:03:51 -0600 (Sat, 04 Mar 2006) | 3 lines
Changed paths:
   M /trunk/plugins/lua/elua_gui.c

+ retap_packets()


------------------------------------------------------------------------
r17462 | lego | 2006-03-04 20:01:16 -0600 (Sat, 04 Mar 2006) | 6 lines
Changed paths:
   M /trunk/epan/funnel.h
   M /trunk/gtk/funnel_stat.c
   M /trunk/plugins/lua/elua_dumper.c
   M /trunk/plugins/lua/elua_proto.c
   M /trunk/tap-funnel.c

+ retap_packets()
+ complete gtk TextWindow
+ fix elua_dumper
+ fix elua_proto


------------------------------------------------------------------------
r17461 | guy | 2006-03-04 16:33:04 -0600 (Sat, 04 Mar 2006) | 5 lines
Changed paths:
   M /trunk/Makefile.common
   M /trunk/capture_loop.c
   M /trunk/capture_loop.h
   A /trunk/pcapio.c
   A /trunk/pcapio.h
   M /trunk/ringbuffer.c
   M /trunk/ringbuffer.h
   M /trunk/tethereal.c

When capturing, we only support writing to libpcap files.  Given that,
bypass Wiretap; that means we don't have to run the packet through
wtap_process_pcap_packet() and then undo that conversion in Wiretap if
we're just going to write it out, shortening the code path.

------------------------------------------------------------------------
r17460 | etxrab | 2006-03-04 04:10:48 -0600 (Sat, 04 Mar 2006) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi.c

From Ming Zhang:
Updated dissector packet-scsi to

* decode the device configuration mode page;
* decode the request sense response;
* fix a wrong lens print in several writeX(). this happens when one packet contains several iscsi pdu. one write data pdu will be explained as request with LEN extracted (but it is not a cdb so it was wrong).
* split the dissect_scsi_snsinfo() into 2 parts so the sense data decode part can be a subroutine shared by requestsense() and maybe more places.


------------------------------------------------------------------------
r17459 | etxrab | 2006-03-04 04:09:47 -0600 (Sat, 04 Mar 2006) | 5 lines
Changed paths:
   M /trunk/gtk/gsm_map_stat.c

From Florent Drouin:

Just a little correction.
In the last patch for gtk/gsm_map_stat.c applied, the variable "j" was changed to "i" .

------------------------------------------------------------------------
r17458 | etxrab | 2006-03-04 04:07:19 -0600 (Sat, 04 Mar 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isup.c

Fix bug 786

There is error when ethereal dissects UMTS AMR codec info.
The "Initial Codec Mode" does not exist in 3GPP TS 26.103(v4.a.0)
but OM(Optimization Mode) is correct parameter.

------------------------------------------------------------------------
r17457 | gerald | 2006-03-03 14:44:53 -0600 (Fri, 03 Mar 2006) | 2 lines
Changed paths:
   M /trunk/epan/emem.c

Use intptr_t for int-to-pointer conversions.

------------------------------------------------------------------------
r17456 | guy | 2006-03-03 04:17:04 -0600 (Fri, 03 Mar 2006) | 8 lines
Changed paths:
   M /trunk/tethereal.c

Clean up white space.

Don't warn about a live capture format other than libpcap format if
you're not capturing to a file.

Do warn about a maximum capture file specification if you're not
capturing to a file.

------------------------------------------------------------------------
r17455 | guy | 2006-03-03 04:14:27 -0600 (Fri, 03 Mar 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

Squelch a compiler warning.

------------------------------------------------------------------------
r17454 | jake | 2006-03-03 01:12:51 -0600 (Fri, 03 Mar 2006) | 4 lines
Changed paths:
   D /trunk/doc/ethereal-tut.mgp

ethereal-tut.mgp has a few problems:
* Written almost 6 years ago, some of the information is outdated.
* The referenced images are missing, so the presentation won't run.
The author agrees to remove it
------------------------------------------------------------------------
r17453 | lego | 2006-03-02 16:55:14 -0600 (Thu, 02 Mar 2006) | 3 lines
Changed paths:
   M /trunk/plugins/lua/elua_gui.c
   M /trunk/plugins/lua/elua_tap.c

- make them work as the got broken while docommenting them.


------------------------------------------------------------------------
r17452 | etxrab | 2006-03-02 15:31:33 -0600 (Thu, 02 Mar 2006) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-lapd.c

The attached patch adds support for LAPD frames captured using vISDN thru 
libpcap. The support has already been included in libpcap.

The patch adds a new wiretap encapsulation, the necessary glue to decode 
SLL-encapsulated frames, and some minor change in the LAPD dissector in order 
to support the remote-to-remote frames captured on the ISDN E-Channel.

Please apply ethereal-encap-table.diff before, as it fixes a misalignment in 
the encapsulation names table.

------------------------------------------------------------------------
r17451 | etxrab | 2006-03-02 15:29:15 -0600 (Thu, 02 Mar 2006) | 11 lines
Changed paths:
   M /trunk/capture-wpcap.c
   M /trunk/epan/column.c
   M /trunk/epan/column_info.h
   M /trunk/epan/dissectors/packet-frame.c

from Daniele Orlandi:
The attached patch adds support for LAPD frames captured using vISDN thru 
libpcap. The support has already been included in libpcap.

The patch adds a new wiretap encapsulation, the necessary glue to decode 
SLL-encapsulated frames, and some minor change in the LAPD dissector in order 
to support the remote-to-remote frames captured on the ISDN E-Channel.

Please apply ethereal-encap-table.diff before, as it fixes a misalignment in 
the encapsulation names table.

------------------------------------------------------------------------
r17450 | etxrab | 2006-03-02 15:28:05 -0600 (Thu, 02 Mar 2006) | 12 lines
Changed paths:
   M /trunk/wiretap/libpcap.c
   M /trunk/wiretap/wtap.c
   M /trunk/wiretap/wtap.h

From Daniele Orlandi:

The attached patch adds support for LAPD frames captured using vISDN thru 
libpcap. The support has already been included in libpcap.

The patch adds a new wiretap encapsulation, the necessary glue to decode 
SLL-encapsulated frames, and some minor change in the LAPD dissector in order 
to support the remote-to-remote frames captured on the ISDN E-Channel.

Please apply ethereal-encap-table.diff before, as it fixes a misalignment in 
the encapsulation names table.

------------------------------------------------------------------------
r17449 | etxrab | 2006-03-02 15:19:25 -0600 (Thu, 02 Mar 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-diameter-defs.h

Make 3gpp AVP:s Vendor specific
------------------------------------------------------------------------
r17448 | etxrab | 2006-03-02 15:17:56 -0600 (Thu, 02 Mar 2006) | 1 line
Changed paths:
   M /trunk/diameter/dictionary.xml

Correct some AVP types
------------------------------------------------------------------------
r17447 | sahlberg | 2006-03-02 15:17:18 -0600 (Thu, 02 Mar 2006) | 12 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi.c


From Ming Zhang

Add dissection of some additional SCSI SSC commands :

space6
erase6
locate10
space16
locate16


------------------------------------------------------------------------
r17446 | etxrab | 2006-03-02 14:50:33 -0600 (Thu, 02 Mar 2006) | 6 lines
Changed paths:
   M /trunk/gtk/Makefile.common
   M /trunk/gtk/conversations_ncp.c
   M /trunk/gtk/conversations_table.c
   M /trunk/gtk/expert_comp_table.c
   A /trunk/gtk/hostlist_ncp.c

From Greg Morris:
- Change to display NCP connection for each conversation
- New NCP Endpoints. Please apply
expert_comp_table
- Use local variable space instead of pointer. The previous implementation utilized pointers and the values would change the table data.

------------------------------------------------------------------------
r17445 | jake | 2006-03-02 14:44:13 -0600 (Thu, 02 Mar 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-iscsi.c

Fix for bug 783 from Didier Gautheron
I know nothing about iscsi , but try the attached patch. It fix the
wrong desegmentation and the ethereal bug isn't triggered anymore.

------------------------------------------------------------------------
r17444 | jake | 2006-03-02 08:44:50 -0600 (Thu, 02 Mar 2006) | 3 lines
Changed paths:
   M /trunk/gtk/gui_prefs.c
   M /trunk/gtk/layout_prefs.c

In order to reduce the height of the Preference dialog moving several items from the User Interface page to the Layout page.


------------------------------------------------------------------------
r17443 | sahlberg | 2006-03-02 03:33:49 -0600 (Thu, 02 Mar 2006) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-msproxy.c
   M /trunk/epan/dissectors/packet-tcp.c
   M /trunk/epan/dissectors/packet-tcp.h

 make the tcp_acked struct a pointer from the tcpd struct since we might need it hanging around.

only call subdissectors for packets that are NOT keepalives nor zerowindowprobes.


keepalives only contain garbage anyway
and zerowindowproes just contain a single byte of incomplete data so whats the point trying to dissect it further.



------------------------------------------------------------------------
r17442 | lego | 2006-03-01 18:22:39 -0600 (Wed, 01 Mar 2006) | 5 lines
Changed paths:
   M /trunk/plugins/lua/elua_dumper.c
   M /trunk/plugins/lua/elua_tap.c
   M /trunk/plugins/lua/elua_tvb.c


- remove some warnings from the windows compile
- some more Tap documentation


------------------------------------------------------------------------
r17441 | ulfl | 2006-03-01 18:06:15 -0600 (Wed, 01 Mar 2006) | 3 lines
Changed paths:
   M /trunk/epan/addr_resolv.c

I don't see any reason why we should only have to look for a hosts file in the personal preferences file, but not in the datafile path, as we doing it for a lot of other config files at runtime.

Add a try to use a global hosts file if one is available ...
------------------------------------------------------------------------
r17440 | gerald | 2006-03-01 15:31:07 -0600 (Wed, 01 Mar 2006) | 3 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/config.h.win32
   M /trunk/config.nmake
   M /trunk/plugins/lua/Makefile.nmake
   M /trunk/plugins/lua/elua_tree.c
   M /trunk/tools/win32-setup.sh
   M /trunk/version_info.c

Add Lua support by default for Win32.  Fix some compilation problems.
Add Lua information to the version paragraph.

------------------------------------------------------------------------
r17439 | jake | 2006-03-01 11:25:21 -0600 (Wed, 01 Mar 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sebek.c

From Camilo Viecco:
I just make some modifications for the current Sebek dissector so It can
understand both sebek V2 and V3 packets.



------------------------------------------------------------------------
r17438 | guy | 2006-02-28 19:54:46 -0600 (Tue, 28 Feb 2006) | 3 lines
Changed paths:
   M /trunk/capture_opts.c

A "-b" argument must have a : in it, as it has to specify a criterion
type and value, separated by a :.

------------------------------------------------------------------------
r17437 | guy | 2006-02-28 19:46:52 -0600 (Tue, 28 Feb 2006) | 10 lines
Changed paths:
   M /trunk/capture.c
   M /trunk/capture_info.c
   M /trunk/capture_info.h

Clean up indentation a bit.

In "capture_input_new_file()", don't call the callbacks unless we
succeed in opening the new file.  Have "capture_info_new_file()" return
a success/failure indication.

Improve the message logged when we fail to open the new file if we're
only opening it for the quick packet counts.  We really should put up an
alert box and give up on the capture at that point.

------------------------------------------------------------------------
r17436 | guy | 2006-02-28 19:21:51 -0600 (Tue, 28 Feb 2006) | 9 lines
Changed paths:
   M /trunk/tethereal.c

Reject attempts to use packet capture options when we're reading a saved
capture file.

We don't support saving live captures in any format other than libpcap
format (and probably don't want to - we really want to avoid using
Wiretap in that case, as it requires us to Wiretapify captured packets,
which adds extra processing to the capture path); reject attempts to do
that.

------------------------------------------------------------------------
r17435 | guy | 2006-02-28 18:22:34 -0600 (Tue, 28 Feb 2006) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipp.c

Use "tvb_format_string()" on strings extracted from the packet.

Use "tvb_get_ephemeral_string()" to extract a counted string into an
ep_allocated null-terminated buffer.

Constify a variable that points to packet data.

------------------------------------------------------------------------
r17434 | guy | 2006-02-28 18:15:55 -0600 (Tue, 28 Feb 2006) | 7 lines
Changed paths:
   M /trunk/asn1/rnsap/packet-rnsap-template.c
   M /trunk/epan/dissectors/packet-rnsap.c

Replace commenting-out of code with "#if 0"/#endif" - it's a bit safer
(you don't have to worry about comments in #if 0'ed otu code), and it
also fixes an unclosed comment (the commenting-out ended with /* rather
than */).

Fix up some indentation as well.

------------------------------------------------------------------------
r17433 | guy | 2006-02-28 18:14:12 -0600 (Tue, 28 Feb 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

Constify some items, and make one item static, so we don't initialize
stack copies at run time.

------------------------------------------------------------------------
r17432 | guy | 2006-02-28 18:13:19 -0600 (Tue, 28 Feb 2006) | 5 lines
Changed paths:
   M /trunk/gtk/flow_graph.c

The sequence and ack numbers in a TCP are guint32's, which means they
should be printed with "%u", not "%lu" (especially on LP64 platforms).

Fix up indentation.

------------------------------------------------------------------------
r17431 | guy | 2006-02-28 18:11:16 -0600 (Tue, 28 Feb 2006) | 9 lines
Changed paths:
   M /trunk/text2pcap.c

"help()" really just prints a usage message; it's not a full-blown help
system.  Just call it "usage()".

Also, it doesn't use the "progname" argument - it doesn't need to, it's
text2pcap-specific, and it prefers to call it "Text2pcap" anyway (and,
besides, argv[0] might well be a pathname).  Get rid of that argument.

Fix some white space.

------------------------------------------------------------------------
r17430 | jake | 2006-02-28 12:22:46 -0600 (Tue, 28 Feb 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ipmi.c

Fix for bug 762: implementing Off/On duration presentation in 10ms units
------------------------------------------------------------------------
r17429 | etxrab | 2006-02-28 11:40:01 -0600 (Tue, 28 Feb 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

From Martin Mathieson:
This patch adds the SIP History-Info header from RFC4244.

------------------------------------------------------------------------
r17428 | etxrab | 2006-02-28 11:01:29 -0600 (Tue, 28 Feb 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-isup.c

Bugfix: Dissect BAT ASE Signal IE properly.
------------------------------------------------------------------------
r17427 | etxrab | 2006-02-28 11:00:31 -0600 (Tue, 28 Feb 2006) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-per.c

From Peter Johansson:
fixes the following compilation warnings (and 
potential problems that may otherwise follow).

packet-per.c(796) : warning C4047: 'function' : 'struct _proto_node ** ' 
differs in levels of indirection from 'struct _proto_node *'
packet-per.c(796) : warning C4024: 'dissect_per_boolean' : different 
types for formal and actual parameter 7
packet-per.c(796) : warning C4700: local variable 'pi' used without 
having been initialized

------------------------------------------------------------------------
r17426 | sahlberg | 2006-02-28 04:10:08 -0600 (Tue, 28 Feb 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rpc.c

mark a few generated fields as generated using PROTO_ITEM_SET_GENERATED


------------------------------------------------------------------------
r17425 | sahlberg | 2006-02-28 03:39:53 -0600 (Tue, 28 Feb 2006) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c
   M /trunk/epan/dissectors/packet-ber.h
   M /trunk/epan/dissectors/packet-snmp.c
   M /trunk/epan/libethereal.def

add new   dissect_ber_integer64()  that can handle 8,16,24,32 and 64bit integers.

use proto_tree_add_[u]int[8,16,24,32,64]() instread of proto_tree_add_item()
since BER integers may well be encoded in less bytes than the type requires.
(i do not think the old code with proto_tree_add_item() could have handleded negative values very well    or at all.)




------------------------------------------------------------------------
r17424 | gerald | 2006-02-27 14:51:53 -0600 (Mon, 27 Feb 2006) | 4 lines
Changed paths:
   M /trunk/configure.in
   M /trunk/epan/emem.c

Add guard pages to emem.c.  GP memory is protected using mprotect()
under UNIX and VirtualProtect() under Windows.  This probably breaks 
compatibility with Windows 95/98/ME.

------------------------------------------------------------------------
r17423 | gerald | 2006-02-27 13:43:53 -0600 (Mon, 27 Feb 2006) | 2 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

Add an entry for the UMA dissector.

------------------------------------------------------------------------
r17422 | gerald | 2006-02-27 09:39:08 -0600 (Mon, 27 Feb 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bfd.c

Properly terminate a value string.  Fixes a current Buildbot complaint.

------------------------------------------------------------------------
r17421 | jake | 2006-02-27 08:03:48 -0600 (Mon, 27 Feb 2006) | 2 lines
Changed paths:
   M /trunk/tap-httpstat.c

Solving minor annoyances.

------------------------------------------------------------------------
r17420 | etxrab | 2006-02-27 03:02:16 -0600 (Mon, 27 Feb 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-x11.c

from dieder:
packet-x11
copy and past overlooked? test with 8 but substract to 4.

------------------------------------------------------------------------
r17419 | etxrab | 2006-02-27 03:01:10 -0600 (Mon, 27 Feb 2006) | 8 lines
Changed paths:
   M /trunk/epan/addr_resolv.c
   M /trunk/file.c

From dider
file.c
time reference menu callback doesn't set  cf->filter, it dumps a core if 
you have a file big enough in find next/ find prev.

addr_resolv.c
leak memory, break list chain when snooping address.

------------------------------------------------------------------------
r17418 | ulfl | 2006-02-27 02:59:24 -0600 (Mon, 27 Feb 2006) | 1 line
Changed paths:
   M /trunk/docbook/edg_src/EDG_chapter_tools.xml

ooops, my latest changes doesn't seem to follow the DTD strictly ...
------------------------------------------------------------------------
r17417 | etxrab | 2006-02-27 02:35:24 -0600 (Mon, 27 Feb 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-per.c

Add extention bit if per internal fields shown.
------------------------------------------------------------------------
r17416 | etxrab | 2006-02-27 02:33:29 -0600 (Mon, 27 Feb 2006) | 3 lines
Changed paths:
   M /trunk/gtk/gsm_map_stat.c

From: Florent Drouin:
Add a test to avoid divide by zero during stat. display. Use new variable j, instead of i, already used in the loop.

------------------------------------------------------------------------
r17415 | lego | 2006-02-26 19:54:22 -0600 (Sun, 26 Feb 2006) | 3 lines
Changed paths:
   M /trunk/plugins/lua/elua.h
   M /trunk/plugins/lua/elua_tap.c

- Some more comments


------------------------------------------------------------------------
r17414 | ulfl | 2006-02-26 12:24:39 -0600 (Sun, 26 Feb 2006) | 1 line
Changed paths:
   M /trunk/docbook/edg_src/EDG_chapter_tools.xml

a complete rewrite of the Win32 installation procedure description with a step-by-step guide.
------------------------------------------------------------------------
r17413 | ulfl | 2006-02-26 12:21:50 -0600 (Sun, 26 Feb 2006) | 1 line
Changed paths:
   M /trunk/tools/win32-setup.sh

add a possible solution (add another package using cygwin) if a tool wasn't found.
------------------------------------------------------------------------
r17412 | jake | 2006-02-25 07:54:00 -0600 (Sat, 25 Feb 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

Fix bounds error.

------------------------------------------------------------------------
r17411 | lego | 2006-02-25 06:54:25 -0600 (Sat, 25 Feb 2006) | 4 lines
Changed paths:
   M /trunk/plugins/lua/elua.h
   M /trunk/plugins/lua/elua_dumper.c
   M /trunk/plugins/lua/elua_tree.c

The semantics of luaL_checkudata() change between 5.0 and 5.1 (the later triggers an error).
make sure isXxx() functions do not trigger an error, we want them to return not to pop the stack back to the lua caller.


------------------------------------------------------------------------
r17410 | etxrab | 2006-02-25 03:31:35 -0600 (Sat, 25 Feb 2006) | 1 line
Changed paths:
   M /trunk/Makefile.nmake

Add asn1 to the clean target
------------------------------------------------------------------------
r17409 | etxrab | 2006-02-25 03:28:52 -0600 (Sat, 25 Feb 2006) | 4 lines
Changed paths:
   M /trunk/gtk/sip_stat.c
   M /trunk/tap-sipstat.c

From Martin Mathieson

- add SIP response code 412 ("Conditional Request Failed") to stats taps.

------------------------------------------------------------------------
r17408 | etxrab | 2006-02-25 03:23:10 -0600 (Sat, 25 Feb 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

From Martin Mathieson:
This patch further tightens up testing for resent packets.
It now always compares the method.  I've seen examples where the called 
party hangs up, and chooses the same CSeq for the BYE as the calling 
party chose for the INVITE.

------------------------------------------------------------------------
r17407 | jmayer | 2006-02-24 22:38:39 -0600 (Fri, 24 Feb 2006) | 1 line
Changed paths:
   M /trunk/plugins/lua/doc

Ignore *.pod
------------------------------------------------------------------------
r17406 | lego | 2006-02-24 21:21:00 -0600 (Fri, 24 Feb 2006) | 14 lines
Changed paths:
   M /trunk/plugins/lua/Makefile.nmake
   M /trunk/plugins/lua/elua.h
   M /trunk/plugins/lua/elua_proto.c


- elua_proto
  - add doComments
  - fix an error in DissectorTable_remove
  - reorganize DissectorTable_try

 - elua.h
   squelch some warnings

- Makefile.nmake
  - replace the $^ macro with the targets (i.e. do what nmake was supposed to do)
  - move the doc target into the conditional part


------------------------------------------------------------------------
r17405 | jmayer | 2006-02-24 20:02:36 -0600 (Fri, 24 Feb 2006) | 3 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/doc/README.developer
   M /trunk/doc/ethereal-tut.mgp

Remove references to README.tvbuff. The Makefile.am should fix the
buildbot failure.

------------------------------------------------------------------------
r17404 | ulfl | 2006-02-24 18:02:26 -0600 (Fri, 24 Feb 2006) | 1 line
Changed paths:
   M /trunk/capture-pcap-util.c

an error return was missing a pcap_close() call
------------------------------------------------------------------------
r17403 | ulfl | 2006-02-24 18:00:33 -0600 (Fri, 24 Feb 2006) | 1 line
Changed paths:
   M /trunk/dumpcap.c

update some comments, as dumpcap no longer uses console window stuff
------------------------------------------------------------------------
r17402 | ulfl | 2006-02-24 17:59:22 -0600 (Fri, 24 Feb 2006) | 1 line
Changed paths:
   M /trunk/gtk/help_dlg.c
   M /trunk/gtk/help_dlg.h
   M /trunk/gtk/menu.c

add the dumpcap manpage to the menu
------------------------------------------------------------------------
r17401 | jake | 2006-02-24 15:54:54 -0600 (Fri, 24 Feb 2006) | 2 lines
Changed paths:
   M /trunk/doc/README.developer
   D /trunk/doc/README.tvbuff

Remove obsolete document README.tvbuff

------------------------------------------------------------------------
r17400 | jake | 2006-02-24 14:46:39 -0600 (Fri, 24 Feb 2006) | 2 lines
Changed paths:
   M /trunk/gtk/flow_graph.c

Fix bug 769. Print seq# and ack# as _unsigned_ int in the comment.

------------------------------------------------------------------------
r17399 | lego | 2006-02-24 02:44:49 -0600 (Fri, 24 Feb 2006) | 3 lines
Changed paths:
   M /trunk/plugins/lua/elua_makedoc.pl
   M /trunk/plugins/lua/elua_pinfo.c

I changed some vanames and did not compile...


------------------------------------------------------------------------
r17398 | jmayer | 2006-02-24 02:09:23 -0600 (Fri, 24 Feb 2006) | 1 line
Changed paths:
   M /trunk/tap-funnel.c

svn propset ...
------------------------------------------------------------------------
r17397 | lego | 2006-02-23 20:01:29 -0600 (Thu, 23 Feb 2006) | 3 lines
Changed paths:
   M /trunk/tethereal.c

finish adding the tethereal's funnel.


------------------------------------------------------------------------
r17396 | lego | 2006-02-23 19:41:59 -0600 (Thu, 23 Feb 2006) | 3 lines
Changed paths:
   M /trunk/Makefile.common
   A /trunk/tap-funnel.c

Add the (still unfinished) tethereal side of the funnel.


------------------------------------------------------------------------
r17395 | gerald | 2006-02-23 17:12:42 -0600 (Thu, 23 Feb 2006) | 2 lines
Changed paths:
   M /trunk/epan/emem.c

Print an error when we detect memory corruption.  Fix a typo in a comment.

------------------------------------------------------------------------
r17394 | jake | 2006-02-23 16:09:54 -0600 (Thu, 23 Feb 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipmi.c

Fix bug 765. ARMBER -> AMBER

------------------------------------------------------------------------
r17393 | sahlberg | 2006-02-23 16:03:55 -0600 (Thu, 23 Feb 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fcp.c

The task management flags in FCP are very useful to display since they convey that something real bad has happened.

Therefore put them and fence them at the start of the Info column



------------------------------------------------------------------------
r17392 | sahlberg | 2006-02-23 15:49:30 -0600 (Thu, 23 Feb 2006) | 6 lines
Changed paths:
   M /trunk/epan/strutil.c
   M /trunk/epan/strutil.h

create a real function to emulate g_strlcat()  for GTK<2
so that the linker will find it.

This eliminates the need to include strutil.h (where this was previously a macro)  in all callers of this function.


------------------------------------------------------------------------
r17391 | sahlberg | 2006-02-23 15:33:59 -0600 (Thu, 23 Feb 2006) | 3 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

when including menu.h  we also need to include stdio.h to get FILE


------------------------------------------------------------------------
r17390 | jake | 2006-02-23 15:22:54 -0600 (Thu, 23 Feb 2006) | 2 lines
Changed paths:
   M /trunk/epan/ftypes/ftype-pcre.c

Fix bug 764. Always initialize the members of the tuple on creation.

------------------------------------------------------------------------
r17389 | jake | 2006-02-23 14:53:20 -0600 (Thu, 23 Feb 2006) | 2 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

Fix bug 741. Menu/Toolbar follow auto scroll checkbox in capture options.

------------------------------------------------------------------------
r17388 | etxrab | 2006-02-23 14:06:52 -0600 (Thu, 23 Feb 2006) | 1 line
Changed paths:
   M /trunk/diameter/TGPPSh.xml
   M /trunk/diameter/dictionary.xml

Mark 3GPP AVP:s as Vendor specific.
------------------------------------------------------------------------
r17387 | etxrab | 2006-02-23 14:05:52 -0600 (Thu, 23 Feb 2006) | 1 line
Changed paths:
   M /trunk/asn1/MAP_Dialogue/Makefile.nmake
   M /trunk/asn1/inap/Makefile.nmake
   M /trunk/asn1/ldap/Makefile.nmake
   M /trunk/asn1/logotype-cert-extn/Makefile.nmake
   M /trunk/asn1/mms/Makefile.nmake
   M /trunk/asn1/nbap/Makefile.nmake
   M /trunk/asn1/ns-cert-exts/Makefile.nmake
   M /trunk/asn1/ocsp/Makefile.nmake
   M /trunk/asn1/pkcs1/Makefile.nmake
   M /trunk/asn1/pkinit/Makefile.nmake
   M /trunk/asn1/pkix1explicit/Makefile.nmake
   M /trunk/asn1/pkix1implicit/Makefile.nmake
   M /trunk/asn1/pkixcmp/Makefile.nmake
   M /trunk/asn1/pkixcrmf/Makefile.nmake
   M /trunk/asn1/pkixproxy/Makefile.nmake
   M /trunk/asn1/pkixqualified/Makefile.nmake
   M /trunk/asn1/pkixtsp/Makefile.nmake
   M /trunk/asn1/pres/Makefile.nmake
   M /trunk/asn1/ranap/Makefile.nmake
   M /trunk/asn1/ros/Makefile.nmake
   M /trunk/asn1/rtse/Makefile.nmake
   M /trunk/asn1/s4406/Makefile.nmake
   M /trunk/asn1/smrse/Makefile.nmake
   M /trunk/asn1/snmp/Makefile.nmake
   M /trunk/asn1/spnego/Makefile.nmake
   M /trunk/asn1/tcap/Makefile.nmake
   M /trunk/asn1/wlancertextn/Makefile.nmake
   M /trunk/asn1/x411/Makefile.nmake
   M /trunk/asn1/x420/Makefile.nmake
   M /trunk/asn1/x509af/Makefile.nmake
   M /trunk/asn1/x509ce/Makefile.nmake
   M /trunk/asn1/x509if/Makefile.nmake
   M /trunk/asn1/x509sat/Makefile.nmake

Add parsertab.pyc in clean target
------------------------------------------------------------------------
r17386 | etxrab | 2006-02-23 14:05:05 -0600 (Thu, 23 Feb 2006) | 1 line
Changed paths:
   M /trunk/asn1/Makefile.nmake
   M /trunk/asn1/acse/Makefile.nmake
   M /trunk/asn1/ansi_map/Makefile.nmake
   M /trunk/asn1/camel/Makefile.nmake
   M /trunk/asn1/cdt/Makefile.nmake
   M /trunk/asn1/cmip/Makefile.nmake
   M /trunk/asn1/cms/Makefile.nmake
   M /trunk/asn1/dap/Makefile.nmake
   M /trunk/asn1/disp/Makefile.nmake
   M /trunk/asn1/dop/Makefile.nmake
   M /trunk/asn1/dsp/Makefile.nmake
   M /trunk/asn1/ess/Makefile.nmake
   M /trunk/asn1/ftam/Makefile.nmake
   M /trunk/asn1/ftbp/Makefile.nmake
   M /trunk/asn1/gnm/Makefile.nmake
   M /trunk/asn1/gsm_ss/Makefile.nmake
   M /trunk/asn1/gsmmap/Makefile.nmake
   M /trunk/asn1/h225/Makefile.nmake
   M /trunk/asn1/h235/Makefile.nmake
   M /trunk/asn1/h248/Makefile.nmake
   M /trunk/asn1/h450/Makefile.nmake

Add parsertab.pyc in clean target
------------------------------------------------------------------------
r17385 | etxrab | 2006-02-23 14:03:42 -0600 (Thu, 23 Feb 2006) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-h245.c

From Alejandro Vaquero:

a patch for the VoipCalls to fix a couple of issues:
- a problem with the RTP Events (RFC2833) not been handle correctly
- Display the RTP stream in time order when the setup frame is after the 
RTP stream.
- fix a init issue that caused the H245 packet to not been displayed 
correctly.

------------------------------------------------------------------------
r17384 | etxrab | 2006-02-23 14:03:06 -0600 (Thu, 23 Feb 2006) | 9 lines
Changed paths:
   M /trunk/asn1/h245/Makefile.nmake
   M /trunk/asn1/h245/h245.cnf
   M /trunk/asn1/h245/packet-h245-template.c

From Alejandro Vaquero:

a patch for the VoipCalls to fix a couple of issues:
- a problem with the RTP Events (RFC2833) not been handle correctly
- Display the RTP stream in time order when the setup frame is after the 
RTP stream.
- fix a init issue that caused the H245 packet to not been displayed 
correctly.

------------------------------------------------------------------------
r17383 | etxrab | 2006-02-23 14:02:23 -0600 (Thu, 23 Feb 2006) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtp-events.c
   M /trunk/epan/dissectors/packet-rtp-events.h
   M /trunk/gtk/graph_analysis.c
   M /trunk/gtk/voip_calls.c

From Alejandro Vaquero:

a patch for the VoipCalls to fix a couple of issues:
- a problem with the RTP Events (RFC2833) not been handle correctly
- Display the RTP stream in time order when the setup frame is after the 
RTP stream.
- fix a init issue that caused the H245 packet to not been displayed 
correctly.

------------------------------------------------------------------------
r17382 | lego | 2006-02-23 11:02:29 -0600 (Thu, 23 Feb 2006) | 7 lines
Changed paths:
   M /trunk/plugins/lua
   M /trunk/plugins/lua/doc
   M /trunk/plugins/lua/elua_dumper.c
   M /trunk/plugins/lua/elua_makedoc.pl
   M /trunk/plugins/lua/elua_pinfo.c
   M /trunk/plugins/lua/elua_util.c

- More "docOMMentation" of the API

- also supress Address__ge and Address_gt because re-reading the ref manual I noticed that they are suplerfluous (Lua assumes that a > b is equivalent to b < a, which in most cases (as this) it does)

- have elua_makedoc.pl hanlde docomments in more than one line and after the line where the entity s defined.


------------------------------------------------------------------------
r17381 | jake | 2006-02-23 10:52:13 -0600 (Thu, 23 Feb 2006) | 2 lines
Changed paths:
   M /trunk/doc/README.malloc

Add ep_tvb_memdup() description to documentation

------------------------------------------------------------------------
r17380 | jake | 2006-02-23 05:56:18 -0600 (Thu, 23 Feb 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipmi.c

Fix for bug 762. Decode either LED function or off duration.

------------------------------------------------------------------------
r17379 | jmayer | 2006-02-23 04:18:05 -0600 (Thu, 23 Feb 2006) | 2 lines
Changed paths:
   M /trunk/plugins/lua/Makefile.am

Delete docs in maintainer-clean target

------------------------------------------------------------------------
r17378 | sahlberg | 2006-02-23 03:54:08 -0600 (Thu, 23 Feb 2006) | 14 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eth.c

add an expansion to ethernet source and destination addresses


inside this expansion show
1,    eth.addr      so people can see that this field exists (i think it is futile to use "hidden" fields and expect people to search through the infinitely long list of fields,   better show everything and they will see themself what fuields they can filter on)
2,  bit 0x01 of the first byte to show if it is Multi or Uni-cast
3, bit 0x02 of the first byte to show if it is a locally administrated address or not.
I do use the (to laymen) more descriptive names  "factory default"    instead of LocallyAdminAddr in the true_false string though.




 

------------------------------------------------------------------------
r17377 | sahlberg | 2006-02-23 03:11:00 -0600 (Thu, 23 Feb 2006) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-frame.c

fix for bug 718


dont play games with lnk_t
If the preference is set to unconditionally dissect everything as docsis   just call the docsis handler directly.



------------------------------------------------------------------------
r17376 | etxrab | 2006-02-23 00:35:45 -0600 (Thu, 23 Feb 2006) | 1 line
Changed paths:
   M /trunk/asn1/rnsap/Makefile.nmake
   M /trunk/asn1/rnsap/packet-rnsap-template.c
   M /trunk/epan/dissectors/packet-rnsap.c

Add TCAP ssn
------------------------------------------------------------------------
r17375 | lego | 2006-02-22 17:58:21 -0600 (Wed, 22 Feb 2006) | 5 lines
Changed paths:
   A /trunk/plugins/lua/elua_util.c

Forgot...

Elua functions in elua.c moved to this new file.


------------------------------------------------------------------------
r17374 | lego | 2006-02-22 17:55:11 -0600 (Wed, 22 Feb 2006) | 6 lines
Changed paths:
   M /trunk/plugins/lua/Makefile.am
   M /trunk/plugins/lua/Makefile.nmake
   M /trunk/plugins/lua/elua.c
   M /trunk/plugins/lua/elua.h
   M /trunk/plugins/lua/elua_dumper.c
   M /trunk/plugins/lua/elua_gui.c
   M /trunk/plugins/lua/elua_makedoc.pl
   M /trunk/plugins/lua/elua_makereg.pl
   M /trunk/plugins/lua/elua_pinfo.c
   M /trunk/plugins/lua/elua_proto.c
   M /trunk/plugins/lua/elua_tvb.c

- More documentation embeded in the source code.
- Changed some Macros
- Have dump:close NULLyfing the boxed object so that no futher operations are performed on a dumper once is closed.
- Check if elua_register.h has changed and avoid overwriting it if it hasn't changed to avoid unnecessary compilations.


------------------------------------------------------------------------
r17373 | tuexen | 2006-02-22 11:27:23 -0600 (Wed, 22 Feb 2006) | 3 lines
Changed paths:
   M /trunk/gtk/sctp_graph_dlg.c

From Irene Ruengler:
Fix bug regarding the lower left edge and the handling of points outside the displayed region.

------------------------------------------------------------------------
r17372 | etxrab | 2006-02-22 10:25:29 -0600 (Wed, 22 Feb 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sccp.c

Desegment DT1 messages.
------------------------------------------------------------------------
r17371 | jmayer | 2006-02-22 08:19:39 -0600 (Wed, 22 Feb 2006) | 1 line
Changed paths:
   M /trunk/plugins/lua/Makefile.am

elua_register.h wasn't built automatically
------------------------------------------------------------------------
r17370 | jake | 2006-02-22 06:04:03 -0600 (Wed, 22 Feb 2006) | 2 lines
Changed paths:
   M /trunk/gtk/win32-file-dlg.c
   M /trunk/gtk/win32-file-dlg.h

Remove svn:executable property from source files

------------------------------------------------------------------------
r17369 | sahlberg | 2006-02-22 04:45:23 -0600 (Wed, 22 Feb 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-snmp.c

make the old style SNMP dissector handle 64 bit integers better


fixes bug 723


------------------------------------------------------------------------
r17368 | sahlberg | 2006-02-22 03:53:22 -0600 (Wed, 22 Feb 2006) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipp.c

make IPP treat all fields with the name '*-time' and being 4 byte integers
as if they are unix 32 bit timestamps and display them as such.


this fixes bug 755


------------------------------------------------------------------------
r17367 | sahlberg | 2006-02-22 02:39:06 -0600 (Wed, 22 Feb 2006) | 5 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-bpdu.c
   M /trunk/epan/dissectors/packet-ppp.c

 from kirby files

ppp/bpdu update


------------------------------------------------------------------------
r17366 | etxrab | 2006-02-22 00:12:50 -0600 (Wed, 22 Feb 2006) | 1 line
Changed paths:
   A /trunk/asn1/cmip/cmip-exp.cnf
   A /trunk/asn1/disp/disp-exp.cnf
   A /trunk/asn1/dop/x501-exp.cnf
   A /trunk/asn1/ftam/ftam-exp.cnf
   A /trunk/asn1/inap/Makefile.nmake

Add some missing files.
------------------------------------------------------------------------
r17365 | etxrab | 2006-02-22 00:06:21 -0600 (Wed, 22 Feb 2006) | 1 line
Changed paths:
   M /trunk/wiretap/Makefile.nmake

Add makefile.nmake
------------------------------------------------------------------------
r17364 | jmayer | 2006-02-21 22:48:06 -0600 (Tue, 21 Feb 2006) | 1 line
Changed paths:
   D /trunk/plugins/lua/lualib

No need for empty lualib directory
------------------------------------------------------------------------
r17363 | lego | 2006-02-21 17:35:13 -0600 (Tue, 21 Feb 2006) | 3 lines
Changed paths:
   M /trunk/gtk/graph_analysis.c

I commented out this a while ago as they caused a crash in GTK2.8/cairo on my box. I checked it in by mistake with a lot of more files, even worst I did not pay attention to an e-mail on the list regarding the damage caused. Luckily Alejandro Vaquero contacted me directly.


------------------------------------------------------------------------
r17362 | lego | 2006-02-21 15:52:28 -0600 (Tue, 21 Feb 2006) | 5 lines
Changed paths:
   M /trunk/plugins/lua
   M /trunk/plugins/lua/Makefile.am
   A /trunk/plugins/lua/elua.c (from /trunk/plugins/lua/packet-lua.c:17356)
   A /trunk/plugins/lua/elua.h (from /trunk/plugins/lua/packet-lua.h:17356)
   A /trunk/plugins/lua/elua_dumper.c (from /trunk/plugins/lua/lua_dumper.c:17356)
   A /trunk/plugins/lua/elua_gui.c (from /trunk/plugins/lua/lua_gui.c:17356)
   A /trunk/plugins/lua/elua_makedoc.pl
   A /trunk/plugins/lua/elua_makereg.pl
   A /trunk/plugins/lua/elua_pinfo.c (from /trunk/plugins/lua/lua_pinfo.c:17356)
   A /trunk/plugins/lua/elua_plugin.c (from /trunk/plugins/lua/lua_plugin.c:17356)
   A /trunk/plugins/lua/elua_proto.c (from /trunk/plugins/lua/lua_proto.c:17356)
   A /trunk/plugins/lua/elua_tap.c (from /trunk/plugins/lua/lua_tap.c:17356)
   A /trunk/plugins/lua/elua_tree.c (from /trunk/plugins/lua/lua_tree.c:17356)
   A /trunk/plugins/lua/elua_tvb.c (from /trunk/plugins/lua/lua_tvb.c:17356)
   D /trunk/plugins/lua/lua_dumper.c
   D /trunk/plugins/lua/lua_gui.c
   D /trunk/plugins/lua/lua_pinfo.c
   D /trunk/plugins/lua/lua_plugin.c
   D /trunk/plugins/lua/lua_proto.c
   D /trunk/plugins/lua/lua_tap.c
   D /trunk/plugins/lua/lua_tree.c
   D /trunk/plugins/lua/lua_tvb.c
   D /trunk/plugins/lua/packet-lua.c
   D /trunk/plugins/lua/packet-lua.h

- rename all the c files
- have elua_makereg.pl generating the declaration and registration Macros for each module
- start of elua_makedoc.pl that should generate the Reference Manual from the code.


------------------------------------------------------------------------
r17361 | jake | 2006-02-21 15:30:27 -0600 (Tue, 21 Feb 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-syslog.c

Fix for bug 758: Adding facility codes 12-15 according to RFC 3164
------------------------------------------------------------------------
r17360 | etxrab | 2006-02-21 12:56:25 -0600 (Tue, 21 Feb 2006) | 1 line
Changed paths:
   M /trunk/asn1/ldap/Lightweight-Directory-Access-Protocol-V3.asn
   M /trunk/asn1/ldap/ldap.cnf
   M /trunk/asn1/ldap/packet-ldap-template.c

Put in some of the old functionallity.
------------------------------------------------------------------------
r17359 | jake | 2006-02-21 05:48:40 -0600 (Tue, 21 Feb 2006) | 2 lines
Changed paths:
   M /trunk/plugins/megaco/packet-megaco.c

Fix for bug 756. Handle CR as part of separator as well. 

------------------------------------------------------------------------
r17358 | jake | 2006-02-21 02:14:11 -0600 (Tue, 21 Feb 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-dns.c

Fix for bug 724: DNS dissector fails in handling the sign of Altitude in LOC type response (RFC1867)
------------------------------------------------------------------------
r17357 | etxrab | 2006-02-20 11:21:47 -0600 (Mon, 20 Feb 2006) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bfd.c

From Balint Reczey (IJ/ETH)

> The included patch fixes BFD version detection in the BFD packet 
> dissector and extends it to correctly dissect version 1 packets. The 
> Authentication Section part of the packet is still not dissected.
> 

------------------------------------------------------------------------
r17356 | etxrab | 2006-02-20 00:25:02 -0600 (Mon, 20 Feb 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-http.c

From Sake Blok:
Add a filter for X-Forwarded-For.
------------------------------------------------------------------------
r17355 | guy | 2006-02-19 17:51:39 -0600 (Sun, 19 Feb 2006) | 4 lines
Changed paths:
   M /trunk/gtk/file_dlg.c

For the "there's already a file with that name" dialog, use a wording
more like the one used by gedit.  (Note that the file in question might
not be a capture file, although it probably is.)

------------------------------------------------------------------------
r17354 | lego | 2006-02-19 15:51:34 -0600 (Sun, 19 Feb 2006) | 5 lines
Changed paths:
   M /trunk/plugins/lua/lua_dumper.c
   M /trunk/plugins/lua/lua_gui.c
   M /trunk/plugins/lua/lua_pinfo.c
   M /trunk/plugins/lua/lua_proto.c
   M /trunk/plugins/lua/lua_tap.c
   M /trunk/plugins/lua/lua_tree.c
   M /trunk/plugins/lua/lua_tvb.c
   M /trunk/plugins/lua/packet-lua.c
   M /trunk/plugins/lua/packet-lua.h

- Use lua 5.1
- Compress *_register() functions



------------------------------------------------------------------------
r17353 | jmayer | 2006-02-19 05:02:20 -0600 (Sun, 19 Feb 2006) | 3 lines
Changed paths:
   M /trunk/acinclude.m4

Recent checkins lost a change to make the liblualib check succeed on
Suse 9.3 (original checkin r17198).

------------------------------------------------------------------------
r17352 | etxrab | 2006-02-19 04:17:07 -0600 (Sun, 19 Feb 2006) | 1 line
Changed paths:
   M /trunk/asn1/gsmmap/packet-gsm_map-template.c
   M /trunk/epan/dissectors/packet-gsm_map.c

Remove c++ style comment.
------------------------------------------------------------------------
r17351 | jake | 2006-02-19 03:54:37 -0600 (Sun, 19 Feb 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-slowprotocols.c

Fix for bug 752:
IEEE802.3ah-2004 (OAM) Errored Frame Seconds Summary Event TLV is not being
decoded properly.  Per IEEE802.3ah-2004 section 57.5.3.4, item g, the Error
Running Total field should be 4-octets however Ethereal is trying to decode this
field as 8-octets which results in incorrect value reported for "Error Running
Total" and "Event Running Total".
------------------------------------------------------------------------
r17350 | etxrab | 2006-02-18 17:29:51 -0600 (Sat, 18 Feb 2006) | 7 lines
Changed paths:
   M /trunk/asn1/gsmmap/packet-gsm_map-template.c
   M /trunk/epan/dissectors/packet-gsm_a.c
   M /trunk/epan/dissectors/packet-gsm_map.c

From Florent.Drouin@alcatel.fr
Add the same workaround used in packet-ftam.c for the bad handling of the asn "IMPLICIT SEQUENCE", in the packet-gsm_map-template.c. This patch concerns Map V3 messages, not correctly decoded with the previous workaround "offset=offset+2".

Change a parameter for Provide Roaming Number decoding.

Add a decoding fonction for "Channel needed" parameter to avoid a decoding error for Paging messages
with a change to actually dissct channel needed.
------------------------------------------------------------------------
r17349 | jmayer | 2006-02-18 16:21:26 -0600 (Sat, 18 Feb 2006) | 1 line
Changed paths:
   M /trunk/plugins/lua

Add tags to svn:ignore
------------------------------------------------------------------------
r17348 | lego | 2006-02-17 23:12:58 -0600 (Fri, 17 Feb 2006) | 3 lines
Changed paths:
   M /trunk/plugins/lua/Makefile.am
   A /trunk/plugins/lua/lua_plugin.c (from /trunk/plugins/lua/plugin.c:17347)
   D /trunk/plugins/lua/plugin.c

rename plugin.c to lua_plugin.c


------------------------------------------------------------------------
r17347 | lego | 2006-02-17 23:11:29 -0600 (Fri, 17 Feb 2006) | 3 lines
Changed paths:
   M /trunk/plugins/lua/plugin.c

Add dual version


------------------------------------------------------------------------
r17346 | lego | 2006-02-17 22:03:24 -0600 (Fri, 17 Feb 2006) | 3 lines
Changed paths:
   M /trunk/acinclude.m4
   M /trunk/plugins/lua/Makefile.am

Prepare for lua 5.1


------------------------------------------------------------------------
r17345 | ulfl | 2006-02-17 19:11:45 -0600 (Fri, 17 Feb 2006) | 1 line
Changed paths:
   M /trunk/image/Makefile.nmake

add a missing dependency to ethereal.rc
------------------------------------------------------------------------
r17344 | ulfl | 2006-02-17 19:10:38 -0600 (Fri, 17 Feb 2006) | 1 line
Changed paths:
   M /trunk/image/win32-file-dlg.rc

add a link to a message indicating that sizing *is* buggy
------------------------------------------------------------------------
r17343 | ulfl | 2006-02-17 19:07:23 -0600 (Fri, 17 Feb 2006) | 1 line
Changed paths:
   M /trunk/gtk/funnel_stat.c

squelch some compiler warnings
------------------------------------------------------------------------
r17342 | ulfl | 2006-02-17 16:40:54 -0600 (Fri, 17 Feb 2006) | 1 line
Changed paths:
   M /trunk/test/test.sh

preparation for a very simple regression test
------------------------------------------------------------------------
r17341 | ulfl | 2006-02-17 16:39:32 -0600 (Fri, 17 Feb 2006) | 1 line
Changed paths:
   M /trunk/capture_sync.c

fix some bugs introduced with command line encapsulation
------------------------------------------------------------------------
r17340 | ulfl | 2006-02-17 16:36:59 -0600 (Fri, 17 Feb 2006) | 1 line
Changed paths:
   M /trunk/capture.c

add a log message, if capture start failed
------------------------------------------------------------------------
r17339 | gerald | 2006-02-17 13:10:12 -0600 (Fri, 17 Feb 2006) | 2 lines
Changed paths:
   M /trunk/gtk/win32-file-dlg.c

More duplicate code removal.

------------------------------------------------------------------------
r17338 | gerald | 2006-02-17 13:07:54 -0600 (Fri, 17 Feb 2006) | 3 lines
Changed paths:
   M /trunk/gtk/win32-file-dlg.c

Include some header files so that we can get rid of duplicate code and
call various GTK+ routines.

------------------------------------------------------------------------
r17337 | gerald | 2006-02-17 10:35:45 -0600 (Fri, 17 Feb 2006) | 3 lines
Changed paths:
   M /trunk/asn1/x509if/x509if.cnf
   M /trunk/epan/dissectors/packet-x509if.c

Don't try to fill in last_dn if it doesn't exist.  Fixes the current Buildbot
failure.

------------------------------------------------------------------------
r17336 | lego | 2006-02-17 10:16:42 -0600 (Fri, 17 Feb 2006) | 4 lines
Changed paths:
   M /trunk/plugins/lua/lua_dumper.c
   M /trunk/plugins/lua/lua_tap.c

- Make sure the right globals are set before invoking user tap caallbaccks
- Have Dumper.new_for_current() and dumper:dump_current() work.


------------------------------------------------------------------------
r17335 | etxrab | 2006-02-17 09:42:33 -0600 (Fri, 17 Feb 2006) | 1 line
Changed paths:
   M /trunk/diameter/dictionary.xml

Translate cause value
------------------------------------------------------------------------
r17334 | etxrab | 2006-02-17 09:41:00 -0600 (Fri, 17 Feb 2006) | 1 line
Changed paths:
   M /trunk/asn1/rnsap/packet-rnsap-template.c
   M /trunk/epan/dissectors/packet-rnsap.c

Dissect the rest of the IE:s
------------------------------------------------------------------------
r17333 | jmayer | 2006-02-17 05:56:52 -0600 (Fri, 17 Feb 2006) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl.c
   M /trunk/gtk/menu.c
   M /trunk/gtk/ssl-dlg.c


Paolo Abeni:

pinfo->net_src and pinfo->net_dst where used to set up conversation, but
this fields are null on eap stream. use pinfo->src and pinfo->dst
instead.
The patch also enable strict checking in the 'follow ssl stream' dialog.


------------------------------------------------------------------------
r17332 | guy | 2006-02-17 05:53:11 -0600 (Fri, 17 Feb 2006) | 3 lines
Changed paths:
   M /trunk/capture_sync.c

We now quote args as necessary on Windows when constructing the command
line, so there's no need to quote them when adding the arguments.

------------------------------------------------------------------------
r17331 | guy | 2006-02-17 04:03:34 -0600 (Fri, 17 Feb 2006) | 4 lines
Changed paths:
   M /trunk/asn1/rnsap/packet-rnsap-template.c
   M /trunk/epan/dissectors/packet-rnsap.c

Squelch some compiler warnings.

Fix indentation.

------------------------------------------------------------------------
r17330 | guy | 2006-02-17 03:45:52 -0600 (Fri, 17 Feb 2006) | 6 lines
Changed paths:
   M /trunk/capture_sync.c

On Windows. quote arguments as necessary before sticking them into the
command line passed to Create_Process().

On UN*X, use "execv()", not "execvp()", as we now construct the absolute
pathname of "dumpcap".

------------------------------------------------------------------------
r17329 | lego | 2006-02-16 23:16:06 -0600 (Thu, 16 Feb 2006) | 5 lines
Changed paths:
   M /trunk/plugins/lua/lua_dumper.c
   M /trunk/plugins/lua/lua_tap.c
   M /trunk/plugins/lua/packet-lua.h

- avoid the user been flooded with report_error windows if there's an error in a tap callback
- fix args of Dumper:new_for_current
- add a semicolon after LUA_CLASS_DECLARE(PseudoHeader,PSEUDOHEADER) that caused an error (Lesson: Even if trivial one should test changes, there's always a typo arround the corner)


------------------------------------------------------------------------
r17328 | lego | 2006-02-16 20:50:23 -0600 (Thu, 16 Feb 2006) | 4 lines
Changed paths:
   M /trunk/plugins/lua/Makefile.am
   M /trunk/plugins/lua/Makefile.nmake
   A /trunk/plugins/lua/lua_dumper.c
   M /trunk/plugins/lua/lua_tap.c
   M /trunk/plugins/lua/packet-lua.c
   M /trunk/plugins/lua/packet-lua.h

- pass the tvb too to tap packet callbacks
- Dumper (an interface to Wiretap dumpers)


------------------------------------------------------------------------
r17327 | ulfl | 2006-02-16 20:18:48 -0600 (Thu, 16 Feb 2006) | 3 lines
Changed paths:
   M /trunk/capture-pcap-util.c
   M /trunk/capture-pcap-util.h
   M /trunk/capture-wpcap.c
   M /trunk/capture.c
   M /trunk/capture_loop.c
   M /trunk/capture_opts.c
   M /trunk/capture_sync.c
   M /trunk/capture_sync.h
   M /trunk/capture_ui_utils.c
   M /trunk/dumpcap.c
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_if_details_dlg.c
   M /trunk/gtk/capture_if_dlg.c
   M /trunk/gtk/capture_info_dlg.c
   M /trunk/gtk/capture_prefs.c
   M /trunk/gtk/cfilter_combo_utils.c
   M /trunk/gtk/drag_and_drop.c
   M /trunk/gtk/main.c
   M /trunk/gtk/summary_dlg.c
   M /trunk/summary.h
   M /trunk/tempfile.c
   M /trunk/tethereal.c
   M /trunk/version_info.c

remove dependencies to pcap.h, so getting an idea what needs to be done by dumpcap in addition to the things already done now

various dumpcap related code cleanup: mainly #include's and capture engine related stuff
------------------------------------------------------------------------
r17326 | ulfl | 2006-02-16 19:47:53 -0600 (Thu, 16 Feb 2006) | 1 line
Changed paths:
   M /trunk/wiretap/file_access.c

even if we don't want to close stdout on wtap_dump_close(), we might at least try to flush it
------------------------------------------------------------------------
r17325 | ulfl | 2006-02-16 19:42:33 -0600 (Thu, 16 Feb 2006) | 1 line
Changed paths:
   M /trunk/capture_ui_utils.h

fix a comment
------------------------------------------------------------------------
r17324 | ulfl | 2006-02-16 19:36:28 -0600 (Thu, 16 Feb 2006) | 1 line
Changed paths:
   M /trunk/version_info.c

we don't need pcap.h here (any longer)
------------------------------------------------------------------------
r17323 | etxrab | 2006-02-16 12:32:07 -0600 (Thu, 16 Feb 2006) | 1 line
Changed paths:
   M /trunk/diameter/dictionary.xml

Fix </avp> Missing.
------------------------------------------------------------------------
r17322 | etxrab | 2006-02-16 12:26:04 -0600 (Thu, 16 Feb 2006) | 1 line
Changed paths:
   M /trunk/asn1/rnsap/packet-rnsap-template.c
   M /trunk/asn1/rnsap/rnsap.asn
   M /trunk/epan/dissectors/packet-rnsap.c
   M /trunk/epan/dissectors/packet-rnsap.h

Add dissection of all Signals and more IE:s
------------------------------------------------------------------------
r17321 | gerald | 2006-02-16 12:08:06 -0600 (Thu, 16 Feb 2006) | 2 lines
Changed paths:
   A /trunk/doc/README.packaging

Add a document for creating an Ethereal package.

------------------------------------------------------------------------
r17320 | gerald | 2006-02-16 09:53:48 -0600 (Thu, 16 Feb 2006) | 3 lines
Changed paths:
   M /trunk/gtk/file_dlg.c

Freeze and thaw the packet list after a merge so that the packet list shows
the correct information.

------------------------------------------------------------------------
r17319 | gerald | 2006-02-16 09:27:03 -0600 (Thu, 16 Feb 2006) | 5 lines
Changed paths:
   M /trunk/gtk/main.c
   M /trunk/gtk/win32-file-dlg.c

Move common control initialization to gtk/main.c where it belongs.
Remove a MessageBox() call used for debugging.

Fixup whitespace.

------------------------------------------------------------------------
r17318 | guy | 2006-02-16 05:51:02 -0600 (Thu, 16 Feb 2006) | 2 lines
Changed paths:
   M /trunk/doc/README.developer

Document the proto_tree_add_XXX_format_value() routines.

------------------------------------------------------------------------
r17317 | jmayer | 2006-02-16 05:47:16 -0600 (Thu, 16 Feb 2006) | 7 lines
Changed paths:
   M /trunk/asn1/x509af/x509af.cnf
   M /trunk/epan/dissectors/packet-x509af.c

Paolo Abeni:

The attached patch should fix bug 742.
The issue is (at least, I think so...) in the packet-x509af dissector
A null pointer is passes as parameter of a " %s " format string.


------------------------------------------------------------------------
r17316 | guy | 2006-02-16 05:43:38 -0600 (Thu, 16 Feb 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-3g-a11.c
   M /trunk/epan/dissectors/packet-aarp.c
   M /trunk/epan/dissectors/packet-atm.c
   M /trunk/epan/dissectors/packet-auto_rp.c
   M /trunk/epan/dissectors/packet-bacnet.c
   M /trunk/epan/dissectors/packet-bfd.c
   M /trunk/epan/dissectors/packet-bootp.c
   M /trunk/epan/dissectors/packet-bssgp.c
   M /trunk/epan/dissectors/packet-bvlc.c
   M /trunk/epan/dissectors/packet-cdp.c
   M /trunk/epan/dissectors/packet-cpha.c
   M /trunk/epan/dissectors/packet-dcerpc-netlogon.c
   M /trunk/epan/dissectors/packet-dcerpc-samr.c
   M /trunk/epan/dissectors/packet-dcerpc.c
   M /trunk/epan/dissectors/packet-dcom-cba-acco.c
   M /trunk/epan/dissectors/packet-dcp.c
   M /trunk/epan/dissectors/packet-dhcp-failover.c
   M /trunk/epan/dissectors/packet-diameter.c

Use the new "proto_tree_add_*_format_value" routines.

------------------------------------------------------------------------
r17315 | lego | 2006-02-15 18:54:56 -0600 (Wed, 15 Feb 2006) | 10 lines
Changed paths:
   M /trunk/plugins/lua/lua_tap.c
   M /trunk/plugins/lua/packet-lua.h

Have Field extractors being defined while reading the body of the script instead that during initialization.
Change their semantics too:

ip_src_f = Field("ip.src")

function tap.packet(pinfo)
	ip_src = ip_src()
end


------------------------------------------------------------------------
r17314 | jmayer | 2006-02-15 17:30:41 -0600 (Wed, 15 Feb 2006) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-http.c


Jerry Talkington:

Here's a tiny patch that will allow for dissecting of chunked coded HTTP
responses when there is an extension or trailing whitespace in the
Transfer-Encoding: header.


------------------------------------------------------------------------
r17313 | guy | 2006-02-15 16:29:15 -0600 (Wed, 15 Feb 2006) | 2 lines
Changed paths:
   M /trunk/gtk/win32-file-dlg.c

Update a comment.

------------------------------------------------------------------------
r17312 | guy | 2006-02-15 15:55:46 -0600 (Wed, 15 Feb 2006) | 4 lines
Changed paths:
   M /trunk/Makefile.nmake

Add getopt.obj to the list of object files with which dumpcap is linked;
it's necessary on Windows (but not on most UN*Xes, so getopt.c shouldn't
be part of dumpcap_SOURCES).

------------------------------------------------------------------------
r17311 | guy | 2006-02-15 13:20:36 -0600 (Wed, 15 Feb 2006) | 6 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/Makefile.common
   M /trunk/configure.in

Check for getopt in the configure script, as we do for other routines
not available on all platforms.  Include getopt.c in
EXTRA_ethereal_SOURCES and include getopt.h in EXTRA_ethereal_INCLUDES,
as we do with the other files that supply routines not available on all
platforms, rather than always including them in the source for dumpcap.

------------------------------------------------------------------------
r17310 | gerald | 2006-02-15 08:37:48 -0600 (Wed, 15 Feb 2006) | 2 lines
Changed paths:
   M /trunk/image/ethereal.exe.manifest.in

Fix a typo found by Jean-Baptiste Marchand.

------------------------------------------------------------------------
r17309 | guy | 2006-02-15 05:05:25 -0600 (Wed, 15 Feb 2006) | 4 lines
Changed paths:
   M /trunk

Have those functions that end up just calling a win32_ routine if we're
using GTK+ 2.x on Windows just have the call, nothing else (no extra
variables).

------------------------------------------------------------------------
r17308 | guy | 2006-02-15 05:01:57 -0600 (Wed, 15 Feb 2006) | 4 lines
Changed paths:
   M /trunk/gtk/file_dlg.c

Have those functions that end up just calling a win32_ routine if we're
using GTK+ 2.x on Windows just have the call, nothing else (no extra
variables).

------------------------------------------------------------------------
r17307 | lego | 2006-02-14 20:10:07 -0600 (Tue, 14 Feb 2006) | 3 lines
Changed paths:
   M /trunk/plugins/lua/lua_tree.c
   M /trunk/plugins/lua/lua_tvb.c
   M /trunk/plugins/lua/packet-lua.c
   M /trunk/plugins/lua/packet-lua.h

Protect The tree and The tvb from being used outside their scope


------------------------------------------------------------------------
r17306 | lego | 2006-02-14 20:00:18 -0600 (Tue, 14 Feb 2006) | 5 lines
Changed paths:
   M /trunk/plugins/lua/lua_tree.c
   M /trunk/plugins/lua/packet-lua.h

- protect proto_items and proto_trees from being used out of their scope
- fix the severity variables



------------------------------------------------------------------------
r17305 | lego | 2006-02-14 19:21:51 -0600 (Tue, 14 Feb 2006) | 9 lines
Changed paths:
   M /trunk/plugins/lua
   A /trunk/plugins/lua/doc
   M /trunk/plugins/lua/lua_pinfo.c
   M /trunk/plugins/lua/lua_tap.c
   M /trunk/plugins/lua/lua_tvb.c
   A /trunk/plugins/lua/lualib
   M /trunk/plugins/lua/packet-lua.c
   M /trunk/plugins/lua/packet-lua.h

- protect column, columns and pinfo from dereferencing invalid data saved by the user.
- columns live for less than a packet's time, use ep_alloc not g_malloc
- tvbranges are ephemeral too

doc/ is to remain as a placeholder for upcoming docs.

lualib/ is to be deleted (if needed it should go in trunk) but it appears that once I added if I do not check it in I cannot delete it.


------------------------------------------------------------------------
r17304 | gerald | 2006-02-14 12:52:58 -0600 (Tue, 14 Feb 2006) | 2 lines
Changed paths:
   M /trunk/plugins/mgcp/Makefile.nmake

mgcp-plugin -> plugin-mgcp.

------------------------------------------------------------------------
r17303 | gerald | 2006-02-14 12:52:26 -0600 (Tue, 14 Feb 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl-utils.h
   M /trunk/epan/dissectors/packet-ssl.c

Make sure SSL_DEBUG_USE_STDERR is always defined.

------------------------------------------------------------------------
r17302 | gerald | 2006-02-14 09:14:41 -0600 (Tue, 14 Feb 2006) | 6 lines
Changed paths:
   M /trunk/config.nmake
   M /trunk/image/Makefile.nmake
   M /trunk/image/ethereal.exe.manifest.in
   M /trunk/make-version.pl

Split the version under Windows into its major, minor, and micro
components.  Use them to build the VERSION, RC_VERSION, and manifest
versions (the latter two are picky about formatting).  This would
probably be useful on the autoconf side, but I didn't see an obvious
way to implement it.

------------------------------------------------------------------------
r17301 | jmayer | 2006-02-14 08:53:03 -0600 (Tue, 14 Feb 2006) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl.c
   M /trunk/gtk/menu.c
   M /trunk/gtk/ssl-dlg.c


Paolo Abeni:

- enable the 'follow SSL stream' menu item only when a ssl packet is selected.
- when 'following' an ssl stream, show ssl decrypted data only for current conversation.
- fix a typo in ssl preference description.


------------------------------------------------------------------------
r17300 | jmayer | 2006-02-14 08:51:18 -0600 (Tue, 14 Feb 2006) | 1 line
Changed paths:
   M /trunk/plugins/mgcp/Makefile.am
   M /trunk/plugins/mgcp/Makefile.nmake
   D /trunk/plugins/mgcp/moduleinfo.h
   M /trunk/plugins/mgcp/packet-mgcp.c
   M /trunk/plugins/mgcp/packet-mgcp.h
   A /trunk/plugins/mgcp/plugin-mgcp.c

Experiment with a somewhat generic packet-to-plugin wrapper
------------------------------------------------------------------------
r17299 | jmayer | 2006-02-14 08:42:37 -0600 (Tue, 14 Feb 2006) | 1 line
Changed paths:
   M /trunk/Makefile.am
   M /trunk/configure.in

Change suid to take dumpcap into account
------------------------------------------------------------------------
r17298 | guy | 2006-02-14 03:08:12 -0600 (Tue, 14 Feb 2006) | 3 lines
Changed paths:
   M /trunk/epan/filesystem.c

Fix the loop that checks $PATH for the binary to actually step from one
element of the path to the next element.

------------------------------------------------------------------------
r17297 | guy | 2006-02-14 02:34:20 -0600 (Tue, 14 Feb 2006) | 4 lines
Changed paths:
   M /trunk/epan/emem.c
   M /trunk/epan/emem.h

Have the emem.c memdup routines accept and return "void *", as
"memcpy()" does; that eliminates some compiler warnings ("void *" is the
type usually used for "generic pointer").

------------------------------------------------------------------------
r17296 | lego | 2006-02-13 19:29:55 -0600 (Mon, 13 Feb 2006) | 4 lines
Changed paths:
   M /trunk/plugins/lua/lua_tap.c
   M /trunk/plugins/lua/lua_tvb.c
   M /trunk/plugins/lua/packet-lua.c
   M /trunk/plugins/lua/packet-lua.h

- fix a sure crash after an error in lua code lua_tap_draw.
- make sure no reference to a Tvb in lua is used after the lua dissector has returned.


------------------------------------------------------------------------
r17295 | lego | 2006-02-13 18:56:29 -0600 (Mon, 13 Feb 2006) | 3 lines
Changed paths:
   M /trunk/epan/libethereal.def

add missing emem functions


------------------------------------------------------------------------
r17294 | ulfl | 2006-02-13 17:52:11 -0600 (Mon, 13 Feb 2006) | 1 line
Changed paths:
   M /trunk/gtk/rtp_analysis.c

add missing #include "tempfile.h"
------------------------------------------------------------------------
r17293 | lego | 2006-02-13 17:20:38 -0600 (Mon, 13 Feb 2006) | 4 lines
Changed paths:
   M /trunk/epan/expert.c
   M /trunk/gtk/expert_dlg.c

Don't se_leak expert_info records.
se_alloc them where and if  needed, not every time expert_set_info_vformat is called.


------------------------------------------------------------------------
r17292 | gerald | 2006-02-13 17:16:55 -0600 (Mon, 13 Feb 2006) | 2 lines
Changed paths:
   M /trunk/image/win32-file-dlg.rc

Remove unneeded right justification.

------------------------------------------------------------------------
r17291 | gerald | 2006-02-13 17:09:51 -0600 (Mon, 13 Feb 2006) | 5 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/image/Makefile.nmake
   A /trunk/image/ethereal.exe.manifest.in
   M /trunk/image/ethereal.rc.in

Add a manifest, so that styled widgets are drawn correcltly.  The
"version" field in the manifest is picky about formatting, so setting
a custom version in config.nmake (e.g. "0.10.14-test") will probably
break the Windows build.

------------------------------------------------------------------------
r17290 | lego | 2006-02-13 16:13:31 -0600 (Mon, 13 Feb 2006) | 8 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/Makefile.nmake
   A /trunk/make-init-lua.pl
   M /trunk/plugins/lua/packet-lua.c
   M /trunk/plugins/lua/packet-lua.h
   A /trunk/template-init.lua


- disable print
- add a log facility to lua (so far just prints to stderr)
- add settings to disable lua even if installed, to load or not to load user scripts when superuser
- create a default /usr/local/share/ethereal/init.lua that blocks all the io/system calls when running as superuser



------------------------------------------------------------------------
r17289 | ulfl | 2006-02-13 16:10:42 -0600 (Mon, 13 Feb 2006) | 1 line
Changed paths:
   M /trunk/gtk/print_dlg.c

add missing #include "tempfile.h"
------------------------------------------------------------------------
r17288 | jmayer | 2006-02-13 16:08:36 -0600 (Mon, 13 Feb 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sqloracle.c
   M /trunk/epan/dissectors/packet-sqloracle.h

Make the files at least compile. While testing them as plugins they
caused tethereal to abort during startup.

------------------------------------------------------------------------
r17287 | jmayer | 2006-02-13 15:54:42 -0600 (Mon, 13 Feb 2006) | 3 lines
Changed paths:
   A /trunk/epan/dissectors/packet-sqloracle.c
   A /trunk/epan/dissectors/packet-sqloracle.h

Add original files for oracle dissection from the ClearSight
archive.

------------------------------------------------------------------------
r17286 | gerald | 2006-02-13 15:54:05 -0600 (Mon, 13 Feb 2006) | 2 lines
Changed paths:
   M /trunk/gtk/win32-file-dlg.c

Add a placeholder for integrating with the display filter dialog.

------------------------------------------------------------------------
r17285 | gerald | 2006-02-13 15:25:43 -0600 (Mon, 13 Feb 2006) | 16 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/Makefile.nmake
   M /trunk/gtk/Makefile.am
   M /trunk/gtk/Makefile.nmake
   M /trunk/gtk/file_dlg.c
   M /trunk/gtk/print_dlg.c
   M /trunk/gtk/proto_draw.c
   A /trunk/gtk/win32-file-dlg.c
   A /trunk/gtk/win32-file-dlg.h
   M /trunk/image/ethereal.rc.in
   A /trunk/image/win32-file-dlg.rc

Copy over the file open/save code from the Win32 native branch.
The Windows-native routines were integrated by inserting

#if GTK_MAJOR_VERSION >= 2 && _WIN32
  win32_native_routine(GDK_WINDOW_HWND(top_level->window));
  return;
#endif

at the beginning of each GTK+ file routine.  There's probably a prettier
way to do this.

Some of the sizes need to be tweaked in win32-file-dlg.rc, but everything
seems to work.

Fix up whitespace.

------------------------------------------------------------------------
r17284 | gerald | 2006-02-13 14:11:43 -0600 (Mon, 13 Feb 2006) | 2 lines
Changed paths:
   M /trunk/colorfilters

Add redirects to the ICMP filter.

------------------------------------------------------------------------
r17283 | gerald | 2006-02-13 14:10:23 -0600 (Mon, 13 Feb 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-radius_packetcable.c

Remove a couple of unused variables.

------------------------------------------------------------------------
r17282 | etxrab | 2006-02-13 13:45:38 -0600 (Mon, 13 Feb 2006) | 16 lines
Changed paths:
   M /trunk/epan/dissectors/packet-jxta.c

From Mike Duigou:
- Improves ability of dissector to find conversations without seeing 
whole stream.

- Fixes some issues with dissection of data which requires reassembly.

- Adds the ability to dissect jxta conversations from SCTP streams.

- Better handling of welcome message.

- Adds direct dissection of compressed SRDI data.

- Has been run through extensive fuzz testing.

- Fixes compiler warnings with previous patch 17141

------------------------------------------------------------------------
r17281 | jmayer | 2006-02-13 11:06:41 -0600 (Mon, 13 Feb 2006) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl-utils.c
   M /trunk/epan/dissectors/packet-ssl.c

Paolo Abeni

the attached patch fix a couple of possible memory leak in the ssl
decryption code, add some indentation fix, more comments and add the
preference to select the debug output (missing in previous patch)



------------------------------------------------------------------------
r17280 | guy | 2006-02-12 19:30:03 -0600 (Sun, 12 Feb 2006) | 3 lines
Changed paths:
   M /trunk/Makefile.common
   M /trunk/gtk/follow_dlg.c

Add tempfile.h to the list of headeer files.  That was the problem, not
the pathname in the #include.

------------------------------------------------------------------------
r17279 | guy | 2006-02-12 17:48:34 -0600 (Sun, 12 Feb 2006) | 2 lines
Changed paths:
   M /trunk/gtk/follow_dlg.c

Look for "tempfile.h" in the top-level directory.

------------------------------------------------------------------------
r17278 | guy | 2006-02-12 15:52:18 -0600 (Sun, 12 Feb 2006) | 6 lines
Changed paths:
   M /trunk/Makefile.common
   M /trunk/capture_loop.c
   M /trunk/dumpcap.c
   M /trunk/file.c
   M /trunk/gtk/follow_dlg.c
   A /trunk/tempfile.c
   A /trunk/tempfile.h
   M /trunk/util.c
   M /trunk/util.h

Move create_tempfile() to tempfile.c out of util.c.  This means dumpcap
no longer needs util.c, so it no longer includes routines that use
host_ip_af(), so it no longer needs to define its own host_ip_af().

That also means dumpcap.c no longer needs to include <sys/socket.h>.

------------------------------------------------------------------------
r17277 | guy | 2006-02-12 14:55:11 -0600 (Sun, 12 Feb 2006) | 6 lines
Changed paths:
   M /trunk/capture_sync.c

At least on UN*X, the first argument - argv[0] - is supposed to be the
name of the program as used to run it (command name/path name).  Pass
that - otherwise, we pass "-i" as argv[0], and dumpcap ignores it and
treats the capture device as the first argument and doesn't handle it
correctly (i.e., it doesn't capture on that device).

------------------------------------------------------------------------
r17276 | guy | 2006-02-12 14:41:28 -0600 (Sun, 12 Feb 2006) | 3 lines
Changed paths:
   M /trunk/capture_sync.c

Distinguish between pipe_read_block() returning 0 (EOF) or a negative
value (error reading).

------------------------------------------------------------------------
r17275 | guy | 2006-02-12 14:35:15 -0600 (Sun, 12 Feb 2006) | 5 lines
Changed paths:
   M /trunk/capture_sync.c

Instead of using (commented-out) g_warning() calls to log errors reading
and writing the sync pipe, using g_log() calls at the G_LOG_LEVEL_DEBUG
or G_LOG_LEVEL_WARNING levels, so we can get at them if necessary.  Add
some messages for errors for which we had no logging.

------------------------------------------------------------------------
r17274 | guy | 2006-02-12 14:17:55 -0600 (Sun, 12 Feb 2006) | 10 lines
Changed paths:
   M /trunk/gtk/main.c

Send LOG_DOMAIN_CAPTURE_CHILD messages to our log handler, so they don't
go to the standard output (as is the case for some such messages,
including the "child is sending an error message to the parent" message,
which shows up if we fail to exec dumpcap).  *Anything* other than an
official capture-child message written to the standard output by the
capture child confuses the heck out of the parent, and can cause it to
think the child closed the pipe (resulting, in the case described in the
previous parenthetical note, in no dialog box being displayed for
dumpcap not being executed).

------------------------------------------------------------------------
r17273 | lroland | 2006-02-12 08:29:41 -0600 (Sun, 12 Feb 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a.c

fuzz testing revealed that an infinite loop in the uma dissector was only partly fixed in revision 17119.

This will fix the infinite loop and bug 738.
------------------------------------------------------------------------
r17272 | sahlberg | 2006-02-12 07:18:48 -0600 (Sun, 12 Feb 2006) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-kerberos.c

add   rfc1964 stuff and (incomplete) KRB_CRED support.


KRB_CRED does not currently even try to decrypt EncKrbCredPart   but it is better than no KRB_CRED dissection at all.



------------------------------------------------------------------------
r17271 | jmayer | 2006-02-12 06:48:01 -0600 (Sun, 12 Feb 2006) | 4 lines
Changed paths:
   M /trunk/gtk/ssl-dlg.c

Well, it doesn't help to apply patches and then forget to actually
commit them.
Patch by Paolo Abeni: remove some commented out code.

------------------------------------------------------------------------
r17270 | ulfl | 2006-02-12 06:04:17 -0600 (Sun, 12 Feb 2006) | 1 line
Changed paths:
   M /trunk/capture_sync.c

add a minor comment
------------------------------------------------------------------------
r17269 | ulfl | 2006-02-12 05:35:02 -0600 (Sun, 12 Feb 2006) | 1 line
Changed paths:
   M /trunk/dumpcap.c

freebsd needs to define AF_INET6, seems to need sys/socket.h
------------------------------------------------------------------------
r17268 | guy | 2006-02-11 22:35:15 -0600 (Sat, 11 Feb 2006) | 2 lines
Changed paths:
   M /trunk/epan/libethereal.def

Export get_progfile_dir() and init_progfile_dir().

------------------------------------------------------------------------
r17267 | guy | 2006-02-11 21:15:29 -0600 (Sat, 11 Feb 2006) | 17 lines
Changed paths:
   M /trunk/capture_sync.c
   M /trunk/epan/filesystem.c
   M /trunk/epan/filesystem.h
   M /trunk/globals.h
   M /trunk/gtk/about_dlg.c
   M /trunk/gtk/main.c

Add a routine to attempt to get the absolute pathname of the executable
file, strip off the last component to get the pathname of the directory
containing the executable file, and save it for future use.  On Windows,
you can get that from the OS, but, on UN*X, you have to look at argv[0]
and derive the absolute path from that (argv[0] is not guaranteed to be
an absolute path, or even a path at all).  (In addition, if you're
running from the build directory, you might have to strip off a ".libs/"
added to argv[0] as an artifact of the libtoolizing script.)

Use that in the About dialog, and use it to construct the path of
dumpcap.

Don't put quotes into the path of dumpcap; you don't have to quote
strings with spaces in them when handing them to execvp and, in fact,
you *mustn't* quote them, as the quotes will be treated as part of the
pathname.

------------------------------------------------------------------------
r17266 | guy | 2006-02-11 20:04:23 -0600 (Sat, 11 Feb 2006) | 2 lines
Changed paths:
   M /trunk/AUTHORS

Re-UTF-8-ify.

------------------------------------------------------------------------
r17265 | ulfl | 2006-02-11 19:45:58 -0600 (Sat, 11 Feb 2006) | 1 line
Changed paths:
   M /trunk/configure.in

"default on" for dumpcap generation (it's required at least for Ethereal's capturing now)
------------------------------------------------------------------------
r17264 | ulfl | 2006-02-11 19:40:20 -0600 (Sat, 11 Feb 2006) | 1 line
Changed paths:
   M /trunk/Makefile.am

add generation of dumpcap manpage
------------------------------------------------------------------------
r17263 | ulfl | 2006-02-11 19:38:02 -0600 (Sat, 11 Feb 2006) | 1 line
Changed paths:
   M /trunk/capture_loop.c

mark an unused parameter
------------------------------------------------------------------------
r17262 | guy | 2006-02-11 18:59:34 -0600 (Sat, 11 Feb 2006) | 2 lines
Changed paths:
   M /trunk/capture_sync.c

Fix up indentation.

------------------------------------------------------------------------
r17261 | guy | 2006-02-11 18:54:56 -0600 (Sat, 11 Feb 2006) | 6 lines
Changed paths:
   M /trunk/gtk/afp_stat.c
   M /trunk/gtk/bootp_stat.c
   M /trunk/gtk/fc_stat.c
   M /trunk/gtk/gsm_a_stat.c
   M /trunk/gtk/h225_counter.c
   M /trunk/gtk/h225_ras_srt.c
   M /trunk/gtk/hostlist_ip.c
   M /trunk/gtk/ldap_stat.c
   M /trunk/gtk/mgcp_stat.c
   M /trunk/gtk/ncp_stat.c
   M /trunk/gtk/sctp_chunk_stat.c
   M /trunk/gtk/sip_stat.c
   M /trunk/gtk/smb2_stat.c
   M /trunk/gtk/smb_stat.c
   M /trunk/gtk/stats_tree_stat.c
   M /trunk/gtk/wsp_stat.c

Add userdata arguments to a bunch of stat initialization routines to
squelch compiler warnings.  Tag one existing such argument as unused to
squelch another warning.

Fix up some indentation.

------------------------------------------------------------------------
r17260 | ulfl | 2006-02-11 18:03:10 -0600 (Sat, 11 Feb 2006) | 1 line
Changed paths:
   M /trunk/capture_sync.c

we still need sync_pipe_errmsg_to_parent() for the *NIX build
------------------------------------------------------------------------
r17259 | ulfl | 2006-02-11 17:58:07 -0600 (Sat, 11 Feb 2006) | 1 line
Changed paths:
   M /trunk/packaging/nsis/ethereal.nsi

add dumpcap.exe and the corresponding HTML manpage to the distribution
------------------------------------------------------------------------
r17258 | ulfl | 2006-02-11 17:47:03 -0600 (Sat, 11 Feb 2006) | 1 line
Changed paths:
   M /trunk/gtk/main.c

various capture child related minor cleanups
------------------------------------------------------------------------
r17257 | ulfl | 2006-02-11 17:35:31 -0600 (Sat, 11 Feb 2006) | 1 line
Changed paths:
   M /trunk/gtk/font_utils.c
   M /trunk/gtk/font_utils.h
   M /trunk/gtk/main.c

font_init don't need to know if running as a capture_child, this will simply no longer happen.
------------------------------------------------------------------------
r17256 | ulfl | 2006-02-11 17:25:11 -0600 (Sat, 11 Feb 2006) | 13 lines
Changed paths:
   M /trunk/Makefile.common
   M /trunk/capture_loop.c
   M /trunk/capture_opts.c
   M /trunk/capture_opts.h
   M /trunk/capture_sync.c
   M /trunk/capture_sync.h
   M /trunk/dumpcap.c
   M /trunk/gtk/main.c

the point of no return ...

using dumpcap as the capture child for Ethereal.

dumpcap is a plain console application now, even for Win32 (so no WinMain, create_console and special piping stuff reguired). The undocumented command line option -Z will switch dumpcap into "child mode", using binary instead of plain text output messages to communicate with a parent Ethereal.

Ethereal's main.c no longer needs to distinguish between child mode or not, so some simplifying here.

capture_sync.c has to call dumpcap in a "hidden window" mode using CreateProcess instead of spawnvp, otherwise an uggly console window would appear. The handles created by _pipe doesn't seem to be inheritable for this function, using CreatePipe instead.

The file capture_loop.c is only needed by dumpcap, removed from Ethereal link objects.

Some debugging aid added and other minor cleanup done.
------------------------------------------------------------------------
r17255 | ulfl | 2006-02-11 11:08:32 -0600 (Sat, 11 Feb 2006) | 1 line
Changed paths:
   M /trunk/gtk/main.c

minor bugfix: restore the Ethereal icon (after capturing) at the right places
------------------------------------------------------------------------
r17254 | lego | 2006-02-11 09:22:43 -0600 (Sat, 11 Feb 2006) | 3 lines
Changed paths:
   M /trunk/epan/funnel.h

This was missing from last check-in


------------------------------------------------------------------------
r17253 | jmayer | 2006-02-11 07:41:17 -0600 (Sat, 11 Feb 2006) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl-utils.c
   M /trunk/epan/dissectors/packet-ssl-utils.h
   M /trunk/epan/dissectors/packet-ssl.c

Paolo Abeni:

The attached patch cleanup the debug infrastructure for ssl dissector.
Debug messages are by default off and can be enabled via the ssl
dissector preference. Debug output can be directed to stderr or file.


------------------------------------------------------------------------
r17252 | lego | 2006-02-11 07:05:24 -0600 (Sat, 11 Feb 2006) | 3 lines
Changed paths:
   M /trunk/epan/stat_cmd_args.c
   M /trunk/epan/stat_cmd_args.h
   M /trunk/gtk/ansi_a_stat.c
   M /trunk/gtk/ansi_map_stat.c
   M /trunk/gtk/conversations_eth.c
   M /trunk/gtk/conversations_fc.c
   M /trunk/gtk/conversations_fddi.c
   M /trunk/gtk/conversations_ip.c
   M /trunk/gtk/conversations_ipx.c
   M /trunk/gtk/conversations_jxta.c
   M /trunk/gtk/conversations_ncp.c
   M /trunk/gtk/conversations_rsvp.c
   M /trunk/gtk/conversations_sctp.c
   M /trunk/gtk/conversations_tcpip.c
   M /trunk/gtk/conversations_tr.c
   M /trunk/gtk/conversations_udpip.c
   M /trunk/gtk/conversations_wlan.c
   M /trunk/gtk/dcerpc_stat.c
   M /trunk/gtk/expert_comp_dlg.c
   M /trunk/gtk/expert_dlg.c
   M /trunk/gtk/flow_graph.c
   M /trunk/gtk/funnel_stat.c
   M /trunk/gtk/graph_analysis.c
   M /trunk/gtk/gsm_a_stat.c
   M /trunk/gtk/gsm_map_stat.c
   M /trunk/gtk/hostlist_eth.c
   M /trunk/gtk/hostlist_fc.c
   M /trunk/gtk/hostlist_fddi.c
   M /trunk/gtk/hostlist_ip.c
   M /trunk/gtk/hostlist_ipx.c
   M /trunk/gtk/hostlist_jxta.c
   M /trunk/gtk/hostlist_rsvp.c
   M /trunk/gtk/hostlist_tcpip.c
   M /trunk/gtk/hostlist_tr.c
   M /trunk/gtk/hostlist_udpip.c
   M /trunk/gtk/hostlist_wlan.c
   M /trunk/gtk/io_stat.c
   M /trunk/gtk/mtp3_stat.c
   M /trunk/gtk/rpc_progs.c
   M /trunk/gtk/rpc_stat.c
   M /trunk/gtk/rtp_analysis.c
   M /trunk/gtk/t38_analysis.c
   M /trunk/gtk/tap_dfilter_dlg.c
   M /trunk/gtk/voip_calls_dlg.c
   M /trunk/tap-afpstat.c
   M /trunk/tap-ansi_astat.c
   M /trunk/tap-bootpstat.c
   M /trunk/tap-dcerpcstat.c
   M /trunk/tap-gsm_astat.c
   M /trunk/tap-h225counter.c
   M /trunk/tap-h225rassrt.c
   M /trunk/tap-httpstat.c
   M /trunk/tap-iostat.c
   M /trunk/tap-iousers.c
   M /trunk/tap-mgcpstat.c
   M /trunk/tap-protocolinfo.c
   M /trunk/tap-protohierstat.c
   M /trunk/tap-rpcprogs.c
   M /trunk/tap-rpcstat.c
   M /trunk/tap-sctpchunkstat.c
   M /trunk/tap-sipstat.c
   M /trunk/tap-smbsids.c
   M /trunk/tap-smbstat.c
   M /trunk/tap-stats_tree.c
   M /trunk/tap-wspstat.c
   M /trunk/tap_dfilter_dlg.h

 add an userdata argument to register_stat_cmd_arg() and its callback to use the callback for multiple registrations.


------------------------------------------------------------------------
r17251 | guy | 2006-02-11 05:21:38 -0600 (Sat, 11 Feb 2006) | 25 lines
Changed paths:
   M /trunk/gtk/file_dlg.c
   M /trunk/gtk/file_dlg.h
   M /trunk/gtk/packet_list.c
   M /trunk/gtk/range_utils.c
   M /trunk/gtk/range_utils.h

In "Save As", support only file types we can write to; that simplifies
the logic, making it easier to get it right (fewer interactions between
components of the dialog - the file type doesn't affect whether we can
save some but not all packets).  It also means we don't offer a file
type for saving, only to take it away if you choose anything other than
saving all packets.

If the capture file is a temporary file from a capture done in the
current Ethereal session, it's libpcap format, which we can write to, so
you would be able to save it.

If it's a saved file we read in, saving the file in its entirety in its
own format is just copying the file, and it's not clear supporting that
adds enough useful functionality to justify the extra complication.

Fix "range_update_dynamics()" to update all the rows of the range
button/count table properly (make the button active iff there's
a non-zero count in the currently-selected column, make a count active
iff the column is selected), to select the "Captured" column if the
count of displayed packets goes to zero, and to select the "Save all
packets" row if the count of packets in the currently-selected row and
column goes to zero.  (XXX - we should perhaps do that with the
"user-defined range" counts as well, which would involve updating the
counts on every change to the range field.)

------------------------------------------------------------------------
r17250 | guy | 2006-02-11 03:54:10 -0600 (Sat, 11 Feb 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isakmp.c

Squelch some compiler warnings.

------------------------------------------------------------------------
r17249 | guy | 2006-02-11 03:50:11 -0600 (Sat, 11 Feb 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-radius_packetcable.c

Squelch some compiler warnings by declaring RADIUS AVP dissectors to
return pointers to const strings.

------------------------------------------------------------------------
r17248 | lroland | 2006-02-10 21:50:25 -0600 (Fri, 10 Feb 2006) | 4 lines
Changed paths:
   M /trunk/epan/proto.c
   M /trunk/gtk/main.c

Display g_error messages in the console window unconditionally, if preferences aren't loaded yet. 
This way we ensure that errors are displayed during protocol registration.

Use g_error instead of g_warning, if not allowed characters are used in display filter names for protocols. Extend the error message in this case.
------------------------------------------------------------------------
r17247 | lego | 2006-02-10 18:13:23 -0600 (Fri, 10 Feb 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c
   M /trunk/epan/dissectors/packet-xml.c

From ENDOH Akira:
  Add heuristic dissection of XML to SIP bodies with unknown media_type.


------------------------------------------------------------------------
r17246 | sahlberg | 2006-02-10 16:24:21 -0600 (Fri, 10 Feb 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

tcp analysis

RST segments should not be checked for and not marked as
PREVIOUS_SEGMENT_LOST


------------------------------------------------------------------------
r17245 | lroland | 2006-02-10 08:13:06 -0600 (Fri, 10 Feb 2006) | 1 line
Changed paths:
   M /trunk/Makefile.nmake

When using GTK 2.8, we need the cairo dlls, so add them to the install-gtk2-deps target 
------------------------------------------------------------------------
r17244 | etxrab | 2006-02-10 07:20:11 -0600 (Fri, 10 Feb 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl-utils.c
   M /trunk/epan/dissectors/packet-ssl.c

From Paolo Abeni:
 The attached patch fix bug 732.
 The problem was in the client key dissection. On ssl v3 the encrypted
 data is the whole record data, on tls v1 the encrypted data is preceded
 by the 2 bytes length of the encrypted data itself.

------------------------------------------------------------------------
r17243 | ulfl | 2006-02-10 03:27:32 -0600 (Fri, 10 Feb 2006) | 3 lines
Changed paths:
   M /trunk/docbook/README.txt

The target is called eug_html_chunked not eug_htmlchunk

The pdf (and chm) targets are called differently in the two Makefiles (user-guide... vs. eug...), and I don't know which one is better (while keeping in mind that this will require changes in the documentation and elsewhere as well if we change it).
------------------------------------------------------------------------
r17242 | tpot | 2006-02-09 22:45:32 -0600 (Thu, 09 Feb 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-asf.c

ASF messages are in big-endian byte order, not little.  From Alert
Standard Format Specification, v2.0, p.51.

------------------------------------------------------------------------
r17241 | tpot | 2006-02-09 20:10:33 -0600 (Thu, 09 Feb 2006) | 2 lines
Changed paths:
   M /trunk/epan/ex-opt.h

Add newline to end of file to quiten compiler warning.

------------------------------------------------------------------------
r17240 | ulfl | 2006-02-09 20:05:30 -0600 (Thu, 09 Feb 2006) | 3 lines
Changed paths:
   M /trunk/capture_opts.c
   M /trunk/capture_opts.h
   M /trunk/dumpcap.c
   M /trunk/gtk/main.c
   M /trunk/tethereal.c

remove all calls to exit() from the capture_opts.c and replace them by status return values (0,1 or 2).

This way makes it much easier to debug, e.g. to set a common breakpoint if a command line parameter fails.
------------------------------------------------------------------------
r17239 | ulfl | 2006-02-09 19:27:23 -0600 (Thu, 09 Feb 2006) | 3 lines
Changed paths:
   M /trunk/capture_sync.c

only a backup, nothing changed for now.

second try to bring dumpcap to life. Currently it's working, but the child (dumpcap) will show an annoying Win32 console window while running. 
------------------------------------------------------------------------
r17238 | ulfl | 2006-02-09 19:18:24 -0600 (Thu, 09 Feb 2006) | 1 line
Changed paths:
   M /trunk/dumpcap.c

some improvements in the console output handling
------------------------------------------------------------------------
r17237 | ulfl | 2006-02-09 15:49:02 -0600 (Thu, 09 Feb 2006) | 1 line
Changed paths:
   M /trunk/doc/Makefile.am
   M /trunk/doc/Makefile.nmake
   A /trunk/doc/dumpcap.pod

add dumpcap manual page
------------------------------------------------------------------------
r17236 | ulfl | 2006-02-09 15:37:14 -0600 (Thu, 09 Feb 2006) | 8 lines
Changed paths:
   M /trunk/gtk/main.c

Win32 inconvenience: a call to g_error will terminate the program and the user won't see anything.

To avoid this, the log handler in the error case:

- opens a console window (regardless of the users settings)
- waits for a keypress before continuing to terminate the program

This way, the user will be notified that there's a problem, instead of simply seeing a terminating program only.
------------------------------------------------------------------------
r17235 | ulfl | 2006-02-09 15:02:02 -0600 (Thu, 09 Feb 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-fix.c

fix# 733: don't crash on unknown msg_types
------------------------------------------------------------------------
r17234 | gerald | 2006-02-09 15:01:17 -0600 (Thu, 09 Feb 2006) | 2 lines
Changed paths:
   M /trunk/epan

Add strptime.c, mkstemp.c, and libethereal.lib to the ignore list.

------------------------------------------------------------------------
r17233 | gerald | 2006-02-09 14:24:57 -0600 (Thu, 09 Feb 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-radius_packetcable.c
   M /trunk/radius/dictionary
   M /trunk/radius/dictionary.cablelabs

Re-enable the PacketCable RADIUS code and add a few EM updates.
Sponsored by CableLabs.

------------------------------------------------------------------------
r17232 | gerald | 2006-02-09 13:41:20 -0600 (Thu, 09 Feb 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cops.c

Add PacketCable Multimedia updates.  Sponsored by CableLabs.

------------------------------------------------------------------------
r17231 | gerald | 2006-02-09 13:22:15 -0600 (Thu, 09 Feb 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtp.c

ntp_fmt_ts() doesn't take two arguments any more.

------------------------------------------------------------------------
r17230 | gerald | 2006-02-09 11:42:42 -0600 (Thu, 09 Feb 2006) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtp.c

Add support for PacketCable CCC-encapsulated RTP data, described in
PKT-SP-ESP1.5-I01-050128.

Sponsored by CableLabs.

------------------------------------------------------------------------
r17229 | gerald | 2006-02-09 11:32:14 -0600 (Thu, 09 Feb 2006) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isakmp.c

Add decryption support.  For this to work, you MUST link against
the Nettle library and specify a Pluto log file in the preferences.
The Pluto log MUST include the encryption key used in each phase.

Add filters for many fields (and get rid of a lot of
proto_tree_add_text()s in the process).

Fix up whitespace.

Sponsored by CableLabs.

------------------------------------------------------------------------
r17228 | lego | 2006-02-09 07:05:32 -0600 (Thu, 09 Feb 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-media.c
   M /trunk/epan/dissectors/packet-xml.c
   M /trunk/epan/tvbparse.c
   M /trunk/epan/tvbparse.h

Add heuristic dissection of XML


------------------------------------------------------------------------
r17227 | jmayer | 2006-02-09 03:18:15 -0600 (Thu, 09 Feb 2006) | 9 lines
Changed paths:
   M /trunk/epan/addr_resolv.c


Ricardo Muggli:

The attached patch will fix ethereal so it will only do network address
resolution when network address resolution is enabled. Even when the
RESOLV_NETWORK flag was set ethereal would try to resolve addresses in
the add_ether_byip function.


------------------------------------------------------------------------
r17226 | jmayer | 2006-02-09 03:15:21 -0600 (Thu, 09 Feb 2006) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-juniper.c


Hannes Gredler:

attached a patch that supports filtering for
Juniper's meta information prepended
before packets (logical encapsulation, ifd index etc.)

Me:

declare juniper_ext_get_tlv_value static

------------------------------------------------------------------------
r17225 | jmayer | 2006-02-09 03:11:06 -0600 (Thu, 09 Feb 2006) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-netflow.c


Olivier Montanuy:

This is a simple patch to the Netflow v9 dissector, that let it decode
Netflow v9 MPLS-Aware, a feature of Cisco 12000 IOS 12.0.24S and above
on Cisco 12000, 7500 and 7200 that is very useful for MPLS-VPN networks.


------------------------------------------------------------------------
r17224 | lroland | 2006-02-09 01:03:54 -0600 (Thu, 09 Feb 2006) | 5 lines
Changed paths:
   M /trunk/epan/Makefile.nmake

From Bill Meier
The following patch prevents a windows nmake of Ethereal from
relinking libethereal.dll 
when DOXYGEN is not defined in config.nmake and
there are no changes to libethereal.dll dependents.
------------------------------------------------------------------------
r17223 | lroland | 2006-02-09 00:57:25 -0600 (Thu, 09 Feb 2006) | 1 line
Changed paths:
   M /trunk/epan/libethereal.def

remove a duplicated name
------------------------------------------------------------------------
r17222 | guy | 2006-02-09 00:47:29 -0600 (Thu, 09 Feb 2006) | 2 lines
Changed paths:
   M /trunk/epan/libethereal.def

Export the right name.

------------------------------------------------------------------------
r17221 | guy | 2006-02-08 22:18:23 -0600 (Wed, 08 Feb 2006) | 7 lines
Changed paths:
   M /trunk/epan/libethereal.def
   M /trunk/epan/proto.c
   M /trunk/epan/proto.h

Add "proto_tree_add_XXX_format_value()" routines, which are like the
"proto_tree_add_XXX_format()" routines except that the format doesn't
have to include the field name - the field name, followed by ": ", are
put into the representation string, followed by the result of the
formatting, so you just format the value with the format string, not the
entire representation.

------------------------------------------------------------------------
r17220 | lego | 2006-02-08 17:26:52 -0600 (Wed, 08 Feb 2006) | 7 lines
Changed paths:
   M /trunk/plugins/lua/lua_proto.c
   M /trunk/plugins/lua/lua_tree.c
   M /trunk/plugins/lua/lua_tvb.c
   M /trunk/plugins/lua/packet-lua.c
   M /trunk/plugins/lua/packet-lua.h

* DissectorTable.add does not allow to add lua protocols that don't have a dissector.
* ProtoFiled.uint checks the base to be a valid value to avoid an assertion in proto.c while registering the field array
* save one lua table lookup by using a reference to the dissectors table instead of looking for it by name
* set data_hanlde's value to avoid a crash while invoking it.
* make the TvbRange of Tree:add_item really optional. 


------------------------------------------------------------------------
r17219 | gerald | 2006-02-08 17:09:17 -0600 (Wed, 08 Feb 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bootp.c

Add support for PacketCable option 60/suboption 5.23.  Sponsored by 
CableLabs.

------------------------------------------------------------------------
r17218 | jmayer | 2006-02-08 11:04:21 -0600 (Wed, 08 Feb 2006) | 2 lines
Changed paths:
   M /trunk/plugins/lua/plugin.c

Include glib.h, so FALSE is defined when compiling statically.

------------------------------------------------------------------------
r17217 | jmayer | 2006-02-08 06:45:14 -0600 (Wed, 08 Feb 2006) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl.c
   M /trunk/gtk/ssl-dlg.c


Paolo Abeni:

the attached patch clean a bit the ssl decryption related code, removing
a macro I used when the code was still for an external plugin.


------------------------------------------------------------------------
r17216 | guy | 2006-02-08 04:22:20 -0600 (Wed, 08 Feb 2006) | 4 lines
Changed paths:
   M /trunk/dftest.c

Call "get_credential_info()", so any later calls to privileges.c
routines will have the UID info (not that it matters in this case,
but...).

------------------------------------------------------------------------
r17215 | sahlberg | 2006-02-08 02:48:23 -0600 (Wed, 08 Feb 2006) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ntlmssp.c
   M /trunk/epan/dissectors/packet-smb2.c

smb2:
if the secblob starts with 'NTLMSSP'   call the ntlmssp handle directly and not the gssapi one

ntlmssp:
dont change offset when dissecting a client_time,   offset will be changed properly later outside the switch.



------------------------------------------------------------------------
r17214 | guy | 2006-02-07 21:25:22 -0600 (Tue, 07 Feb 2006) | 2 lines
Changed paths:
   M /trunk/epan/filesystem.c

Fix up some comments.

------------------------------------------------------------------------
r17213 | guy | 2006-02-07 20:06:09 -0600 (Tue, 07 Feb 2006) | 5 lines
Changed paths:
   M /trunk/epan/filesystem.c

Clean up the comments for files_identical(), and fix up the UNIX
implementation to check whether the stat calls succeed and to check not
only that the files have the same inumber but that they also are on the
same file system.

------------------------------------------------------------------------
r17212 | lego | 2006-02-07 18:31:33 -0600 (Tue, 07 Feb 2006) | 3 lines
Changed paths:
   M /trunk/docbook/eug_src/EUG_chapter_customize.xml

Try to fix a grammar error in the XML code I added for -X


------------------------------------------------------------------------
r17211 | lego | 2006-02-07 18:06:38 -0600 (Tue, 07 Feb 2006) | 3 lines
Changed paths:
   M /trunk/epan/filesystem.c

Make file_exists() work on macosx (and other unices)


------------------------------------------------------------------------
r17210 | lego | 2006-02-07 18:02:15 -0600 (Tue, 07 Feb 2006) | 8 lines
Changed paths:
   M /trunk/plugins/lua/packet-lua.c

Changed how files are loaded.

load $ETH/init.lua if it exists
if we are not runninig on special privileges
  load $USER/init.lua
  and then all the files given with cmd line option -X lua_script:file.lua 


------------------------------------------------------------------------
r17209 | lego | 2006-02-07 16:18:05 -0600 (Tue, 07 Feb 2006) | 3 lines
Changed paths:
   M /trunk/epan/ex-opt.c
   M /trunk/epan/ex-opt.h

svn:keywords and svn:eol-style


------------------------------------------------------------------------
r17208 | lego | 2006-02-07 16:11:01 -0600 (Tue, 07 Feb 2006) | 3 lines
Changed paths:
   M /trunk/epan/libethereal.def

Forgotten from last commit


------------------------------------------------------------------------
r17207 | lego | 2006-02-07 16:08:12 -0600 (Tue, 07 Feb 2006) | 3 lines
Changed paths:
   M /trunk/doc/ethereal.pod
   M /trunk/doc/tethereal.pod
   M /trunk/docbook/eug_src/EUG_chapter_customize.xml
   M /trunk/epan/Makefile.common
   A /trunk/epan/ex-opt.c
   A /trunk/epan/ex-opt.h
   M /trunk/gtk/main.c
   M /trunk/tethereal.c

eXtenstion options access to the -X command line options


------------------------------------------------------------------------
r17206 | sahlberg | 2006-02-07 15:30:21 -0600 (Tue, 07 Feb 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c
   M /trunk/epan/dissectors/packet-smb2.h

smb2 signing

add dissection of the "Signature present" bit
and the 16 byte signature field in the header


------------------------------------------------------------------------
r17205 | etxrab | 2006-02-07 13:31:54 -0600 (Tue, 07 Feb 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ssl.c

Newlines in preference comments causes problems in reading the prefeerence file.
------------------------------------------------------------------------
r17204 | etxrab | 2006-02-07 13:29:51 -0600 (Tue, 07 Feb 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bssap.c
   M /trunk/epan/dissectors/packet-g723.c
   M /trunk/epan/dissectors/packet-tipc.c

Packet-bssap.c - Dissect BCD coded IE:s
Packet-g723.c - B0 and B1 should be treated together.
packet-tipc.c - Change desgementation code to handle more than 2 segments.

------------------------------------------------------------------------
r17203 | sahlberg | 2006-02-07 06:50:58 -0600 (Tue, 07 Feb 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ntlmssp.c

add the CLIENT_TIME ntlmv2 addr name type


------------------------------------------------------------------------
r17202 | sahlberg | 2006-02-07 06:01:34 -0600 (Tue, 07 Feb 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c
   M /trunk/epan/dissectors/packet-smb2.h
   M /trunk/gtk/smb2_stat.c

handmerged patch from metze it conflicted with recent P bit patch i checked in


------------------------------------------------------------------------
r17201 | sahlberg | 2006-02-07 05:32:10 -0600 (Tue, 07 Feb 2006) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

rename Logoff to SessionLogoff   to make it consistent with
TreeConnect/TreeDisconnect



------------------------------------------------------------------------
r17200 | jmayer | 2006-02-07 04:26:20 -0600 (Tue, 07 Feb 2006) | 11 lines
Changed paths:
   M /trunk/config.h.win32
   M /trunk/config.nmake
   M /trunk/epan/dissectors/packet-ssl-utils.h
   M /trunk/epan/dissectors/packet-ssl.c
   M /trunk/gtk/Makefile.nmake

Paolo Abeni:

>There is still an issue into the HAVE_LIBGNUTLS macro definition. I'm
>fixing it and cleaning a bit the windows side configuration. I hope to
>post soon the fix.


The attached patch should fix the issue. I missed to modify the
config.win32 file and I misstyped a few macros name.


------------------------------------------------------------------------
r17199 | jmayer | 2006-02-07 04:22:41 -0600 (Tue, 07 Feb 2006) | 7 lines
Changed paths:
   M /trunk/gtk/follow_dlg.c

Peter Kjellerstedt:

GTK_WRAP_WORD_CHAR does not exist in old versions of GTK2+
(2.2.1 and earlier).  The following patch should make it
compile again (solution borrowed from GAIM).


------------------------------------------------------------------------
r17198 | jmayer | 2006-02-07 03:49:38 -0600 (Tue, 07 Feb 2006) | 6 lines
Changed paths:
   M /trunk/acinclude.m4
   M /trunk/configure.in

lua autofoo:

- Fail if with-lua was given but liblualib is missing
- Make the test for liblualib succeed on my system
  (make sure the test gets linked with liblua and libm).

------------------------------------------------------------------------
r17197 | sahlberg | 2006-02-07 03:28:02 -0600 (Tue, 07 Feb 2006) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c
   M /trunk/epan/dissectors/packet-smb2.h

add dissection of the P (PID Valid) bit in the header

If the P bit is NOT set, then flag the PID field as "(not valid)"
Sicne the TID might be undefined/0 in the response to a "pending" read
we cant use that solely to determine if a read was for a named/pipe (==dcerpc)
Assume that only NamedPipe reads can be STATUS_PENDING and thus have the P bit set and assume it IS dcerpc if the P bit is set.




------------------------------------------------------------------------
r17196 | lroland | 2006-02-07 03:12:43 -0600 (Tue, 07 Feb 2006) | 7 lines
Changed paths:
   M /trunk/config.nmake
   M /trunk/epan/libethereal.def
   M /trunk/packaging/nsis/Makefile.nmake
   M /trunk/packaging/nsis/ethereal.nsi
   M /trunk/plugins/Makefile.nmake
   A /trunk/plugins/lua/Makefile.nmake
   M /trunk/plugins/lua/lua_tvb.c
   M /trunk/plugins/lua/plugin.c

changes to build lua plugin with MSVC6:
- nmake makefile for lua plugin added.
- declare variables at the beginning of a function.
- proto_reg_handoff_lua was removed, remove remaining calls, too.
- missing functions to libethereal.def added.

add lua plugin to installer, if available.
------------------------------------------------------------------------
r17195 | sahlberg | 2006-02-07 02:48:51 -0600 (Tue, 07 Feb 2006) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c
   M /trunk/epan/dissectors/packet-smb.h
   M /trunk/epan/dissectors/packet-smb2.c

add dissection of
SMB/SetFileInfo level 1023
SMB2/SetInfo/FILE_INFO level 0x17

FILE_PIPE_INFO   infolevel


------------------------------------------------------------------------
r17194 | etxrab | 2006-02-06 22:57:30 -0600 (Mon, 06 Feb 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-bssap.c
   M /trunk/epan/dissectors/packet-gsm_a.c
   M /trunk/epan/dissectors/packet-gsm_a.h

Dissect channel needed.
------------------------------------------------------------------------
r17193 | etxrab | 2006-02-06 22:56:37 -0600 (Mon, 06 Feb 2006) | 1 line
Changed paths:
   M /trunk/asn1/h245/packet-h245-template.c
   M /trunk/epan/dissectors/packet-h245.c

Add a RFC value.
------------------------------------------------------------------------
r17192 | lego | 2006-02-06 21:47:13 -0600 (Mon, 06 Feb 2006) | 3 lines
Changed paths:
   M /trunk/plugins/lua/lua_proto.c

init_routines was moved back to globals.


------------------------------------------------------------------------
r17191 | lego | 2006-02-06 21:06:02 -0600 (Mon, 06 Feb 2006) | 5 lines
Changed paths:
   M /trunk/plugins/lua/lua_proto.c
   M /trunk/plugins/lua/packet-lua.c

I Noticed a crash when registering a tap with filter during handoff (that's when I had lua starting) trying to see if I could move dfilter_init() before protocol registration I discovered register_final_registration_routine() neat!

Lua protocols won't need a handoff routine anymore!!


------------------------------------------------------------------------
r17190 | lego | 2006-02-06 17:58:07 -0600 (Mon, 06 Feb 2006) | 4 lines
Changed paths:
   M /trunk/plugins/lua/lua_gui.c
   M /trunk/plugins/lua/packet-lua.c
   M /trunk/plugins/lua/packet-lua.h

+ gui_enabled()
* make  the gui routines call-able since the first line of the script


------------------------------------------------------------------------
r17189 | lego | 2006-02-06 17:54:54 -0600 (Mon, 06 Feb 2006) | 4 lines
Changed paths:
   M /trunk/epan/funnel.h
   M /trunk/gtk/funnel_stat.c
   M /trunk/gtk/main.c

- fix a leak
- register the funnel mini-api ASAP


------------------------------------------------------------------------
r17188 | jmayer | 2006-02-06 09:47:05 -0600 (Mon, 06 Feb 2006) | 1 line
Changed paths:
   M /trunk/gtk/Makefile.am

Forgot to add ssl-dlg.h to the distro
------------------------------------------------------------------------
r17187 | jmayer | 2006-02-06 09:00:49 -0600 (Mon, 06 Feb 2006) | 11 lines
Changed paths:
   M /trunk/gtk/ssl-dlg.c


Paolo Abeni

the attached patch set correctly the title of the 'Follow SSL stream'
dialog, to fix one issue reported by Nail Devis.
Unfortunaly there isn't an easy way to enable the 'Follow SSL stream'
dialog only for ssl session without knowing the value of proto_ssl (the
ssl protocol id), because the ssl dissector can run on user specified
ports (configured via preferences)


------------------------------------------------------------------------
r17186 | sahlberg | 2006-02-06 07:17:11 -0600 (Mon, 06 Feb 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

prettify class/infolevel for GetInfo/SetInfo


------------------------------------------------------------------------
r17185 | ulfl | 2006-02-06 07:06:15 -0600 (Mon, 06 Feb 2006) | 1 line
Changed paths:
   M /trunk/gtk/funnel_stat.c

fix some variable declarations bugs (code not conforming to ANSI-C)
------------------------------------------------------------------------
r17184 | jmayer | 2006-02-06 06:41:58 -0600 (Mon, 06 Feb 2006) | 1 line
Changed paths:
   M /trunk/gtk/menu.c
   M /trunk/gtk/ssl-dlg.c
   A /trunk/gtk/ssl-dlg.h

Declare -ssl_stream_cb in ssl-dlg.h
------------------------------------------------------------------------
r17183 | jmayer | 2006-02-06 06:21:31 -0600 (Mon, 06 Feb 2006) | 1 line
Changed paths:
   M /trunk/epan/privileges.c
   M /trunk/epan/privileges.h
   M /trunk/plugins/lua/test/simple_dialog.lua
   M /trunk/plugins/lua/test/text_window_tap.lua

svn eol-style and keywords
------------------------------------------------------------------------
r17182 | guy | 2006-02-06 05:18:38 -0600 (Mon, 06 Feb 2006) | 3 lines
Changed paths:
   M /trunk/epan/libethereal.def

Export the new privilege-manipulation routines (not that they do
anything on Windows).

------------------------------------------------------------------------
r17181 | guy | 2006-02-06 04:27:27 -0600 (Mon, 06 Feb 2006) | 3 lines
Changed paths:
   M /trunk/epan/privileges.c
   M /trunk/epan/privileges.h
   M /trunk/tethereal.c

Move the code to relinquish set-UID and set-GID privileges to a routine
in epan/privileges.c.

------------------------------------------------------------------------
r17180 | sahlberg | 2006-02-06 03:51:42 -0600 (Mon, 06 Feb 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

dissect the TWrp chain element


------------------------------------------------------------------------
r17179 | sahlberg | 2006-02-06 03:37:56 -0600 (Mon, 06 Feb 2006) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c

add dissection of a few more create options




------------------------------------------------------------------------
r17178 | sahlberg | 2006-02-06 03:32:27 -0600 (Mon, 06 Feb 2006) | 3 lines
Changed paths:
   M /trunk/gtk/funnel_stat.c

another gtk_resize_window()


------------------------------------------------------------------------
r17177 | guy | 2006-02-06 03:09:06 -0600 (Mon, 06 Feb 2006) | 9 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/config.nmake
   M /trunk/epan/Makefile.nmake
   M /trunk/epan/dissectors/Makefile.nmake
   M /trunk/epan/dissectors/packet-ssl-utils.c
   M /trunk/epan/dissectors/packet-ssl-utils.h

From Paolo Abeni:

	Set up to build on Windows if we have GNU TLS.

	Define "ssl_data_set()" regardless of whether we have GNU TLS or
	not, as it's used in either case.

	Get rid of an extra #include of epan/gnuc_format_check.h.

------------------------------------------------------------------------
r17176 | sahlberg | 2006-02-06 02:50:20 -0600 (Mon, 06 Feb 2006) | 5 lines
Changed paths:
   M /trunk/gtk/funnel_stat.c

gtk1.x does not have gtk_window_resize()




------------------------------------------------------------------------
r17175 | guy | 2006-02-05 22:12:12 -0600 (Sun, 05 Feb 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl-utils.c

Tag some #else/#endif to make it clearer what tests they handle.

Also, remove some trailing white space.

------------------------------------------------------------------------
r17174 | guy | 2006-02-05 21:11:34 -0600 (Sun, 05 Feb 2006) | 3 lines
Changed paths:
   M /trunk/configure.in
   M /trunk/epan/Makefile.common
   M /trunk/epan/plugins.c
   A /trunk/epan/privileges.c
   A /trunk/epan/privileges.h
   M /trunk/gtk/main.c
   M /trunk/tethereal.c

Add code to check whether the app was started with special privileges
(e.g., set-UID or set-GID), and don't load user plugs if it is.

------------------------------------------------------------------------
r17173 | lego | 2006-02-05 19:29:05 -0600 (Sun, 05 Feb 2006) | 3 lines
Changed paths:
   M /trunk/plugins/lua/lua_gui.c
   M /trunk/plugins/lua/packet-lua.c
   M /trunk/plugins/lua/packet-lua.h
   A /trunk/plugins/lua/test/simple_dialog.lua

Lua uses the simple dialog


------------------------------------------------------------------------
r17172 | lego | 2006-02-05 19:27:05 -0600 (Sun, 05 Feb 2006) | 3 lines
Changed paths:
   M /trunk/epan/funnel.h
   M /trunk/gtk/funnel_stat.c

The simple dialog


------------------------------------------------------------------------
r17171 | guy | 2006-02-05 19:17:29 -0600 (Sun, 05 Feb 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl-utils.c

No C++/C99-style comments, please.

------------------------------------------------------------------------
r17170 | guy | 2006-02-05 19:14:36 -0600 (Sun, 05 Feb 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl-utils.c
   M /trunk/epan/dissectors/packet-ssl-utils.h

Include <epan/gnuc_format_check.h> in packet-ssl-utils.h, not
packet-ssl-utils.c; everything else that includes it is a header file.

------------------------------------------------------------------------
r17169 | guy | 2006-02-05 19:01:09 -0600 (Sun, 05 Feb 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl-utils.c
   M /trunk/epan/dissectors/packet-ssl-utils.h
   M /trunk/epan/dissectors/packet-ssl.c
   M /trunk/gtk/ssl-dlg.c

From Paolo Abeni: fix some warnings, etc..

------------------------------------------------------------------------
r17168 | guy | 2006-02-05 18:53:05 -0600 (Sun, 05 Feb 2006) | 2 lines
Changed paths:
   M /trunk/gtk/funnel_stat.c

"text_window_delete_event_cb()" returns a gboolean; declare it as such.

------------------------------------------------------------------------
r17167 | lego | 2006-02-05 14:07:19 -0600 (Sun, 05 Feb 2006) | 3 lines
Changed paths:
   A /trunk/plugins/lua/test
   A /trunk/plugins/lua/test/text_window_tap.lua

Add an example of tap,text window and menu usage


------------------------------------------------------------------------
r17166 | lego | 2006-02-05 14:06:05 -0600 (Sun, 05 Feb 2006) | 5 lines
Changed paths:
   M /trunk/plugins/lua/lua_gui.c
   M /trunk/plugins/lua/lua_pinfo.c
   M /trunk/plugins/lua/lua_tap.c
   M /trunk/plugins/lua/packet-lua.c
   M /trunk/plugins/lua/packet-lua.h

* move all the tap functions to lua_tap
* change the way taps work (docs coming)
* add an at_close method to the textwindow that allows the user to set a callback function to be called when the window is closed


------------------------------------------------------------------------
r17165 | lego | 2006-02-05 14:02:41 -0600 (Sun, 05 Feb 2006) | 5 lines
Changed paths:
   M /trunk/epan/funnel.c
   M /trunk/epan/funnel.h
   M /trunk/gtk/funnel_stat.c

* add an option to funnel_register_menu to retap the packets right after been called
* add a set_close_cllback function to the textwindow mini-api to set a callback to be called when the window gets closed.
* fix few issues regarding the closing of the window


------------------------------------------------------------------------
r17164 | jmayer | 2006-02-05 05:46:00 -0600 (Sun, 05 Feb 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-e212.h
   M /trunk/epan/dissectors/packet-gsm_a.h

Trivial warning fix (no newline at end of file)
------------------------------------------------------------------------
r17163 | lego | 2006-02-04 22:24:51 -0600 (Sat, 04 Feb 2006) | 3 lines
Changed paths:
   M /trunk/asn1/h248/packet-h248-template.c
   M /trunk/epan/dissectors/packet-h248.c

H.248 over UDP


------------------------------------------------------------------------
r17162 | lego | 2006-02-04 22:02:52 -0600 (Sat, 04 Feb 2006) | 3 lines
Changed paths:
   M /trunk/plugins/lua/lua_gui.c
   M /trunk/plugins/lua/packet-lua.c
   M /trunk/plugins/lua/packet-lua.h

Allow lua to register menu items


------------------------------------------------------------------------
r17161 | lego | 2006-02-04 21:59:56 -0600 (Sat, 04 Feb 2006) | 6 lines
Changed paths:
   M /trunk/epan/funnel.c
   M /trunk/epan/funnel.h
   M /trunk/epan/libethereal.def
   M /trunk/gtk/funnel_stat.c

- add a register_menu funnel 
- remove the field_menu altoghether (It was not what I thought)
- move a declaration to the start of a function to allow VC6 to compile



------------------------------------------------------------------------
r17160 | guy | 2006-02-04 21:56:29 -0600 (Sat, 04 Feb 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcap.h

Update from the current asn1/tcap code.

------------------------------------------------------------------------
r17159 | jmayer | 2006-02-04 21:38:50 -0600 (Sat, 04 Feb 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-3com-njack.c

Change port define to something more readable
------------------------------------------------------------------------
r17158 | sahlberg | 2006-02-04 21:11:13 -0600 (Sat, 04 Feb 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-pnp.c
   M /trunk/epan/dissectors/packet-dcerpc-pnp.h

from JBM

some more functions names of new procedures in Vista



------------------------------------------------------------------------
r17157 | jmayer | 2006-02-04 20:33:06 -0600 (Sat, 04 Feb 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-ssl.c

Buildbot found:
- p_rem_proto_data has been renamed to p_remove_proto_data
- I forgot to commit the changes to Makefile.common

------------------------------------------------------------------------
r17156 | jmayer | 2006-02-04 17:44:05 -0600 (Sat, 04 Feb 2006) | 20 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/Makefile.am
   M /trunk/acinclude.m4
   M /trunk/configure.in
   A /trunk/epan/dissectors/packet-ssl-utils.c
   A /trunk/epan/dissectors/packet-ssl-utils.h
   M /trunk/epan/dissectors/packet-ssl.c
   M /trunk/gtk/Makefile.common
   M /trunk/gtk/main.c
   M /trunk/gtk/menu.c
   A /trunk/gtk/ssl-dlg.c

Paolo Abeni

I have developed an external plugin to enable ssl decryption in
ethereal.

Me

- Remove unnecessary $Id$ from acinclude.m4
- Added packet-ssl-utils.h to Makefile.common
- Fixed a few warnings

TODO

- Lots of warning fixes (see separate mail)
- Reformat function headers to read like the others do
  (return value<newline>function-name...)
- Test on Windows platform
- Review the patch to packet-ssl.c and new files packet-ssl-utils.[hc]


------------------------------------------------------------------------
r17155 | lego | 2006-02-04 16:49:44 -0600 (Sat, 04 Feb 2006) | 3 lines
Changed paths:
   M /trunk/epan/funnel.c

define funnel_register_field_menu even if it is not implemented.


------------------------------------------------------------------------
r17154 | lego | 2006-02-04 16:44:31 -0600 (Sat, 04 Feb 2006) | 5 lines
Changed paths:
   M /trunk/gtk/funnel_stat.c

GTK1 buid failed, this should fix it.

s/tv/tw/


------------------------------------------------------------------------
r17153 | lego | 2006-02-04 14:36:04 -0600 (Sat, 04 Feb 2006) | 2 lines
Changed paths:
   M /trunk/gtk/funnel_stat.c

Propset

------------------------------------------------------------------------
r17152 | lego | 2006-02-04 14:34:16 -0600 (Sat, 04 Feb 2006) | 4 lines
Changed paths:
   M /trunk/plugins/lua/lua_gui.c
   M /trunk/plugins/lua/lua_pinfo.c
   M /trunk/plugins/lua/lua_proto.c
   M /trunk/plugins/lua/lua_tap.c
   M /trunk/plugins/lua/lua_tree.c
   M /trunk/plugins/lua/lua_tvb.c
   M /trunk/plugins/lua/packet-lua.h

Propset eol-style and Id for all
lua_gui.h has a licence


------------------------------------------------------------------------
r17151 | lego | 2006-02-04 14:26:36 -0600 (Sat, 04 Feb 2006) | 3 lines
Changed paths:
   M /trunk/gtk/funnel_stat.c

VC6 doesn't like empty structs.


------------------------------------------------------------------------
r17150 | lego | 2006-02-04 14:00:58 -0600 (Sat, 04 Feb 2006) | 3 lines
Changed paths:
   M /trunk/plugins/lua/Makefile.am
   A /trunk/plugins/lua/lua_gui.c
   M /trunk/plugins/lua/lua_tvb.c
   M /trunk/plugins/lua/packet-lua.c
   M /trunk/plugins/lua/packet-lua.h

Give lua a minimal gui.


------------------------------------------------------------------------
r17149 | lego | 2006-02-04 13:56:50 -0600 (Sat, 04 Feb 2006) | 4 lines
Changed paths:
   M /trunk/epan/Makefile.common
   A /trunk/epan/funnel.c
   A /trunk/epan/funnel.h
   M /trunk/epan/libethereal.def
   M /trunk/gtk/Makefile.common
   A /trunk/gtk/funnel_stat.c

The funneled GUI mini API.
A very reduced set of gui ops (by now just a text window) that can be funneled to dissectors (even plugins) via epan.


------------------------------------------------------------------------
r17148 | etxrab | 2006-02-04 04:28:28 -0600 (Sat, 04 Feb 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sccp.c

Add SSN:s from 3GPP TS 23.003.
------------------------------------------------------------------------
r17147 | etxrab | 2006-02-04 04:27:12 -0600 (Sat, 04 Feb 2006) | 1 line
Changed paths:
   M /trunk/diameter/dictionary.xml

Fix a faulty def and add some 3gpp AVP:s
------------------------------------------------------------------------
r17146 | lego | 2006-02-03 15:25:26 -0600 (Fri, 03 Feb 2006) | 15 lines
Changed paths:
   M /trunk/plugins/lua/lua_pinfo.c
   M /trunk/plugins/lua/lua_proto.c
   M /trunk/plugins/lua/lua_tree.c
   M /trunk/plugins/lua/lua_tvb.c
   M /trunk/plugins/lua/packet-lua.c
   M /trunk/plugins/lua/packet-lua.h

* packet-lua.h
   * add a shiftC() function to every class for extracting values from the stack
   
* lua_pinfo.c
   * fix pinfo.dst pinfo.dl_dst pinfo.dl_src pinfo.net_dst pinfo.net_src
   
* lua_tree.c
   * ProtoTree_add_item_any() changed to use TvbRanges, a more handy way to give it optional arguments 

* lua_tvb.c
   * get ByteArray up and running
   * create TvbRange class and use it to access the tvb (this class takes care of checking bounds so that exceptions are not thrown)



------------------------------------------------------------------------
r17145 | jmayer | 2006-02-03 03:29:54 -0600 (Fri, 03 Feb 2006) | 10 lines
Changed paths:
   M /trunk/tools/fuzz-test.sh

Mike Duigou:

I noticed that when you run fuzz testing from both a root account and
a user account you can run into problems because the user account tries
to use and delete temp files created by the root account and fails. This
patch uses the same scheme as used for fuzz error files for naming the
tampered file and for the error file to prevent filename/permission
collisions between temp files from different runs.


------------------------------------------------------------------------
r17144 | etxrab | 2006-02-03 00:31:01 -0600 (Fri, 03 Feb 2006) | 4 lines
Changed paths:
   M /trunk/epan/to_str.c

From Mike Duigou:
- Fixes an off by one error which had the potential to write a 
terminating '\0' one byte past the end of the URI address being printed.

------------------------------------------------------------------------
r17143 | etxrab | 2006-02-02 09:16:51 -0600 (Thu, 02 Feb 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bssap.c
   M /trunk/epan/dissectors/packet-gsm_a.c
   M /trunk/epan/dissectors/packet-gsm_a.h

gsm_a: Export needed functions
bssap: Dissect most of the IE:s
------------------------------------------------------------------------
r17142 | sahlberg | 2006-02-02 02:34:59 -0600 (Thu, 02 Feb 2006) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

fix  bug 400

the choice dissector didnt sometimes use the correct next_tvb.
based on a bogus variable    'first_pass'   that was added as a qad solution to some weird CMIP problem.





------------------------------------------------------------------------
r17141 | etxrab | 2006-02-01 11:39:20 -0600 (Wed, 01 Feb 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bssap.c
   M /trunk/epan/dissectors/packet-gsm_a.c
   M /trunk/epan/dissectors/packet-gsm_a.h

packet-gsma_a.ch Use valuestrings for Number type etc and export the value_strings
packet-bssap.c Add BSSAP+ dissection. 
------------------------------------------------------------------------
r17140 | sahlberg | 2006-02-01 02:59:59 -0600 (Wed, 01 Feb 2006) | 5 lines
Changed paths:
   M /trunk/gtk/io_stat.c

from Bill Meyer

fix for bug 714


------------------------------------------------------------------------
r17139 | etxrab | 2006-02-01 00:09:55 -0600 (Wed, 01 Feb 2006) | 10 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/ncp2222.py
   M /trunk/gtk/ncp_stat.c
   M /trunk/gtk/service_response_time_table.c

From Greg Morris:
epan/dissectors/ncp2222.py - Fixes the NCP group values for all NCP's. Also fixes some additional return values and cleanup.

gtk/ncp_stat.c - Fixes the NCP group values for SRT.

 gtk/service_response_time_table.c:

The SRT is broken if you hit the reload button or apply a filter. The table isn't cleared so each item in the list is duplicated and the second entries remain with initial values. This patch clears the GTK_CLIST so that the redundant entries no longer appear.


------------------------------------------------------------------------
r17138 | etxrab | 2006-01-31 23:44:20 -0600 (Tue, 31 Jan 2006) | 15 lines
Changed paths:
   M /trunk/plugins/docsis/Makefile.am
   M /trunk/plugins/docsis/Makefile.nmake
   A /trunk/plugins/docsis/packet-dccack.c
   A /trunk/plugins/docsis/packet-dccreq.c
   A /trunk/plugins/docsis/packet-dccrsp.c
   A /trunk/plugins/docsis/packet-dcd.c
   M /trunk/plugins/docsis/packet-docsis.c
   M /trunk/plugins/docsis/packet-docsis.h

From Eric Hultin:
This patch adds support for dissection of the DCC packet as defined in 
CableLab's (http://www.cablelabs.com/) DOCSIS Radio Frequency Interface 
(RFI) specification. The latest version of this specification is currently 
available at 
http://www.cablemodem.com/specifications/specifications20.html . Packet 
formats for DCC are defined in sections 8.3.20 (DCC-REQ), 8.3.21 
(DCC-RSP), and 8.3.22 (DCC-ACK) of the RFI specifications (referencing 
version CM-SP-RFIv2.0-I10-051209). In addition, this patch adds support 
for the DCD packet as defined in the DOCSIS Set-Top Gateway (DSG) 
Specification. The latest version of this specification is currently 
available at http://www.cablemodem.com/specifications/gateway.html . The 
format of the DCD packet is defined in section 5.3.1 of the DSG 
specification (referencing version CM-SP-DSG-I06-051209).

------------------------------------------------------------------------
r17137 | lego | 2006-01-31 16:22:05 -0600 (Tue, 31 Jan 2006) | 6 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/acinclude.m4
   M /trunk/configure.in
   M /trunk/plugins/Makefile.am
   M /trunk/plugins/lua/Makefile.am


It was hard.. but at the end I won (or at least i believe so...).

After install hello_world.lua works.


------------------------------------------------------------------------
r17136 | etxrab | 2006-01-31 13:39:55 -0600 (Tue, 31 Jan 2006) | 1 line
Changed paths:
   M /trunk/asn1/tcap/packet-tcap-template.c
   M /trunk/asn1/tcap/packet-tcap-template.h
   M /trunk/epan/dissectors/packet-tcap.c

Export dissector_handle_t get_itu_tcap_subdissector()
------------------------------------------------------------------------
r17135 | etxrab | 2006-01-31 12:35:36 -0600 (Tue, 31 Jan 2006) | 1 line
Changed paths:
   M /trunk/asn1/camel/packet-camel-template.c
   M /trunk/epan/dissectors/packet-camel.c

Fix a typo
------------------------------------------------------------------------
r17134 | etxrab | 2006-01-31 12:33:56 -0600 (Tue, 31 Jan 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sccp.c

Display which dissector is linked to a ssn.
------------------------------------------------------------------------
r17133 | sahlberg | 2006-01-31 04:27:30 -0600 (Tue, 31 Jan 2006) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

make sure we actually get the tcpd structure pointer before we pass it as a parameter to a subroutine to dereference it.



fixes bug 719




------------------------------------------------------------------------
r17132 | etxrab | 2006-01-30 23:46:36 -0600 (Mon, 30 Jan 2006) | 2 lines
Changed paths:
   M /trunk/asn1/gsmmap/gsmmap.cnf
   M /trunk/asn1/gsmmap/packet-gsm_map-template.c
   M /trunk/epan/dissectors/packet-bssgp.c
   M /trunk/epan/dissectors/packet-gsm_map.c

BSSGP - Translate MCC and make MCC MNC etc vissible filters
GSMMAP - Small bugfix
------------------------------------------------------------------------
r17131 | etxrab | 2006-01-30 23:42:55 -0600 (Mon, 30 Jan 2006) | 1 line
Changed paths:
   M /trunk/asn1/camel/camel.asn
   M /trunk/epan/dissectors/packet-camel.c

Fix a typo.
------------------------------------------------------------------------
r17130 | guy | 2006-01-30 20:31:18 -0600 (Mon, 30 Jan 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtp.c

Fix description of version0_type, now that it also supports T.38.

------------------------------------------------------------------------
r17129 | gerald | 2006-01-30 17:29:09 -0600 (Mon, 30 Jan 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

Make sure a pointer isn't null before we try to use it.  Fixes a current
Buildbot failure.

------------------------------------------------------------------------
r17128 | lego | 2006-01-30 16:43:08 -0600 (Mon, 30 Jan 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-xml.c

Fixes bug 717
Tag names with digits were not recognized.


------------------------------------------------------------------------
r17127 | etxrab | 2006-01-29 23:55:46 -0600 (Sun, 29 Jan 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-uma.c

Use dissect_e212_mcc_mnc().
------------------------------------------------------------------------
r17126 | etxrab | 2006-01-29 23:45:39 -0600 (Sun, 29 Jan 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-stun.c

From Martin Mathiesson:
This patch shows (as extra, generated fields) what the address and port will be after XORing again with the transaction ID. I've done IPv4, but don't have any IPv6 captures to test with...

------------------------------------------------------------------------
r17125 | etxrab | 2006-01-29 23:35:39 -0600 (Sun, 29 Jan 2006) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtcp.c

From Andrei Emeltchenko:
OMA again has changed the format of the 2 RTCP packets:

RTCP Grant and RTCP Taken

In RTCP Grant instead of spare 2 bytes there are: magic number and item_len.

In RTCP Taken there is an extra field "Number of participants" like in Grant.
http://www.openmobilealliance.org/release_program/docs/CopyrightClick.asp?pck=PoC&file=V1_0-20051104-C/OMA-TS-PoC-UserPlane-V1_0-20051104-C.pdf
------------------------------------------------------------------------
r17124 | jmayer | 2006-01-29 17:48:43 -0600 (Sun, 29 Jan 2006) | 2 lines
Changed paths:
   M /trunk/plugins/lua/lua_pinfo.c
   M /trunk/plugins/lua/lua_proto.c
   M /trunk/plugins/lua/lua_tap.c
   M /trunk/plugins/lua/lua_tree.c
   M /trunk/plugins/lua/lua_tvb.c
   M /trunk/plugins/lua/packet-lua.h

Warning fixes: no ';' at the end of functions.

------------------------------------------------------------------------
r17123 | guy | 2006-01-29 17:10:05 -0600 (Sun, 29 Jan 2006) | 3 lines
Changed paths:
   M /trunk/epan/prefs.c

Map "mtp3.net_addr_format" to "mtp3.addr_format", for backwards
compatibility.

------------------------------------------------------------------------
r17122 | etxrab | 2006-01-29 16:12:26 -0600 (Sun, 29 Jan 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-e212.c

Actually use the valuestring...
------------------------------------------------------------------------
r17121 | guy | 2006-01-29 15:41:44 -0600 (Sun, 29 Jan 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a.c

Fix indentation, add a /* FALLTHRU */ comment.

------------------------------------------------------------------------
r17120 | lroland | 2006-01-29 15:00:00 -0600 (Sun, 29 Jan 2006) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a.c

As suggested by Ilja Maslov, display values of
gsm_a.cell_lac and gsm_a.cell_ci in hex
and decimal.


------------------------------------------------------------------------
r17119 | lroland | 2006-01-29 09:54:10 -0600 (Sun, 29 Jan 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a.c
   M /trunk/epan/dissectors/packet-uma.c

Fix an infinite loop in gsm_a dissector and a wrong offset in uma dissector.

This fixes bug 716.
------------------------------------------------------------------------
r17118 | guy | 2006-01-29 06:57:14 -0600 (Sun, 29 Jan 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-syslog.c

Use tvb_format_text() on the message, to handle non-printable characters
(including tabs and newlines).

------------------------------------------------------------------------
r17117 | lego | 2006-01-28 21:13:26 -0600 (Sat, 28 Jan 2006) | 12 lines
Changed paths:
   M /trunk/plugins/lua/lua_proto.c
   M /trunk/plugins/lua/packet-lua.c
   M /trunk/plugins/lua/packet-lua.h

* packet-lua.h
   * add an isXxx() declaration
   
* packet-lua.c
   * move the dissectors, handoffs and inits tables to the registry
   
* lua_proto.c
   * new_protocol is now called Protocol
   * move the dissectors, handoffs and inits tables to the registry



------------------------------------------------------------------------
r17116 | guy | 2006-01-28 18:40:40 -0600 (Sat, 28 Jan 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtp.c

Add an option to dissect purported RTP packets with a version number of
0 as T.38 rather than STUN.

------------------------------------------------------------------------
r17115 | guy | 2006-01-28 17:27:17 -0600 (Sat, 28 Jan 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-lldp.c

Squelch a compiler warning.

------------------------------------------------------------------------
r17114 | guy | 2006-01-28 17:18:19 -0600 (Sat, 28 Jan 2006) | 4 lines
Changed paths:
   M /trunk/epan/afn.c
   M /trunk/epan/afn.h
   M /trunk/epan/dissectors/packet-lldp.c

Expand the set of #defines in afn.h (and give a URL for the *current*
list of address families) and the list of strings in afn.c, and use them
in packet-lldp.c instead of having it define its own.

------------------------------------------------------------------------
r17113 | guy | 2006-01-28 16:49:53 -0600 (Sat, 28 Jan 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a.c

Fix missing closing */ in comment.

------------------------------------------------------------------------
r17112 | guy | 2006-01-28 16:34:22 -0600 (Sat, 28 Jan 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-clnp.c

Fix missing brackets in if statement.

------------------------------------------------------------------------
r17111 | lego | 2006-01-28 15:09:59 -0600 (Sat, 28 Jan 2006) | 14 lines
Changed paths:
   M /trunk/plugins/lua/lua_pinfo.c
   M /trunk/plugins/lua/lua_proto.c
   M /trunk/plugins/lua/lua_tree.c

* lua_pinfo.c
   * Address' gt, ge, eq, le and lt operators
   
* lua_proto.c
   * DissectorTable:remove and DissectorTable:add
      - can take either Proto or Dissector as third argument
   
* lua_tree.c
   * make sure we have a lua_etts array on which to add etts
   * ProtoItem:add_subtree() if no ett is given don't fail use the default one.
   



------------------------------------------------------------------------
r17110 | lego | 2006-01-27 21:15:45 -0600 (Fri, 27 Jan 2006) | 25 lines
Changed paths:
   M /trunk/plugins/lua/lua_proto.c
   M /trunk/plugins/lua/lua_tap.c
   M /trunk/plugins/lua/lua_tree.c
   M /trunk/plugins/lua/packet-lua.c
   M /trunk/plugins/lua/packet-lua.h

* packet-lua.h
  * SubTreeType (ett) was renamed as SubTree 

* lua_tap.c
   - change the way the taps register (still to be finished so I won't comment)
   
* lua_tree.c
   * SubTree(ett) moved here, now it autoregisters all subtrees created at once. The user neither does need to create a SubTreeArray(eliminated) anymore nor to register it.

* lua_proto.c
   * SubTree moved out from here its "global" variables are used by lua_tree.c .
   * SubTreeArray was eliminated (now ett's "autoregister")
   * Created usertypes for
      - Pref a preference
      - Prefs all preferences of one protocol
      So far they are transparent to the user.
   * Proto has become a pseudo-table instead of a method based (registration in nicer)

* packet-lua.c
  * runtime errors go where they are meant to:
    - errors in dissector code go to the tree (a-la malformed)
    - errors in registration/handoff/init use reporte_failure()
  * no more Lua code to be compiled at runtime


------------------------------------------------------------------------
r17109 | jmayer | 2006-01-27 07:57:18 -0600 (Fri, 27 Jan 2006) | 2 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

Add an <itemizedlist> ... </itemizedlist> to fix a buildbot build error.

------------------------------------------------------------------------
r17108 | lego | 2006-01-26 17:06:48 -0600 (Thu, 26 Jan 2006) | 6 lines
Changed paths:
   M /trunk/plugins/lua/lua_tap.c
   M /trunk/plugins/lua/packet-lua.c
   M /trunk/plugins/lua/packet-lua.h
   M /trunk/plugins/lua/plugin.c

* we need not to register the interesting fields via a tap its registration should be transparent to the user.
  - as of now I'm using a "boring" tap  (NULL packet_cb)  with a filter containing all the registered ones

* Lua code in init_lua() is not to be compiled anymore (I did)


------------------------------------------------------------------------
r17107 | sahlberg | 2006-01-26 16:50:16 -0600 (Thu, 26 Jan 2006) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-socks.c
   M /trunk/epan/dissectors/packet-tcp.c
   M /trunk/epan/dissectors/packet-tcp.h

rewrite of the tcp sequence number analysis code to hopefully make it cleaner and easier to maintain and extend.

i have tested it with many captures   but this used to be fragile and delicate code  so there might be some regressions that will need to be addressed once identified.





------------------------------------------------------------------------
r17106 | lego | 2006-01-26 14:20:55 -0600 (Thu, 26 Jan 2006) | 23 lines
Changed paths:
   M /trunk/plugins/lua/lua_proto.c
   M /trunk/plugins/lua/lua_tree.c
   M /trunk/plugins/lua/lua_tvb.c
   M /trunk/plugins/lua/packet-lua.c
   M /trunk/plugins/lua/packet-lua.h

 * lua_tree.c
   * protect proto_item_add_* calls with a TRY CATCH to avoid the Lua state getting corrupted
   * new ProtoItem:add_expert_info() call

 * lua_proto.c
   * protect call_dissector() and dissector_try_*() calls with TRY CATCH to avoid the Lua state getting corrupted
   * ValueString makes no sense, get rid of it we'll use Lua's associative arrays instead

 * lua_tvb.c
   * while creating a tvb from a ByteArray copy the ByteArray's data and set the tvb's free_cb
   * check bounds before calling tvb_*() to avoid a longjmp breaking Lua
   * do not leak the string in Tvb_tostring()
   * new Tvb:get_ipv4() call
   * new Tvb:get_eth() call

 * packet-lua.[ch]
   * export lua_tvb and lua_malformed to other modules being the current tvb and the protocol_id of malformed
   * convert some Lua to C
   * do not register ValueString (eliminated)




------------------------------------------------------------------------
r17105 | etxrab | 2006-01-26 00:54:52 -0600 (Thu, 26 Jan 2006) | 1 line
Changed paths:
   M /trunk/asn1/ranap/packet-ranap-template.c
   M /trunk/asn1/ranap/ranap.cnf
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-e212.c
   A /trunk/epan/dissectors/packet-e212.h
   M /trunk/epan/dissectors/packet-ranap.c

Add the abillity to translate MCC.
------------------------------------------------------------------------
r17104 | lego | 2006-01-25 16:49:58 -0600 (Wed, 25 Jan 2006) | 3 lines
Changed paths:
   M /trunk/plugins/lua/lua_proto.c

two bugs less


------------------------------------------------------------------------
r17103 | lego | 2006-01-25 16:39:07 -0600 (Wed, 25 Jan 2006) | 5 lines
Changed paths:
   M /trunk/plugins/lua/lua_pinfo.c
   M /trunk/plugins/lua/lua_proto.c
   M /trunk/plugins/lua/lua_tap.c
   M /trunk/plugins/lua/lua_tvb.c
   M /trunk/plugins/lua/packet-lua.c
   M /trunk/plugins/lua/packet-lua.h

One step at a time

several fixes and additions


------------------------------------------------------------------------
r17102 | ulfl | 2006-01-25 15:34:04 -0600 (Wed, 25 Jan 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-frame.c

from Gisle Vanem: 

This file uses SEH which AFAIK is only available for MS Visual-C.
I build using MingW/gcc, so the attached patch is needed. 
------------------------------------------------------------------------
r17101 | ulfl | 2006-01-25 15:32:55 -0600 (Wed, 25 Jan 2006) | 1 line
Changed paths:
   M /trunk/docbook/release-notes.xml

Win32: add SEH to the new features. It might be noteworthy to the users that we probably won't crash for hardware exceptions caused by buggy dissectors
------------------------------------------------------------------------
r17100 | lego | 2006-01-25 14:49:42 -0600 (Wed, 25 Jan 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-iuup.c

Bind IuUP to RTP


------------------------------------------------------------------------
r17099 | lego | 2006-01-25 14:48:37 -0600 (Wed, 25 Jan 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-frame.c

Use the right tree


------------------------------------------------------------------------
r17098 | etxrab | 2006-01-25 11:56:27 -0600 (Wed, 25 Jan 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a.c

- Add new IE:s 
- White space and comment changes.
- IE type fixes.
- Print timezone data.
------------------------------------------------------------------------
r17097 | lego | 2006-01-24 20:08:10 -0600 (Tue, 24 Jan 2006) | 7 lines
Changed paths:
   M /trunk/plugins/lua/Makefile.am
   M /trunk/plugins/lua/packet-lua.c
   M /trunk/plugins/lua/packet-lua.h

Avoid crashing when given an object of the wrong usertype

format_time()
format_date()
report_failure()


------------------------------------------------------------------------
r17096 | lego | 2006-01-24 17:22:52 -0600 (Tue, 24 Jan 2006) | 7 lines
Changed paths:
   M /trunk/plugins/lua/lua_pinfo.c
   M /trunk/plugins/lua/lua_proto.c
   M /trunk/plugins/lua/lua_tap.c
   M /trunk/plugins/lua/lua_tree.c
   M /trunk/plugins/lua/packet-lua.c
   M /trunk/plugins/lua/packet-lua.h

an Address class, changed the names of some classes, modified pinfo to be a table

pinfo.src = Address.ip("www.xxx.com")
pinfo.col.info = "A special packet"
if (pinfo.src_port == 2) then pinfo.col.protocol = "STRANGE" end


------------------------------------------------------------------------
r17095 | lego | 2006-01-24 17:18:09 -0600 (Tue, 24 Jan 2006) | 5 lines
Changed paths:
   D /trunk/plugins/lua/lua-5.0.2

it wasn't a goo idea,
sorry



------------------------------------------------------------------------
r17094 | etxrab | 2006-01-24 14:20:33 -0600 (Tue, 24 Jan 2006) | 1 line
Changed paths:
   M /trunk/gtk/sctp_byte_graph_dlg.c
   M /trunk/gtk/sctp_graph_dlg.c

Replace round() with floor(), I don't know if it's the right thing to do but at least it compiles on Windows again.
------------------------------------------------------------------------
r17093 | ulfl | 2006-01-24 13:03:09 -0600 (Tue, 24 Jan 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ldap.c
   M /trunk/epan/frame_data.c
   M /trunk/epan/frame_data.h

minor code cleanup
------------------------------------------------------------------------
r17092 | ulfl | 2006-01-24 12:59:49 -0600 (Tue, 24 Jan 2006) | 1 line
Changed paths:
   M /trunk/epan/libethereal.def

add missing capture_radiotap
------------------------------------------------------------------------
r17091 | jake | 2006-01-24 05:54:27 -0600 (Tue, 24 Jan 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-msnlb.c

Derived some more assumptions from NLB traffic

------------------------------------------------------------------------
r17090 | lego | 2006-01-23 20:11:38 -0600 (Mon, 23 Jan 2006) | 3 lines
Changed paths:
   M /trunk/epan/packet.c

fix a typo


------------------------------------------------------------------------
r17089 | lego | 2006-01-23 18:26:57 -0600 (Mon, 23 Jan 2006) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-frame.c
   M /trunk/epan/libethereal.def
   M /trunk/epan/packet.c
   M /trunk/epan/packet.h
   M /trunk/plugins/mate/packet-mate.c

Add register_postdissector() to the API.

Dissectors registered with register_postdissector() will be called after all other dissectors have been called.

Use it to register mate.


------------------------------------------------------------------------
r17088 | lego | 2006-01-23 18:04:53 -0600 (Mon, 23 Jan 2006) | 4 lines
Changed paths:
   M /trunk/plugins/lua/lua_pinfo.c
   M /trunk/plugins/lua/lua_proto.c
   M /trunk/plugins/lua/lua_tap.c
   M /trunk/plugins/lua/lua_tree.c
   M /trunk/plugins/lua/lua_tvb.c
   M /trunk/plugins/lua/packet-lua.h

 I forgot the Licence!
set svn:keywords Id on source


------------------------------------------------------------------------
r17087 | lego | 2006-01-23 17:55:13 -0600 (Mon, 23 Jan 2006) | 5 lines
Changed paths:
   M /trunk/plugins/lua
   M /trunk/plugins/lua/Makefile.am
   M /trunk/plugins/lua/lua-5.0.2/bin
   M /trunk/plugins/lua/lua-5.0.2/lib

Use .la instead of .so as dependency in Makefiles

Fix svn:ignore


------------------------------------------------------------------------
r17086 | lego | 2006-01-23 17:31:05 -0600 (Mon, 23 Jan 2006) | 7 lines
Changed paths:
   M /trunk/plugins/lua/Makefile.am
   A /trunk/plugins/lua/lua-5.0.2
   A /trunk/plugins/lua/lua-5.0.2/COPYRIGHT
   A /trunk/plugins/lua/lua-5.0.2/DIFFS
   A /trunk/plugins/lua/lua-5.0.2/HISTORY
   A /trunk/plugins/lua/lua-5.0.2/INSTALL
   A /trunk/plugins/lua/lua-5.0.2/MANIFEST
   A /trunk/plugins/lua/lua-5.0.2/Makefile
   A /trunk/plugins/lua/lua-5.0.2/README
   A /trunk/plugins/lua/lua-5.0.2/UPDATE
   A /trunk/plugins/lua/lua-5.0.2/bin
   A /trunk/plugins/lua/lua-5.0.2/build
   A /trunk/plugins/lua/lua-5.0.2/config
   A /trunk/plugins/lua/lua-5.0.2/configure
   A /trunk/plugins/lua/lua-5.0.2/doc
   A /trunk/plugins/lua/lua-5.0.2/doc/contents.html
   A /trunk/plugins/lua/lua-5.0.2/doc/logo.gif
   A /trunk/plugins/lua/lua-5.0.2/doc/lua.1
   A /trunk/plugins/lua/lua-5.0.2/doc/lua.html
   A /trunk/plugins/lua/lua-5.0.2/doc/luac.1
   A /trunk/plugins/lua/lua-5.0.2/doc/luac.html
   A /trunk/plugins/lua/lua-5.0.2/doc/manual.html
   A /trunk/plugins/lua/lua-5.0.2/doc/readme.html
   A /trunk/plugins/lua/lua-5.0.2/etc
   A /trunk/plugins/lua/lua-5.0.2/etc/Makefile
   A /trunk/plugins/lua/lua-5.0.2/etc/README
   A /trunk/plugins/lua/lua-5.0.2/etc/bin2c.c
   A /trunk/plugins/lua/lua-5.0.2/etc/compat.lua
   A /trunk/plugins/lua/lua-5.0.2/etc/doall.lua
   A /trunk/plugins/lua/lua-5.0.2/etc/lua.ico
   A /trunk/plugins/lua/lua-5.0.2/etc/lua.magic
   A /trunk/plugins/lua/lua-5.0.2/etc/lua.xpm
   A /trunk/plugins/lua/lua-5.0.2/etc/luser_number.h
   A /trunk/plugins/lua/lua-5.0.2/etc/luser_tests.h
   A /trunk/plugins/lua/lua-5.0.2/etc/min.c
   A /trunk/plugins/lua/lua-5.0.2/etc/noparser.c
   A /trunk/plugins/lua/lua-5.0.2/etc/saconfig.c
   A /trunk/plugins/lua/lua-5.0.2/etc/trace.c
   A /trunk/plugins/lua/lua-5.0.2/include
   A /trunk/plugins/lua/lua-5.0.2/include/Makefile
   A /trunk/plugins/lua/lua-5.0.2/include/lauxlib.h
   A /trunk/plugins/lua/lua-5.0.2/include/lua.h
   A /trunk/plugins/lua/lua-5.0.2/include/lualib.h
   A /trunk/plugins/lua/lua-5.0.2/lib
   A /trunk/plugins/lua/lua-5.0.2/src
   A /trunk/plugins/lua/lua-5.0.2/src/Makefile
   A /trunk/plugins/lua/lua-5.0.2/src/README
   A /trunk/plugins/lua/lua-5.0.2/src/lapi.c
   A /trunk/plugins/lua/lua-5.0.2/src/lapi.h
   A /trunk/plugins/lua/lua-5.0.2/src/lcode.c
   A /trunk/plugins/lua/lua-5.0.2/src/lcode.h
   A /trunk/plugins/lua/lua-5.0.2/src/ldebug.c
   A /trunk/plugins/lua/lua-5.0.2/src/ldebug.h
   A /trunk/plugins/lua/lua-5.0.2/src/ldo.c
   A /trunk/plugins/lua/lua-5.0.2/src/ldo.h
   A /trunk/plugins/lua/lua-5.0.2/src/ldump.c
   A /trunk/plugins/lua/lua-5.0.2/src/lfunc.c
   A /trunk/plugins/lua/lua-5.0.2/src/lfunc.h
   A /trunk/plugins/lua/lua-5.0.2/src/lgc.c
   A /trunk/plugins/lua/lua-5.0.2/src/lgc.h
   A /trunk/plugins/lua/lua-5.0.2/src/lib
   A /trunk/plugins/lua/lua-5.0.2/src/lib/Makefile
   A /trunk/plugins/lua/lua-5.0.2/src/lib/README
   A /trunk/plugins/lua/lua-5.0.2/src/lib/lauxlib.c
   A /trunk/plugins/lua/lua-5.0.2/src/lib/lbaselib.c
   A /trunk/plugins/lua/lua-5.0.2/src/lib/ldblib.c
   A /trunk/plugins/lua/lua-5.0.2/src/lib/liolib.c
   A /trunk/plugins/lua/lua-5.0.2/src/lib/lmathlib.c
   A /trunk/plugins/lua/lua-5.0.2/src/lib/loadlib.c
   A /trunk/plugins/lua/lua-5.0.2/src/lib/lstrlib.c
   A /trunk/plugins/lua/lua-5.0.2/src/lib/ltablib.c
   A /trunk/plugins/lua/lua-5.0.2/src/llex.c
   A /trunk/plugins/lua/lua-5.0.2/src/llex.h
   A /trunk/plugins/lua/lua-5.0.2/src/llimits.h
   A /trunk/plugins/lua/lua-5.0.2/src/lmem.c
   A /trunk/plugins/lua/lua-5.0.2/src/lmem.h
   A /trunk/plugins/lua/lua-5.0.2/src/lobject.c
   A /trunk/plugins/lua/lua-5.0.2/src/lobject.h
   A /trunk/plugins/lua/lua-5.0.2/src/lopcodes.c
   A /trunk/plugins/lua/lua-5.0.2/src/lopcodes.h
   A /trunk/plugins/lua/lua-5.0.2/src/lparser.c
   A /trunk/plugins/lua/lua-5.0.2/src/lparser.h
   A /trunk/plugins/lua/lua-5.0.2/src/lstate.c
   A /trunk/plugins/lua/lua-5.0.2/src/lstate.h
   A /trunk/plugins/lua/lua-5.0.2/src/lstring.c
   A /trunk/plugins/lua/lua-5.0.2/src/lstring.h
   A /trunk/plugins/lua/lua-5.0.2/src/ltable.c
   A /trunk/plugins/lua/lua-5.0.2/src/ltable.h
   A /trunk/plugins/lua/lua-5.0.2/src/ltests.c
   A /trunk/plugins/lua/lua-5.0.2/src/ltm.c
   A /trunk/plugins/lua/lua-5.0.2/src/ltm.h
   A /trunk/plugins/lua/lua-5.0.2/src/lua
   A /trunk/plugins/lua/lua-5.0.2/src/lua/Makefile
   A /trunk/plugins/lua/lua-5.0.2/src/lua/README
   A /trunk/plugins/lua/lua-5.0.2/src/lua/lua.c
   A /trunk/plugins/lua/lua-5.0.2/src/luac
   A /trunk/plugins/lua/lua-5.0.2/src/luac/Makefile
   A /trunk/plugins/lua/lua-5.0.2/src/luac/README
   A /trunk/plugins/lua/lua-5.0.2/src/luac/luac.c
   A /trunk/plugins/lua/lua-5.0.2/src/luac/print.c
   A /trunk/plugins/lua/lua-5.0.2/src/lundump.c
   A /trunk/plugins/lua/lua-5.0.2/src/lundump.h
   A /trunk/plugins/lua/lua-5.0.2/src/lvm.c
   A /trunk/plugins/lua/lua-5.0.2/src/lvm.h
   A /trunk/plugins/lua/lua-5.0.2/src/lzio.c
   A /trunk/plugins/lua/lua-5.0.2/src/lzio.h
   A /trunk/plugins/lua/lua-5.0.2/test
   A /trunk/plugins/lua/lua-5.0.2/test/README
   A /trunk/plugins/lua/lua-5.0.2/test/bisect.lua
   A /trunk/plugins/lua/lua-5.0.2/test/cf.lua
   A /trunk/plugins/lua/lua-5.0.2/test/echo.lua
   A /trunk/plugins/lua/lua-5.0.2/test/env.lua
   A /trunk/plugins/lua/lua-5.0.2/test/factorial.lua
   A /trunk/plugins/lua/lua-5.0.2/test/fib.lua
   A /trunk/plugins/lua/lua-5.0.2/test/fibfor.lua
   A /trunk/plugins/lua/lua-5.0.2/test/globals.lua
   A /trunk/plugins/lua/lua-5.0.2/test/hello.lua
   A /trunk/plugins/lua/lua-5.0.2/test/life.lua
   A /trunk/plugins/lua/lua-5.0.2/test/lua
   A /trunk/plugins/lua/lua-5.0.2/test/luac
   A /trunk/plugins/lua/lua-5.0.2/test/luac.lua
   A /trunk/plugins/lua/lua-5.0.2/test/printf.lua
   A /trunk/plugins/lua/lua-5.0.2/test/readonly.lua
   A /trunk/plugins/lua/lua-5.0.2/test/sieve.lua
   A /trunk/plugins/lua/lua-5.0.2/test/sort.lua
   A /trunk/plugins/lua/lua-5.0.2/test/table.lua
   A /trunk/plugins/lua/lua-5.0.2/test/trace-calls.lua
   A /trunk/plugins/lua/lua-5.0.2/test/trace-globals.lua
   A /trunk/plugins/lua/lua-5.0.2/test/undefined.lua
   A /trunk/plugins/lua/lua-5.0.2/test/xd.lua
   A /trunk/plugins/lua/lua_pinfo.c
   A /trunk/plugins/lua/lua_proto.c
   A /trunk/plugins/lua/lua_tap.c
   A /trunk/plugins/lua/lua_tree.c
   A /trunk/plugins/lua/lua_tvb.c
   M /trunk/plugins/lua/packet-lua.c
   A /trunk/plugins/lua/packet-lua.h
   M /trunk/plugins/lua/plugin.c

Add lua-5.0.2
Split packet-lua.c
Changes aren't tested.
It should compile ok.
Makefile.nmake still missing.


------------------------------------------------------------------------
r17085 | guy | 2006-01-23 17:21:02 -0600 (Mon, 23 Jan 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-radiotap.c

Add some more sanity checking of the Radiotap header.

------------------------------------------------------------------------
r17084 | etxrab | 2006-01-23 16:13:08 -0600 (Mon, 23 Jan 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-lldp.c

Bugfix: network address not dissected correctly
------------------------------------------------------------------------
r17083 | guy | 2006-01-23 10:56:34 -0600 (Mon, 23 Jan 2006) | 14 lines
Changed paths:
   M /trunk/capture_info.c
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/epan/dissectors/packet-ieee80211.h
   M /trunk/epan/dissectors/packet-radiotap.c

Call capture_radiotap() when capturing on a device supplying Radiotap
headers.

Fix capture_radiotap() to check for padding between the 802.11 header
and the 802.11 payload and to call different capture routines depending
on whether it's present or not, and create capture_ieee80211_datapad()
to handle the case where it's present.

Fix capture_radiotap() to convert the Radiotap header length from
little-endian, and to do some sanity checking of that length.

Fix capture_ieee80211_common() to use the offset supplied to it to fetch
the frame control field, as that offset isn't necessarily 0.

------------------------------------------------------------------------
r17082 | tuexen | 2006-01-23 05:56:49 -0600 (Mon, 23 Jan 2006) | 2 lines
Changed paths:
   M /trunk/gtk/sctp_byte_graph_dlg.c
   M /trunk/gtk/sctp_graph_dlg.c

From Irene: Add support for showing TSN and time in the graphical analysis.

------------------------------------------------------------------------
r17081 | guy | 2006-01-23 04:17:07 -0600 (Mon, 23 Jan 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

Rename all the COOK_ macros to indicate the field from which they're
extracting data (except for the association ID field, where adding
ASSOC_ID would be redundant).

------------------------------------------------------------------------
r17080 | guy | 2006-01-23 03:20:06 -0600 (Mon, 23 Jan 2006) | 50 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/epan/dissectors/packet-radiotap.c

From Sam Leffler:

	1. Fix a bug in caclulating the 802.11 header length for QoS
	   data frames (way bad regression from previous code). 

	2. Add support for packets w/ data padding between the 802.11
	   header and the payload (as indicated in the radiotap flags).

	3. Add support for handling FCS indication in the radiotap
	   flags. 

	4. Fix display of TSF (previous code was not byte swapping).

	5. Update ieee80211_mhz2ieee in radiotap.c to handle more
	   channels. 

	6. Nuke some #if 0 code I left in radiotap.c a while back.

Also, clean up the various macros that extract stuff from 802.11 header
fields or define bitfields within those header fields:

	group them by the fields from which they extract and the values
	they extract, or the header fields to which they belong;

	get rid of some of the COOK_ in the names - COOK_ really doesn't
	indicate anything useful, such as the field from which they're
	extracting (we should get rid of the rest);

	put in some more comments explaining what they do;

	get rid of some unused macros;

	get rid of some values that aren't flag values - they're values
	to test whether something's a data frame with a particular byte
	set in the subtype field, but they're only used on data frames,
	so we only need to test the bit in question, so we define macros
	to test the bit and name them to indicate that they're for use
	on data frames.

Consistently use "CF-Ack" and "CF-Poll" in the strings for various data
frame type/subtype values, and get rid of "802.11" (it should be obvious
to one and all that this is 802.11...).

Comment out some variables used only in commented-out code.

Get rid of some unused variables.

Fix up one "proto_tree_add_text()" call where the format string didn't
match the arguments.

------------------------------------------------------------------------
r17079 | jake | 2006-01-23 01:12:26 -0600 (Mon, 23 Jan 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-t38.c

Implemention of T38 TCP defragmentation by Alejandro Vaquero
------------------------------------------------------------------------
r17078 | etxrab | 2006-01-23 00:14:31 -0600 (Mon, 23 Jan 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-stun.c

From Marc Petit-Huguenin:
This patch for the STUN dissector fixes a bug (wrong value for DATA_INDICATION attribute) and adds the decoding of IPv6 address in attributes.


------------------------------------------------------------------------
r17077 | guy | 2006-01-22 17:14:58 -0600 (Sun, 22 Jan 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-t38.c

Get rid of unused variables, fix indentation, don't assign NULL to
non-pointer variables.

------------------------------------------------------------------------
r17076 | guy | 2006-01-22 17:08:15 -0600 (Sun, 22 Jan 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nbns.c

"size_t" can be "unsigned int" or "unsigned long", so cast it to
"unsigned long" and print it with %lu.

------------------------------------------------------------------------
r17075 | etxrab | 2006-01-22 15:16:33 -0600 (Sun, 22 Jan 2006) | 1 line
Changed paths:
   M /trunk/asn1/camel/camel.cnf
   M /trunk/asn1/camel/packet-camel-template.c
   M /trunk/asn1/gsmmap/GSMMAP.asn
   M /trunk/asn1/gsmmap/gsmmap.cnf
   M /trunk/asn1/gsmmap/packet-gsm_map-template.c
   M /trunk/asn1/ranap/packet-ranap-template.c
   M /trunk/epan/dissectors/packet-camel.c
   M /trunk/epan/dissectors/packet-gsm_a.c
   M /trunk/epan/dissectors/packet-gsm_map.c

Dissect CellGlobalIdOrServiceAreaIdOrLAI and RAIdentity
------------------------------------------------------------------------
r17074 | ulfl | 2006-01-22 13:31:42 -0600 (Sun, 22 Jan 2006) | 1 line
Changed paths:
   M /trunk/epan/reassemble.c

simply use DISSECTOR_ASSERT() to detect tvb problems instead of my previous commit
------------------------------------------------------------------------
r17073 | ulfl | 2006-01-22 10:47:16 -0600 (Sun, 22 Jan 2006) | 5 lines
Changed paths:
   M /trunk/epan/libethereal.def
   M /trunk/epan/reassemble.c
   M /trunk/epan/reassemble.h

add fragment_get_reassembled_id so the handed id doesn't need to be a packet number (experimental)

add a check to fragment_add_common() if the given tvb parameters are ok, otherwise throw a DissectorError

add some more symbols to libethereal.def
------------------------------------------------------------------------
r17072 | ulfl | 2006-01-22 10:32:45 -0600 (Sun, 22 Jan 2006) | 3 lines
Changed paths:
   M /trunk/epan/except.c

Win32: call an existing debugger if a DissectorError is thrown. This preserves the call stack of the bug making debugging much easier.

This can't be done in every error throwing case, as e.g. throwing a ReportedBoundsError might happen a lot even if no bugs are involved. Anyway, extending this to other errors can be done manually while debugging.
------------------------------------------------------------------------
r17071 | ulfl | 2006-01-22 10:26:41 -0600 (Sun, 22 Jan 2006) | 1 line
Changed paths:
   M /trunk/capture.c
   M /trunk/file.c
   M /trunk/file.h
   M /trunk/gtk/main.c

show the number of packets captured, if "Update list of packets ..." isn't used
------------------------------------------------------------------------
r17070 | ulfl | 2006-01-21 20:22:14 -0600 (Sat, 21 Jan 2006) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-frame.c

add Win32 Structured Exception Handling (SEH) at the same place we're already doing the Portable Exception Handling.

This way we (hopefully) can continue dissecting with the next packet, even if a more serious exception had occured, e.g. a memory access violation or a divide by zero exception.

Obviously, not all problems solved, as SEH won't protect us from other problems, e.g. endless loops and such
------------------------------------------------------------------------
r17069 | etxrab | 2006-01-21 13:12:52 -0600 (Sat, 21 Jan 2006) | 2 lines
Changed paths:
   M /trunk/asn1/ranap/ranap.cnf
   M /trunk/epan/dissectors/packet-gsm_a.c
   M /trunk/epan/dissectors/packet-ranap.c
   M /trunk/epan/dissectors/packet-ranap.h

RANAP - Dissect ProtocolExtensionField IE:s
GSM A - Service Request; Mobile identity element is LV type
------------------------------------------------------------------------
r17068 | ulfl | 2006-01-21 11:49:00 -0600 (Sat, 21 Jan 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-frame.c
   M /trunk/file.c
   M /trunk/tethereal.c

add matched coloring rule name and string to the frame dissector output (or nothing if no coloring rule matched or none was set)
------------------------------------------------------------------------
r17067 | lego | 2006-01-21 08:54:57 -0600 (Sat, 21 Jan 2006) | 5 lines
Changed paths:
   M /trunk/plugins/lua/README
   M /trunk/plugins/lua/packet-lua.c

Another iteration, new things aren't tested yet.
Update README, to have a description of the classes



------------------------------------------------------------------------
r17066 | ulfl | 2006-01-21 08:36:04 -0600 (Sat, 21 Jan 2006) | 5 lines
Changed paths:
   M /trunk/gtk/capture_if_details_dlg.c

bugfix #709: don't g_assert returned (mandatory) length of some NDIS driver functions.

simply ignore the length returned in that cases

this way, we may "print" buggy data, but that's what the driver returned ...
------------------------------------------------------------------------
r17065 | jmayer | 2006-01-20 15:18:18 -0600 (Fri, 20 Jan 2006) | 22 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bgp.c
   M /trunk/epan/dissectors/packet-dcm.c
   M /trunk/epan/dissectors/packet-diameter.c
   M /trunk/epan/dissectors/packet-dns.c
   M /trunk/epan/dissectors/packet-kerberos.c
   M /trunk/epan/dissectors/packet-nbipx.c
   M /trunk/epan/dissectors/packet-nbns.c
   M /trunk/epan/dissectors/packet-netbios.c
   M /trunk/epan/dissectors/packet-netbios.h
   M /trunk/epan/dissectors/packet-pgm.c
   M /trunk/epan/dissectors/packet-winsrepl.c
   M /trunk/epan/dissectors/packet-x11.c


packet-bgp.c: Fix incorrect use of g_snprintf return value
        mp_addr_to_str was unnecessary 'complex' - simplified it
packet-dns.c: Fix incorrect use of g_snprintf return value
packet-dcm.c: Fix incorrect use of g_snprintf return value
        Someone who understands the protocol should look at the
        "vr, tr might be used uninitialized..." warning.
packet-x11.c: Fix incorrect use of g_snprintf return value
packet-kerberos.c: Fix incorrect use of g_snprintf return value
        Someone should take a look at the
        "longjump might clobber ..." messages
packet-diameter.c: Fix incorrect use of g_snprintf return value
        Get rid of unsigned < 0 check
packet-pgm.c: Fix incorrect use of g_snprintf return value
packet-nbns.c: Fix incorrect use of g_snprintf return value
packet-winsrepl.c: Collateral damage to packet-nbns.c fix
packet-netbios.c: Collateral damage to packet-nbns.c fix
packet-netbios.h: Collateral damage to packet-nbns.c fix
packet-kerberos.c: Collateral damage to packet-nbns.c fix
packet-nbipx.c: Collateral damage to packet-nbns.c fix


------------------------------------------------------------------------
r17064 | jake | 2006-01-20 13:56:02 -0600 (Fri, 20 Jan 2006) | 1 line
Changed paths:
   M /trunk/gtk/conversations_table.c
   M /trunk/gtk/expert_comp_table.c

Cleaning up copy to CSV code
------------------------------------------------------------------------
r17063 | etxrab | 2006-01-20 13:41:31 -0600 (Fri, 20 Jan 2006) | 5 lines
Changed paths:
   M /trunk/asn1/gsmmap/packet-gsm_map-template.h
   M /trunk/epan/dissectors/packet-camel.c
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-gsm_map.h

Dissect:
 - PDPcontext
 - GSN-Address
 - QoS

------------------------------------------------------------------------
r17062 | etxrab | 2006-01-20 13:39:38 -0600 (Fri, 20 Jan 2006) | 5 lines
Changed paths:
   M /trunk/asn1/gsmmap/gsm_map-exp.cnf
   M /trunk/asn1/gsmmap/gsmmap.cnf
   M /trunk/asn1/gsmmap/packet-gsm_map-template.c

Dissect:
 - PDPcontext
 - GSN-Address
 - QoS

------------------------------------------------------------------------
r17061 | etxrab | 2006-01-20 13:34:53 -0600 (Fri, 20 Jan 2006) | 4 lines
Changed paths:
   M /trunk/asn1/camel/camel.asn
   M /trunk/asn1/camel/camel.cnf
   M /trunk/asn1/camel/packet-camel-template.c

Dissect:
- PDPcontext
- GSN-Address
- QoS
------------------------------------------------------------------------
r17060 | etxrab | 2006-01-20 13:32:59 -0600 (Fri, 20 Jan 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sccp.c

Handle sgmented XUDT:s
------------------------------------------------------------------------
r17059 | jmayer | 2006-01-20 03:09:26 -0600 (Fri, 20 Jan 2006) | 8 lines
Changed paths:
   M /trunk/plugins/lua/Makefile.am
   A /trunk/plugins/lua/README
   M /trunk/plugins/lua/packet-lua.c
   M /trunk/plugins/lua/plugin.c

Add the commit message as README

svn propset svn:keywords Id *
svn propset svn:eol-style native *

Todo: svn propset svn:ignore .
  Because I don't know what to ignore

------------------------------------------------------------------------
r17058 | jmayer | 2006-01-20 02:48:43 -0600 (Fri, 20 Jan 2006) | 8 lines
Changed paths:
   M /trunk/epan/column-utils.c
   M /trunk/epan/column.c
   M /trunk/epan/column_info.h
   M /trunk/epan/dissectors/packet-vlan.c


Mike Hall:

This will add the ability to configure a .1q vlan column in ethereal.

Me:
Change 1q -> 1Q

------------------------------------------------------------------------
r17057 | lego | 2006-01-19 18:06:20 -0600 (Thu, 19 Jan 2006) | 18 lines
Changed paths:
   A /trunk/plugins/lua
   A /trunk/plugins/lua/Makefile.am
   A /trunk/plugins/lua/packet-lua.c
   A /trunk/plugins/lua/plugin.c

Starts to work so I check it in.

This is an interface to the Lua programming language.

http://www.lua.org

I've already wrote a simple dissector that calls another dissectors.

soon It will be able to register a tap and do something more.

I did not checkin changes to the Makefiles so in order to use it you must change the makefiles.

Other than that to get it to work you need to download lua-5.0.2.tar.gz into the plugin directory, uncompress it, cd to it and call make.

the interface is buggy and far from finished, time will help on this.



------------------------------------------------------------------------
r17056 | gerald | 2006-01-19 17:01:24 -0600 (Thu, 19 Jan 2006) | 5 lines
Changed paths:
   M /trunk/epan/addr_resolv.c
   M /trunk/epan/dissectors/packet-sdp.c
   M /trunk/epan/dissectors/packet-tacacs.c

Make sure we don't use the ADNS version of inet_aton; it's broken.
This fixes bug 523, but exposes more of bug 658.

The TACACS and SDP dissectors don't call inet_aton(), so don't include it.

------------------------------------------------------------------------
r17055 | etxrab | 2006-01-19 12:20:14 -0600 (Thu, 19 Jan 2006) | 2 lines
Changed paths:
   M /trunk/asn1/gsmmap/gsmmap.cnf
   M /trunk/asn1/gsmmap/packet-gsm_map-template.c
   M /trunk/epan/dissectors/packet-gsm_a.c
   M /trunk/epan/dissectors/packet-gsm_a.h
   M /trunk/epan/dissectors/packet-gsm_map.c

ext_qos_subscribed was not correctly decoded in Camel and GSM MAP
Change to use proto_add_item in packet-gsm_a.c for some octets and export value strings.
------------------------------------------------------------------------
r17054 | etxrab | 2006-01-18 23:51:59 -0600 (Wed, 18 Jan 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sccp.c

Dont dissect XDT data in case of Segmentation as that will give [Malformed packet] and the Segmentation IE will n ot be dissecterd.
------------------------------------------------------------------------
r17053 | ulfl | 2006-01-18 20:00:28 -0600 (Wed, 18 Jan 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc.c

add "RPC_E_TIMEOUT" to the reject status codes
------------------------------------------------------------------------
r17052 | jake | 2006-01-18 15:41:34 -0600 (Wed, 18 Jan 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-clnp.c

Add option presentation, solving bug 697
------------------------------------------------------------------------
r17051 | gerald | 2006-01-18 14:02:19 -0600 (Wed, 18 Jan 2006) | 11 lines
Changed paths:
   M /trunk/asn1/snmp/packet-snmp-template.c
   M /trunk/epan/dissectors/packet-cops.c
   M /trunk/epan/dissectors/packet-snmp.c
   M /trunk/epan/emem.c

In packet-cops.c use proto_item_append_text() instead of creating a
separate buffer.  Fixes the current Buildbot failure.

Don't let the sprint_realloc_* functions reallocate ep_allocated memory.
Add comments warning against this in the future.

In emem.c, make sure we don't use an extra 100k every stinkin' time
someone wants to allocate memory when debugging is enabled.

Fixup whitespace.

------------------------------------------------------------------------
r17050 | etxrab | 2006-01-17 15:52:30 -0600 (Tue, 17 Jan 2006) | 1 line
Changed paths:
   M /trunk/asn1/camel/camel.cnf
   M /trunk/asn1/camel/packet-camel-template.c
   M /trunk/epan/dissectors/packet-camel.c
   M /trunk/epan/dissectors/packet-gsm_a.c
   M /trunk/epan/dissectors/packet-gsm_a.h

Change some OPCODE decodes from respons to Invoke (bug fix), let gsm_a decode som IE:s.
------------------------------------------------------------------------
r17049 | etxrab | 2006-01-17 15:50:43 -0600 (Tue, 17 Jan 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ethertype.c
   M /trunk/epan/etypes.h

Add ethertypes and value_str for IEC 61850
------------------------------------------------------------------------
r17048 | gerald | 2006-01-17 12:50:02 -0600 (Tue, 17 Jan 2006) | 2 lines
Changed paths:
   M /trunk/epan/to_str.c

Fix an off-by-one error.  Fixes bug 698, possibly others.

------------------------------------------------------------------------
r17047 | jmayer | 2006-01-17 07:13:29 -0600 (Tue, 17 Jan 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

According to 802.11e D11, 7.3.2.13, station count is a 16 bit value.
Accoding to 802.11, 7.1.1, numbers are little endian.

------------------------------------------------------------------------
r17046 | jmayer | 2006-01-17 04:56:06 -0600 (Tue, 17 Jan 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cops.c
   M /trunk/epan/dissectors/packet-fcswils.c
   M /trunk/epan/dissectors/packet-wccp.c
   M /trunk/epan/dissectors/packet-wtp.c

packet-fcswils.c: Fix incorrect use of g_snprintf return
packet-wccp.c: Fix incorrect use of g_snprintf return
packet-cops.c: Fix incorrect use of g_snprintf return value
packet-wtp.c: Fix incorrect use of g_snprintf return value


------------------------------------------------------------------------
r17045 | jmayer | 2006-01-17 04:54:23 -0600 (Tue, 17 Jan 2006) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

- Replace snprintf by g_snprintf
- Beginning of incorrect g_snprintf retval ussage fixes
- Make qbss station count a byte again until we know
  whether the count is a 2 byte le value instead

------------------------------------------------------------------------
r17044 | jake | 2006-01-17 00:39:57 -0600 (Tue, 17 Jan 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-t38.c

Fix typo, solving bug 693
------------------------------------------------------------------------
r17043 | ulfl | 2006-01-16 19:18:51 -0600 (Mon, 16 Jan 2006) | 1 line
Changed paths:
   M /trunk/gtk/main.c

remove an obsolete comment
------------------------------------------------------------------------
r17042 | ulfl | 2006-01-16 18:40:32 -0600 (Mon, 16 Jan 2006) | 9 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/gtk/main.c
   A /trunk/image/eiconcap16.xpm
   A /trunk/image/eiconcap32.xpm
   A /trunk/image/eiconcap48.xpm

GTK 2.x only: show a slightly different Ethereal main icon while capturing.

I very often forget to stop a running capture, so Ethereal keeps capturing packets on and on, leaving me with a lot of unrequired packets.

On the other hand (because of the above) I often maximize Ethereal just to see that it's really not capturing any longer.

Looking at the window title isn't of much help, as this title changes with every capture file name loaded, so there's no title which can be easily remembered.

We probably might use this icon mechanism as well, when Ethereal loads a (huge) file, so the user get's a more visual feedback when the capture loading is finished (and probably for other potential "lengthy" tasks as well).
------------------------------------------------------------------------
r17041 | ulfl | 2006-01-16 18:01:22 -0600 (Mon, 16 Jan 2006) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ldap.c

MSVC compiler warnings:

packet-ldap.c(784) : warning C4101: 'seq_len' : unreferenced local variable
packet-ldap.c(782) : warning C4101: 'length' : unreferenced local variable
packet-ldap.c(785) : warning C4101: 'header_bytes' : unreferenced local variable
------------------------------------------------------------------------
r17040 | ulfl | 2006-01-16 17:43:06 -0600 (Mon, 16 Jan 2006) | 1 line
Changed paths:
   M /trunk/docbook/release-notes.xml

add bugs #648 and #661: "Win32: Unicode chars in filenames" as they seems to be really relevant for some Win32 users
------------------------------------------------------------------------
r17039 | jmayer | 2006-01-16 10:31:54 -0600 (Mon, 16 Jan 2006) | 14 lines
Changed paths:
   M /trunk/tools/pidl/tests/Util.pm

Update from samba tree revision 12761 to 12961
============================ Samba log start ============
------------------------------------------------------------------------
r12776 | metze | 2006-01-08 21:20:18 +0100 (Sun, 08 Jan 2006) | 3 lines
Changed paths:
   M /branches/SAMBA_4_0/source/pidl/tests/Util.pm

use $ENV{TEST_DATA_PREFIX} for test files if available

metze
------------------------------------------------------------------------
============================ Samba log end ==============


------------------------------------------------------------------------
r17038 | jmayer | 2006-01-16 01:59:44 -0600 (Mon, 16 Jan 2006) | 41 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c
   M /trunk/epan/dissectors/packet-bootp.c
   M /trunk/epan/dissectors/packet-clnp.c
   M /trunk/epan/dissectors/packet-icmpv6.c
   M /trunk/epan/dissectors/packet-isakmp.c
   M /trunk/epan/dissectors/packet-ldap.c
   M /trunk/epan/dissectors/packet-mip6.c
   M /trunk/epan/dissectors/packet-ntp.c
   M /trunk/epan/dissectors/packet-ospf.c
   M /trunk/epan/dissectors/packet-pim.c
   M /trunk/epan/dissectors/packet-ppp.c
   M /trunk/epan/dissectors/packet-ptp.c
   M /trunk/epan/dissectors/packet-pvfs2.c
   M /trunk/epan/dissectors/packet-radius.c
   M /trunk/epan/dissectors/packet-radius.h
   M /trunk/epan/dissectors/packet-smb-sidsnooping.c
   M /trunk/epan/dissectors/packet-tcp.c
   M /trunk/epan/dissectors/packet-tr.c
   M /trunk/epan/dissectors/packet-windows-common.c

done:

packet-ntp.c: Rather confused and incorrect use of g_snprintf return value
packet-pim.c: whitespace change
packet-icmpv6.c: g_snprintf takes trailing \0 into account, fix off by 1 error
packet-clnp.c: Fix incorrect use of g_snprintf return value
packet-isakmp.c: g_snprintf takes trailing \0 into account
packet-tr.c: Fix incorrect use of g_snprintf return value
packet-radius.c: Fix incorrect use of g_snprintf return value
packet-radius.h: constify a string variable
packet-ldap.c: The return value isn't needed, so don't use it incorrectly
packet-tcp.c: Fix incorrect use of g_snprintf return value
packet-windows-common.c: Remove unneeded DISSECTOR_ASSERT
packet-smb-sidsnooping.c: g_snprintf takes trailing \0 into account
packet-pvfs2.c: g_snprintf takes trailing \0 into account
packet-ptp.c: Remove #include snprintf
packet-ppp.c: Fix incorrect use of g_snprintf return value
packet-ospf.c: Fix incorrect use of g_snprintf return value
packet-mip6.c: snprintf -> g_snprintf
packet-bootp.c: Remove a commented out bad use of g_snprintf
packet-ber.c: snprintf -> g_snprintf, g_snprintf takes trailing \0 into account

2do:

     52 packet-ieee80211.c: 2DO
      2 packet-nfs.c: 2DO - too many side effects
     33 packet-bgp.c: 2DO
     18 packet-dns.c: 2DO
     14 packet-dcm.c: 2DO
     13 packet-x11.c: 2DO
     11 packet-kerberos.c: 2DO
     10 packet-diameter.c: 2DO
      9 packet-snmp.c: 2DO
      9 packet-pgm.c: 2DO
      7 packet-nbns.c: 2DO
      6 packet-fcswils.c: 2DO
      5 packet-wccp.c: 2DO
      5 packet-cops.c: 2DO
      4 packet-wtp.c: 2DO


------------------------------------------------------------------------
r17037 | jake | 2006-01-16 00:31:25 -0600 (Mon, 16 Jan 2006) | 2 lines
Changed paths:
   M /trunk/gtk/voip_calls.c

Remove uninitalized variable warning

------------------------------------------------------------------------
r17036 | etxrab | 2006-01-16 00:05:25 -0600 (Mon, 16 Jan 2006) | 4 lines
Changed paths:
   M /trunk/asn1/h235/Makefile.nmake
   M /trunk/asn1/h245/Makefile.nmake
   M /trunk/asn1/h245/h245.cnf
   M /trunk/asn1/h245/packet-h245-template.c
   M /trunk/epan/dissectors/packet-h245.c
   M /trunk/epan/dissectors/packet-h245.h

From Alejandro Vaquero:
patch to add t38 setup info for h245 packets.

- Me add /y to makefiles.
------------------------------------------------------------------------
r17035 | etxrab | 2006-01-15 16:10:56 -0600 (Sun, 15 Jan 2006) | 1 line
Changed paths:
   M /trunk/asn1/ansi_map/ansi_map.asn
   M /trunk/asn1/ansi_map/packet-ansi_map-template.c

Backup changes.
------------------------------------------------------------------------
r17034 | etxrab | 2006-01-15 16:09:41 -0600 (Sun, 15 Jan 2006) | 1 line
Changed paths:
   M /trunk/diameter/dictionary.xml
   M /trunk/diameter/nasreq.xml

Sort AVP:s nummerically to make updates easier, remove double entries add nasreq AVP:s and expand some enums.
------------------------------------------------------------------------
r17033 | jake | 2006-01-15 09:01:14 -0600 (Sun, 15 Jan 2006) | 17 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sdp.c
   M /trunk/epan/dissectors/packet-t38.c
   M /trunk/epan/dissectors/packet-t38.h
   M /trunk/epan/libethereal.def
   M /trunk/epan/reassemble.c
   M /trunk/gtk/rpc_stat.c
   M /trunk/gtk/t38_analysis.c
   M /trunk/gtk/voip_calls.c
   M /trunk/gtk/voip_calls.h
   M /trunk/gtk/voip_calls_dlg.c

Hi All,
  Find attached a couple of changes for t38:
- Use the dissector to reassemble t30 frames
- Dissect t30 protocol
- Move the "Fax t38 analysis" to the "VoIP Calls". Now when selecting
"Statistics"->"Fax t38 analysis" option, there is a message that
redirect the user to use the "Voip calls" instead. We may keep this
option for one release, and then remove it ?
- Added in the "Voip calls" the ability to detect a t38 call if there
are not signaling associated with it. For example, when using "Decode
as.." to dissect t38 packets, it is possible to use the "Voip calls" to                                                      analyze that call.
- Display "SDP (t38)" in the "Voip calls graph" for SDP t38 sessions.

Regards
Alejandro Vaquero


------------------------------------------------------------------------
r17032 | ulfl | 2006-01-15 07:51:58 -0600 (Sun, 15 Jan 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-clnp.c

add COTP to fragment COL_INFO message, so the user knows where the fragment is coming from
------------------------------------------------------------------------
r17031 | jmayer | 2006-01-14 17:09:44 -0600 (Sat, 14 Jan 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-windows-common.c


Jaap Keuter:
I'm not too fond of using pointer arithmetic in such cases. How about
this:


------------------------------------------------------------------------
r17030 | jmayer | 2006-01-14 05:29:24 -0600 (Sat, 14 Jan 2006) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-windows-common.c

We may not work with the length returned by g_snprintf, as this is
the number of bytes that would have been used if the buffer was long
enough.
Fixes http://bugs.ethereal.com/bugzilla/show_bug.cgi?id=686

------------------------------------------------------------------------
r17029 | etxrab | 2006-01-14 03:52:04 -0600 (Sat, 14 Jan 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-m3ua.c

MTP3 standard in SCCP MTP3 and M3UA will be determined by Preference setting in MTP3.
------------------------------------------------------------------------
r17028 | jmayer | 2006-01-13 12:30:12 -0600 (Fri, 13 Jan 2006) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

- Change Cisco QBSS V2 to be part of the Aironet IE dissection.
- Change proto_tree_add_uint ( ...., tvb_get_guint8(...)) to
  proto_tree_add_item ( ....) for all qbss dissection code
- Change all qbss occurrences scount to be 16 bits (I may have
  gotten endianess wrong! Testers / sample captures needed)
- Change wlan_mgt.tag.aironet... filter to wlan_mgt.aironet...

------------------------------------------------------------------------
r17027 | jake | 2006-01-13 09:17:50 -0600 (Fri, 13 Jan 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a.c

From Patrik Olsson
Attached is a patch that fixes several decoding problem is the gsm_a
dissector. The bugs are also submitted to bugzilla id #684 and #687.

------------------------------------------------------------------------
r17026 | jmayer | 2006-01-12 22:35:10 -0600 (Thu, 12 Jan 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-3com-njack.c

Add code to verify the shared secret for documentation purposes.
#if 0 that code.


------------------------------------------------------------------------
r17025 | ulfl | 2006-01-12 16:38:37 -0600 (Thu, 12 Jan 2006) | 5 lines
Changed paths:
   M /trunk/capture_opts.c
   M /trunk/gtk/main.c

fix #661

Win32: convert filenames coming in from command line parameters from locale (current code page) into utf8 encoding

This must also be done for the other command line tools like tethereal, editcap and alike ...
------------------------------------------------------------------------
r17024 | ulfl | 2006-01-12 16:32:29 -0600 (Thu, 12 Jan 2006) | 5 lines
Changed paths:
   M /trunk/epan/addr_resolv.c
   M /trunk/epan/filesystem.c
   M /trunk/epan/filesystem.h

fix #648: 

Win32 only: reading a pathname from an environment var requires us to read it in as unicode somehow and convert it to utf8. Using _wgetenv should work under all circumstances on NT, using getenv and g_locale_to_utf8 on Windows OT is the best we can do in this case.


------------------------------------------------------------------------
r17023 | jake | 2006-01-12 16:16:20 -0600 (Thu, 12 Jan 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-udp.c

Add warning when UDP length field is too large.
Patch by Graeme Hewson

------------------------------------------------------------------------
r17022 | gerald | 2006-01-12 15:53:02 -0600 (Thu, 12 Jan 2006) | 5 lines
Changed paths:
   M /trunk/asn1/h245/packet-h245-template.c
   M /trunk/epan/dissectors/packet-h245.c
   M /trunk/epan/dissectors/packet-h245.h

Reset h245_pi using CLEANUP_PUSH/CLEANUP_CALL_AND_POP so that we don't leave
ep_alloc()ated memory lying around.  Fixes bug 667.

Fixup whitespace.

------------------------------------------------------------------------
r17021 | etxrab | 2006-01-12 13:27:56 -0600 (Thu, 12 Jan 2006) | 1 line
Changed paths:
   M /trunk/asn1/ansi_map/ansi_map.asn
   M /trunk/asn1/ansi_map/ansi_map.cnf
   M /trunk/asn1/ansi_map/packet-ansi_map-template.c

Backup the latest edits
------------------------------------------------------------------------
r17020 | jake | 2006-01-12 10:17:07 -0600 (Thu, 12 Jan 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-snmp.c

Fixes bug 679. 
The offset wasn't passed to the PDU dissector so it always started dissection
from the start of the TVB.

------------------------------------------------------------------------
r17019 | jake | 2006-01-12 09:02:25 -0600 (Thu, 12 Jan 2006) | 6 lines
Changed paths:
   M /trunk/wiretap/netxray.c

The attached patch to fix bug 663 allows Ethereal to read Windows
Sniffer V2 format capture files with captyp=5, timeunit=0.
The ticks_per_sec for this case apparently is 1e6.

Bill Meier

------------------------------------------------------------------------
r17018 | ulfl | 2006-01-12 05:21:07 -0600 (Thu, 12 Jan 2006) | 3 lines
Changed paths:
   M /trunk/version_info.c

we have 2006 in the meantime ...

I've also added "and contributors" to the copyright string
------------------------------------------------------------------------
r17017 | kukosa | 2006-01-12 03:29:41 -0600 (Thu, 12 Jan 2006) | 1 line
Changed paths:
   M /trunk/epan/to_str.c

oid_to_str_buf() keep enough speace before appending next part of string (Bug 669)
------------------------------------------------------------------------
r17016 | etxrab | 2006-01-12 00:09:48 -0600 (Thu, 12 Jan 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-juniper.c

FromHannes Gredler
-rework the GGSN dissector to proper parse meta extensions -more graceful magic-number detection - for better (JUNOS 6.4)
   downwards compatability
-correct calculate the offset to ATM cookies when there
   are meta-extensions present

------------------------------------------------------------------------
r17015 | gerald | 2006-01-11 20:06:34 -0600 (Wed, 11 Jan 2006) | 4 lines
Changed paths:
   M /trunk/asn1/h248/packet-h248-template.c
   M /trunk/epan/dissectors/packet-h248.c

Before we begin dissection, NULLify some global variables that might
contain ep_alloc()ed data from a previous dissection.  Correctly fixes
bug 651 (the previous fix was incorrect).

------------------------------------------------------------------------
r17014 | ulfl | 2006-01-11 19:32:06 -0600 (Wed, 11 Jan 2006) | 1 line
Changed paths:
   M /trunk/gtk/main.c

update usage output
------------------------------------------------------------------------
r17013 | ulfl | 2006-01-11 19:31:22 -0600 (Wed, 11 Jan 2006) | 1 line
Changed paths:
   M /trunk/doc/ethereal.pod

minor changes
------------------------------------------------------------------------
r17012 | ulfl | 2006-01-11 19:29:20 -0600 (Wed, 11 Jan 2006) | 1 line
Changed paths:
   M /trunk/tethereal.c

minor changes
------------------------------------------------------------------------
r17011 | ulfl | 2006-01-11 18:13:40 -0600 (Wed, 11 Jan 2006) | 3 lines
Changed paths:
   M /trunk/tethereal.c

fix usage output 

fix -F command option handling (output list of available formats if missing of invalid)
------------------------------------------------------------------------
r17010 | ulfl | 2006-01-11 18:10:46 -0600 (Wed, 11 Jan 2006) | 1 line
Changed paths:
   M /trunk/doc/tethereal.pod

fix sequence of time stamp ordering: from most to least information content
------------------------------------------------------------------------
r17009 | ulfl | 2006-01-11 18:09:15 -0600 (Wed, 11 Jan 2006) | 1 line
Changed paths:
   M /trunk/dumpcap.c

minor changes to the usage output
------------------------------------------------------------------------
r17008 | jake | 2006-01-11 16:05:43 -0600 (Wed, 11 Jan 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bootp.c
   M /trunk/epan/dissectors/packet-ieee80211.c

From Thomas Sillaber

here is the Patch for:
    - AVA (Alcatel Automatic VLAN Assignment)
    - QBSS ( QOS Basic Service Set)

------------------------------------------------------------------------
r17007 | ulfl | 2006-01-11 15:36:00 -0600 (Wed, 11 Jan 2006) | 3 lines
Changed paths:
   M /trunk/doc/ethereal.pod

add <> to the option parameters

add some minor enhancements
------------------------------------------------------------------------
r17006 | ulfl | 2006-01-11 15:34:52 -0600 (Wed, 11 Jan 2006) | 1 line
Changed paths:
   M /trunk/doc/tethereal.pod

note that "-i -" doesn't work on Win32
------------------------------------------------------------------------
r17005 | ulfl | 2006-01-11 15:00:54 -0600 (Wed, 11 Jan 2006) | 3 lines
Changed paths:
   M /trunk/doc/tethereal.pod

add <>add <> to the option parameters

rephrase some sentences
------------------------------------------------------------------------
r17004 | ulfl | 2006-01-11 14:57:29 -0600 (Wed, 11 Jan 2006) | 1 line
Changed paths:
   M /trunk/doc/text2pcap.pod

add <> to the option parameters
------------------------------------------------------------------------
r17003 | jmayer | 2006-01-11 12:43:17 -0600 (Wed, 11 Jan 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-3com-njack.c

set: The first 4 bytes seem to be the salt
------------------------------------------------------------------------
r17002 | gerald | 2006-01-11 11:18:33 -0600 (Wed, 11 Jan 2006) | 2 lines
Changed paths:
   M /trunk/epan/emem.c

Pass the correct arguments to fopen().

------------------------------------------------------------------------
r17001 | gerald | 2006-01-11 09:39:03 -0600 (Wed, 11 Jan 2006) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-srvloc.c

If we pass a short length to unicode_to_bytes(), return an empty string
instead of clobbering a canary.  This replicates its pre-canarification
behavior (which may not be correct).

Fixup whitespace.

------------------------------------------------------------------------
r17000 | jake | 2006-01-11 05:35:25 -0600 (Wed, 11 Jan 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ndps.c

This patch fixes a couple of bind replies to report proper session id.
Greg Morris


------------------------------------------------------------------------
r16999 | ulfl | 2006-01-11 04:14:32 -0600 (Wed, 11 Jan 2006) | 1 line
Changed paths:
   M /trunk/text2pcap.c

update usage text
------------------------------------------------------------------------
r16998 | gerald | 2006-01-10 20:05:05 -0600 (Tue, 10 Jan 2006) | 2 lines
Changed paths:
   M /trunk/epan/emem.c

Fix compiling under GLib 1, squelch a gcc warning.

------------------------------------------------------------------------
r16997 | ulfl | 2006-01-10 19:53:46 -0600 (Tue, 10 Jan 2006) | 1 line
Changed paths:
   M /trunk/doc/capinfos.pod
   M /trunk/doc/editcap.pod
   M /trunk/doc/mergecap.pod

instead of repeating the capture file format description over and over again (this list also tends to become outdated), just give a small description and refer to the Ethereal man page
------------------------------------------------------------------------
r16996 | ulfl | 2006-01-10 19:38:16 -0600 (Tue, 10 Jan 2006) | 1 line
Changed paths:
   M /trunk/capinfos.c
   M /trunk/doc/capinfos.pod

same command line related changes as recently done with editcap
------------------------------------------------------------------------
r16995 | gerald | 2006-01-10 17:28:16 -0600 (Tue, 10 Jan 2006) | 6 lines
Changed paths:
   M /trunk/asn1/x509if/x509if.cnf
   M /trunk/epan/dissectors/packet-x509if.c
   M /trunk/epan/dissectors/packet-x509if.h

Make sure last_dn is big enough, and set it to NULL when we're
finished with it.  This should fix the current menagerie failure
in Buildbot.

Fix up whitespace.

------------------------------------------------------------------------
r16994 | ulfl | 2006-01-10 17:06:05 -0600 (Tue, 10 Jan 2006) | 1 line
Changed paths:
   M /trunk/doc/mergecap.pod
   M /trunk/mergecap.c

same command line related changes as recently done with editcap
------------------------------------------------------------------------
r16993 | ulfl | 2006-01-10 16:00:37 -0600 (Tue, 10 Jan 2006) | 1 line
Changed paths:
   M /trunk/editcap.c

print the list of available types also if the given type is invalid
------------------------------------------------------------------------
r16992 | ulfl | 2006-01-10 15:39:21 -0600 (Tue, 10 Jan 2006) | 3 lines
Changed paths:
   M /trunk/doc/editcap.pod

added <>: [-c packets per file] -> [-c <packets per file>]

update to my latest command line changes
------------------------------------------------------------------------
r16991 | ulfl | 2006-01-10 15:37:36 -0600 (Tue, 10 Jan 2006) | 9 lines
Changed paths:
   M /trunk/editcap.c

redesign of the usage output (displayed with -h or an unknown option):

option explanation is more detailed now, I've added the option parameters to the description

added version information to the usage output

instead of using the usage page to display the available file and encapsulation types (which makes the usage page almost unreadable), use empty options -F or -T to print the available types. I've used optopt for this, it seems to be portable that way ...


------------------------------------------------------------------------
r16990 | gerald | 2006-01-10 15:31:33 -0600 (Tue, 10 Jan 2006) | 2 lines
Changed paths:
   M /trunk/epan/emem.c

Close "/dev/urandom" if we manage to open it.

------------------------------------------------------------------------
r16989 | gerald | 2006-01-10 15:12:48 -0600 (Tue, 10 Jan 2006) | 3 lines
Changed paths:
   M /trunk/epan/emem.c

Allocate memory on 8-byte boundaries again.  Tweak the way we 
fill the canary data.

------------------------------------------------------------------------
r16988 | etxrab | 2006-01-10 13:57:15 -0600 (Tue, 10 Jan 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-diameter.c

Handle <application id="4294967295" name="Relay"/>

------------------------------------------------------------------------
r16987 | etxrab | 2006-01-10 13:56:03 -0600 (Tue, 10 Jan 2006) | 1 line
Changed paths:
   M /trunk/diameter/chargecontrol.xml
   M /trunk/diameter/dictionary.xml

Update with AVP:s from the dictionary Joost Yervante Damad sent.
------------------------------------------------------------------------
r16986 | jmayer | 2006-01-10 10:19:56 -0600 (Tue, 10 Jan 2006) | 7 lines
Changed paths:
   M /trunk/epan/proto.c

Didier Gautheron:
        proto.c uses the wrong pointer in error msg.

Me:
        Be more verbose in case of illegal characters when
        registering filter names.

------------------------------------------------------------------------
r16985 | guy | 2006-01-10 03:01:35 -0600 (Tue, 10 Jan 2006) | 3 lines
Changed paths:
   M /trunk/epan/emem.c

Allowing pointer arithmetic on "void *"s is a GCCism; cast "void *"s to
"char *" before adding an offset to them.

------------------------------------------------------------------------
r16984 | gerald | 2006-01-09 17:11:40 -0600 (Mon, 09 Jan 2006) | 3 lines
Changed paths:
   M /trunk/epan/emem.c

Add canary values after each allocation.  If our canaries values don't
match when we call {ep|se}_free_all(), throw an assertion.

------------------------------------------------------------------------
r16983 | jake | 2006-01-09 17:00:20 -0600 (Mon, 09 Jan 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ip.c
   M /trunk/epan/dissectors/packet-ipv6.c

Add UDP-Lite packets to the UDP statistics

------------------------------------------------------------------------
r16982 | ulfl | 2006-01-09 15:22:13 -0600 (Mon, 09 Jan 2006) | 1 line
Changed paths:
   M /trunk/doc/editcap.pod

complete redesign of this manpage
------------------------------------------------------------------------
r16981 | ulfl | 2006-01-09 15:14:32 -0600 (Mon, 09 Jan 2006) | 5 lines
Changed paths:
   M /trunk/editcap.c

add a new command line option "chop", which will simply cut off the last "n" bytes from each packet. This is required (at least by me) when converting from PacketGrabber files which sometimes seem to include some additional bytes.

sort the usage string, so it will be ordered alphabetically

replace appearances of "frame" and "record" with "packet"
------------------------------------------------------------------------
r16980 | etxrab | 2006-01-09 15:12:22 -0600 (Mon, 09 Jan 2006) | 1 line
Changed paths:
   M /trunk/asn1/camel/packet-camel-template.c
   M /trunk/epan/dissectors/packet-camel.c

Use col_set_fence(), not to owerwrite colinfo if more than one Camel pdu is in one TCAP message.
------------------------------------------------------------------------
r16979 | gerald | 2006-01-09 11:44:02 -0600 (Mon, 09 Jan 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tds.c

Add more data types from tds.h.  Fix unknown data skipping for some data
types. Fixup whitespace.

------------------------------------------------------------------------
r16978 | jmayer | 2006-01-09 01:41:26 -0600 (Mon, 09 Jan 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

First attempt to decode CCX type 4 IEs (QoS?)

------------------------------------------------------------------------
r16977 | etxrab | 2006-01-07 07:07:04 -0600 (Sat, 07 Jan 2006) | 1 line
Changed paths:
   M /trunk/asn1/ansi_map/ansi_map.asn
   M /trunk/asn1/ansi_map/ansi_map.cnf
   M /trunk/asn1/ansi_map/packet-ansi_map-template.c

Add dissection of more IE:s
------------------------------------------------------------------------
r16976 | ulfl | 2006-01-07 05:28:16 -0600 (Sat, 07 Jan 2006) | 1 line
Changed paths:
   M /trunk/help/capture_filters.txt

fix bug #654: precise the link to the capture filter syntax (tcpdump man page "expression")
------------------------------------------------------------------------
r16975 | etxrab | 2006-01-07 05:10:50 -0600 (Sat, 07 Jan 2006) | 12 lines
Changed paths:
   M /trunk/asn1/camel/packet-camel-template.c
   M /trunk/epan/dissectors/packet-camel.c
   M /trunk/epan/dissectors/packet-camel.h
   M /trunk/gtk/flow_graph.c

From Olivier Jacques, 
Here is a patch that:
- Replaces the arrow labels by the beginning of the COLINFO column if available (usually containing message names/types).
- Change the comment area to be "protocol: colinfo_content"
From Anders
Added ID tag

Camel
Use col_set_str to remove TCAP info in col_info
 


------------------------------------------------------------------------
r16974 | ulfl | 2006-01-07 05:08:07 -0600 (Sat, 07 Jan 2006) | 1 line
Changed paths:
   M /trunk/gtk/hostlist_table.c

fix bug #660: we must alphabetically sort columns 0&1, not 0&2
------------------------------------------------------------------------
r16973 | guy | 2006-01-06 21:36:37 -0600 (Fri, 06 Jan 2006) | 4 lines
Changed paths:
   M /trunk/epan/tvbuff.c

Add some inflateEnd() calls to free up stuff associated with a stream
before freeing the stream; bug 659 mentioned one of them, but there
appear to be others.

------------------------------------------------------------------------
r16972 | ulfl | 2006-01-06 19:29:45 -0600 (Fri, 06 Jan 2006) | 1 line
Changed paths:
   M /trunk/capture_loop.c
   M /trunk/capture_loop.h
   M /trunk/capture_opts.c
   M /trunk/capture_opts.h
   M /trunk/tethereal.c

move output_to_pipe flag from tethereal's loop_data into capture_opts, so it can be used by dumpcap (capture_loop.c) as well
------------------------------------------------------------------------
r16971 | ulfl | 2006-01-06 19:19:29 -0600 (Fri, 06 Jan 2006) | 3 lines
Changed paths:
   M /trunk/wiretap/erf.c

don't claim to be an erf file if it isn't (e.g. if the file_read call fails)

I don't know if this is the right way to fix it, but it seems at least better than before
------------------------------------------------------------------------
r16970 | ulfl | 2006-01-06 19:15:35 -0600 (Fri, 06 Jan 2006) | 1 line
Changed paths:
   A /trunk/test/suite-io.sh
   M /trunk/test/test.sh

add a new suite of file I/O test cases
------------------------------------------------------------------------
r16969 | ulfl | 2006-01-06 19:14:29 -0600 (Fri, 06 Jan 2006) | 1 line
Changed paths:
   M /trunk/test/suite-capture.sh

fix a test case and some comments
------------------------------------------------------------------------
r16968 | jmayer | 2006-01-06 18:37:58 -0600 (Fri, 06 Jan 2006) | 1 line
Changed paths:
   M /trunk/Makefile.am

Don't link dumpcap with -lm
------------------------------------------------------------------------
r16967 | gerald | 2006-01-06 14:03:52 -0600 (Fri, 06 Jan 2006) | 3 lines
Changed paths:
   M /trunk/asn1/h248/packet-h248-template.c
   M /trunk/docbook/release-notes.xml
   M /trunk/epan/dissectors/packet-h248.c

Don't dereference a null pointer.  Fixes bug 651.  Update the release notes
accordingly.

------------------------------------------------------------------------
r16966 | jmayer | 2006-01-06 04:37:56 -0600 (Fri, 06 Jan 2006) | 6 lines
Changed paths:
   M /trunk/gtk/flow_graph.c

Olivier Jacques:

Here is a very small patch against current SVN for a mem free bug in
flow graph feature.


------------------------------------------------------------------------
r16965 | jmayer | 2006-01-05 21:26:45 -0600 (Thu, 05 Jan 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-bacapp.c
   M /trunk/epan/dissectors/packet-dcerpc-netlogon.c
   M /trunk/epan/dissectors/packet-slsk.c
   M /trunk/epan/dissectors/packet-smpp.c
   M /trunk/epan/dissectors/packet-ucp.c

Bill Meier: More spelling fixes
------------------------------------------------------------------------
r16964 | ulfl | 2006-01-05 19:11:31 -0600 (Thu, 05 Jan 2006) | 1 line
Changed paths:
   M /trunk/test/suite-capture.sh

minor cleanup
------------------------------------------------------------------------
r16963 | ulfl | 2006-01-05 19:08:15 -0600 (Thu, 05 Jan 2006) | 1 line
Changed paths:
   M /trunk/docbook/eug_src/EUG_chapter_advanced.xml

add a new section about checksums
------------------------------------------------------------------------
r16962 | ulfl | 2006-01-05 19:06:46 -0600 (Thu, 05 Jan 2006) | 5 lines
Changed paths:
   M /trunk/capture_loop.c
   M /trunk/tethereal.c
   M /trunk/wiretap/file_access.c

code cleanup: use "-" for all places, where stdin/stdout is meant

tethereal internally converted the stdout capture filename "-" into "" which doesn't make any real sense and only complicated things.

To make things even more confusing, wiretap expected "" for dump output and "-" for offline reading ...
------------------------------------------------------------------------
r16961 | guy | 2006-01-05 17:44:16 -0600 (Thu, 05 Jan 2006) | 7 lines
Changed paths:
   M /trunk/tethereal.c

Catch a combination of "-S" and "-w -" - you'll just get
non-human-readable and non-machine-readable garbage from that
combination.

Use an exit code of 1 for command-line argument syntax errors in some
more cases.

------------------------------------------------------------------------
r16960 | ulfl | 2006-01-05 16:27:25 -0600 (Thu, 05 Jan 2006) | 1 line
Changed paths:
   M /trunk/dumpcap.c

cleanup of exit_main() declaration
------------------------------------------------------------------------
r16959 | ulfl | 2006-01-05 16:26:05 -0600 (Thu, 05 Jan 2006) | 1 line
Changed paths:
   M /trunk/test/suite-capture.sh

add a test case: writing the capture file to stdout: "-w -"
------------------------------------------------------------------------
r16958 | ulfl | 2006-01-05 16:24:09 -0600 (Thu, 05 Jan 2006) | 1 line
Changed paths:
   M /trunk/wiretap/file_access.c

Win32: set stdout to binary mode in wtap_dump_fdopen(), so tethereal is also able to write capture files to stdout using -w -
------------------------------------------------------------------------
r16957 | jmayer | 2006-01-05 12:53:22 -0600 (Thu, 05 Jan 2006) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bacapp.c
   M /trunk/epan/dissectors/packet-bacapp.h

Steve Karg:

I fixed fBACnetPropertyValue in the BACnet packet-bacapp.c dissector
where an optional decoding for Priority wasn't being optional.  A valid
packet with a confirmedEventNotification that did not have the optional
priority made this bug evident by indicating Malformed Packet.

Me:
Fixed some signedness warnings, #if 0'ed out unused functions.

------------------------------------------------------------------------
r16956 | jmayer | 2006-01-05 07:01:08 -0600 (Thu, 05 Jan 2006) | 4 lines
Changed paths:
   M /trunk/asn1/gsmmap/packet-gsm_map-template.c
   M /trunk/asn1/mms/mms.asn
   M /trunk/epan/dissectors/ncp2222.py
   M /trunk/epan/dissectors/packet-3g-a11.c
   M /trunk/epan/dissectors/packet-afp.c
   M /trunk/epan/dissectors/packet-alcap.c
   M /trunk/epan/dissectors/packet-amr.c
   M /trunk/epan/dissectors/packet-ansi_map.c
   M /trunk/epan/dissectors/packet-aoe.c
   M /trunk/epan/dissectors/packet-bpdu.c
   M /trunk/epan/dissectors/packet-brdwlk.c
   M /trunk/epan/dissectors/packet-bssgp.c
   M /trunk/epan/dissectors/packet-csm-encaps.c
   M /trunk/epan/dissectors/packet-dcerpc-dce122.c
   M /trunk/epan/dissectors/packet-dcerpc-netlogon.c
   M /trunk/epan/dissectors/packet-dcerpc-wkssvc.c
   M /trunk/epan/dissectors/packet-diameter.c
   M /trunk/epan/dissectors/packet-dlsw.c
   M /trunk/epan/dissectors/packet-gsm_a.c
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-iax2.c
   M /trunk/epan/dissectors/packet-igmp.c
   M /trunk/epan/dissectors/packet-igrp.c
   M /trunk/epan/dissectors/packet-isup.c
   M /trunk/epan/dissectors/packet-m3ua.c
   M /trunk/epan/dissectors/packet-mip.c
   M /trunk/epan/dissectors/packet-mms.c
   M /trunk/epan/dissectors/packet-msdp.c
   M /trunk/epan/dissectors/packet-nfs.c
   M /trunk/epan/dissectors/packet-nisplus.c
   M /trunk/epan/dissectors/packet-nt-sonmp.c
   M /trunk/epan/dissectors/packet-ppp.c
   M /trunk/epan/dissectors/packet-radius.c
   M /trunk/epan/dissectors/packet-ranap.c
   M /trunk/epan/dissectors/packet-rtps.c
   M /trunk/epan/dissectors/packet-sigcomp.c
   M /trunk/epan/dissectors/packet-smpp.c
   M /trunk/epan/dissectors/packet-sua.c
   M /trunk/epan/dissectors/packet-ucp.c
   M /trunk/epan/dissectors/packet-vnc.c
   M /trunk/epan/dissectors/packet-x25.c
   M /trunk/epan/sigcomp-udvm.c
   M /trunk/plugins/docsis/packet-docsis.c
   M /trunk/plugins/docsis/packet-tlv.c
   M /trunk/plugins/lwres/packet-lwres.c
   M /trunk/plugins/mate/mate_setup.c
   M /trunk/plugins/v5ua/packet-v5ua.c


Bill Meier:
  Spelling fixes.

------------------------------------------------------------------------
r16955 | jmayer | 2006-01-05 06:45:36 -0600 (Thu, 05 Jan 2006) | 1 line
Changed paths:
   M /trunk/tools

Update svn:ignore
------------------------------------------------------------------------
r16954 | jmayer | 2006-01-05 06:43:35 -0600 (Thu, 05 Jan 2006) | 1 line
Changed paths:
   M /trunk/tools/fuzz-test.sh

Reminder to clean up in case of ctrl-c etc
------------------------------------------------------------------------
r16953 | jmayer | 2006-01-05 06:41:39 -0600 (Thu, 05 Jan 2006) | 1 line
Changed paths:
   M /trunk/asn1/rnsap

Add svn:ignore
------------------------------------------------------------------------
r16952 | jmayer | 2006-01-05 05:28:40 -0600 (Thu, 05 Jan 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

- Undo the COL_PROTOCOL misuse introduced with rev 15115.
- Start dissection of Aironet vendor specific stuff.

------------------------------------------------------------------------
r16951 | jmayer | 2006-01-05 03:20:08 -0600 (Thu, 05 Jan 2006) | 1 line
Changed paths:
   M /trunk/make-version.pl

Change SVN version from date to revision
------------------------------------------------------------------------
r16950 | jmayer | 2006-01-05 02:52:06 -0600 (Thu, 05 Jan 2006) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipmi.c

Fix for http://bugs.ethereal.com/bugzilla/show_bug.cgi?id=656
Incorrect decoding of IPMI System Software IDs


------------------------------------------------------------------------
r16949 | jmayer | 2006-01-05 02:33:53 -0600 (Thu, 05 Jan 2006) | 14 lines
Changed paths:
   M /trunk/manuf
   M /trunk/wka.tmpl


Jaap Keuter:

I've captured a Direct Cable Connection on a WinXP machine (see
http://wiki.ethereal.com/SampleCaptures?action=AttachFile&do=get&target=PPP-config.cap).
The thing is that the capture lib(?) creates fake Ethernet headers for
the PPP LCP and NCP packets. These contain " SEND#" or " RECV#" as both
source and destination address, where "#" seems to be a session number
based on modem control signals(?).

Anyway, to make more sense of the direction these PPP frames are going
I've added them to the address resolution file, as per attached patch.


------------------------------------------------------------------------
r16948 | jmayer | 2006-01-05 02:31:37 -0600 (Thu, 05 Jan 2006) | 1 line
Changed paths:
   M /trunk/epan/dissectors/Makefile.common

Forgot to add packet-oicq.c
------------------------------------------------------------------------
r16947 | jmayer | 2006-01-05 02:23:17 -0600 (Thu, 05 Jan 2006) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

Jaap Keuter:
  >From the Debian bug database this bug:
  http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=342588

  The rates information element with zero tag length leads to uninitialised
  memory access, presenting bogus data for the element. The attached patch
  takes care of that.

Me:
  One space in the map listing is enough.

------------------------------------------------------------------------
r16946 | ulfl | 2006-01-04 18:29:32 -0600 (Wed, 04 Jan 2006) | 1 line
Changed paths:
   M /trunk/test/suite-clopts.sh

interface index 0 is invalid (starting with 1), check if it's rejected correctly
------------------------------------------------------------------------
r16945 | ulfl | 2006-01-04 18:28:10 -0600 (Wed, 04 Jan 2006) | 1 line
Changed paths:
   M /trunk/test/test-backend.sh

add the possibility for a prepare step before doing the actual test step
------------------------------------------------------------------------
r16944 | ulfl | 2006-01-04 18:26:37 -0600 (Wed, 04 Jan 2006) | 1 line
Changed paths:
   M /trunk/test/test.sh

add missing keys 4-9
------------------------------------------------------------------------
r16943 | guy | 2006-01-04 03:49:18 -0600 (Wed, 04 Jan 2006) | 6 lines
Changed paths:
   M /trunk/tethereal.c

Set "ld.save_file" when we start capturing, so we can report capture
errors.

Display output errors with either 'the file "XXX"' or 'the standard
output".

------------------------------------------------------------------------
r16942 | guy | 2006-01-03 21:07:16 -0600 (Tue, 03 Jan 2006) | 13 lines
Changed paths:
   M /trunk/tethereal.c

Distinguish between "writing to the standard output" and "writing to a
pipe"; there's not much point in writing to the standard output if
you're *not* writing to a pipe, but....

"-b" doesn't necessarily imply a ring buffer - you can just request that
Tethereal keep switching files forever.

Standardize on an exit status of 1 for all those errors (there's a
sort-of convention, adhered to by many apps, that an exit status of 1
means a command-line argument error (as in "illegal flag" or "you
combined two flags that don't make sense together") and an exit status
of 2 is for other "run-time" errors.

------------------------------------------------------------------------
r16941 | guy | 2006-01-03 20:50:56 -0600 (Tue, 03 Jan 2006) | 4 lines
Changed paths:
   M /trunk/capture_loop.c

Handle a null-string file name in "capture_loop_open_output()" - that's
what indicates that we're supposed to write to the standard output
(Tethereal turns "-" into "").

------------------------------------------------------------------------
r16940 | jmayer | 2006-01-03 17:59:13 -0600 (Tue, 03 Jan 2006) | 6 lines
Changed paths:
   M /trunk/AUTHORS
   A /trunk/epan/dissectors/packet-oicq.c

Du Bingyao:
        New OICQ dissector.

Me:
        removed some not needed variables and some unneeded includes.

------------------------------------------------------------------------
r16939 | jmayer | 2006-01-03 17:45:58 -0600 (Tue, 03 Jan 2006) | 13 lines
Changed paths:
   M /trunk/gtk/follow_dlg.c

Jaap Keuter:

Browsing through the wishlist I came across this old one by Steve Brown:
------8<------
The GTK1 UI wordwraps assembled TCP streams, the GTK2 UI doesn't, but
should also. Not wrapping makes reading any protocol that lacks linebreaks
virtually impossible (XML, etc.) as it all ends up on one line. I'm tired
of having to install the GTK1 UI :P
------8<------
It seems like a simple request. The oneliner patch implements this wish.
Maybe someone feels the need to make it a preference or selectable.


------------------------------------------------------------------------
r16938 | jmayer | 2006-01-03 17:43:24 -0600 (Tue, 03 Jan 2006) | 3 lines
Changed paths:
   M /trunk/dumpcap.c

__attribute__ noreturn can only be used in function declations.


------------------------------------------------------------------------
r16937 | jmayer | 2006-01-03 17:23:46 -0600 (Tue, 03 Jan 2006) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ip.c

Jon Oberheide:

Ethereal does not take into account the protocol field of the IP header
when reassembling fragmented packets as specified in RFC791.  This can
lead to incorrect reassembly of packets with an identical src address,
dst address, and identification number, but with differing protocols.

The attached patch includes the protocol in the generation of the id
used to index into the reassembly table.


------------------------------------------------------------------------
r16936 | jmayer | 2006-01-03 17:17:49 -0600 (Tue, 03 Jan 2006) | 6 lines
Changed paths:
   M /trunk/Makefile.am

Found by henning.treu

doc/README.malloc and  doc/README.stats_tree were missing from the
distribution.


------------------------------------------------------------------------
r16935 | guy | 2006-01-03 16:49:58 -0600 (Tue, 03 Jan 2006) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-windows-common.h

Fix a typo in a comment.

------------------------------------------------------------------------
r16934 | etxrab | 2006-01-03 10:24:56 -0600 (Tue, 03 Jan 2006) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtcp.c

From Martin Mathieson
I keep finding finding traces that show new problems with this code.  This patch fixes 2 problems:
- I've seen RTCP frames containing a SR and RR with identical source info and the lsr matching the current MSW/LSW timestamp of the SR.  Don't want to do calculation without real roundtrip info
- calculating the gap between the 2 frames was still wrong (sigh)

------------------------------------------------------------------------
r16933 | etxrab | 2006-01-03 10:20:06 -0600 (Tue, 03 Jan 2006) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-3g-a11.c

From Ravi Valmikam

 Over the last year or so there have been several developments in the 3GPP2 specifications. One of the areas that saw significant changes was A11 interface between PDSN and PCF. With the introduction of QoS support on this interface, the specification includes a lot of new information elements in this protocol
------------------------------------------------------------------------
r16932 | etxrab | 2006-01-03 09:13:26 -0600 (Tue, 03 Jan 2006) | 1 line
Changed paths:
   M /trunk/asn1/ansi_map/ansi_map.asn
   M /trunk/asn1/ansi_map/ansi_map.cnf
   M /trunk/asn1/ansi_map/packet-ansi_map-template.c

Further asn1 code updates and IE decoding.
------------------------------------------------------------------------
r16931 | guy | 2006-01-02 04:52:50 -0600 (Mon, 02 Jan 2006) | 2 lines
Changed paths:
   M /trunk/asn1/h248/packet-h248-template.c
   M /trunk/epan/dissectors/packet-h248.c

Fix a typo.

------------------------------------------------------------------------
r16930 | guy | 2006-01-02 04:37:52 -0600 (Mon, 02 Jan 2006) | 2 lines
Changed paths:
   M /trunk/tools/Makefile.am

That's "PIDL_FILES", not "PIDLFILES".

------------------------------------------------------------------------
r16929 | jmayer | 2006-01-01 18:43:28 -0600 (Sun, 01 Jan 2006) | 3 lines
Changed paths:
   M /trunk/tools/Makefile.am

- Move pidl files into PIDL_FILES and include this info EXTRA_DIST.
- Sort files alphabetically.

------------------------------------------------------------------------
r16928 | jmayer | 2006-01-01 17:50:47 -0600 (Sun, 01 Jan 2006) | 1 line
Changed paths:
   M /trunk/tools/Makefile.am

Forgot to commit Makefile.am with the samba changes
------------------------------------------------------------------------
r16927 | jmayer | 2006-01-01 17:14:44 -0600 (Sun, 01 Jan 2006) | 77 lines
Changed paths:
   M /trunk/epan/dissectors/pidl/idl_types.h
   M /trunk/tools/pidl/MANIFEST
   M /trunk/tools/pidl/README
   M /trunk/tools/pidl/TODO
   M /trunk/tools/pidl/lib/Parse/Pidl/Compat.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/NDR.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba4/COM/Header.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba4/COM/Proxy.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba4/EJS.pm
   D /trunk/tools/pidl/lib/Parse/Pidl/Samba4/EJSHeader.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba4/NDR/Parser.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba4/NDR/Server.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba4/TDR.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Util.pm
   M /trunk/tools/pidl/lib/Parse/Pidl.pm
   M /trunk/tools/pidl/pidl
   M /trunk/tools/pidl/tests/Util.pm

Update from samba tree revision 12488 to 12669
============================ Samba log start ============
------------------------------------------------------------------------
r12488 | jelmer | 2005-12-26 02:37:18 +0100 (Mon, 26 Dec 2005) | 2 lines

Fix MANIFEST to match recent changes

------------------------------------------------------------------------
r12490 | jelmer | 2005-12-26 03:14:18 +0100 (Mon, 26 Dec 2005) | 2 lines

Fix --warn-compat

------------------------------------------------------------------------
r12501 | jelmer | 2005-12-26 23:47:40 +0100 (Mon, 26 Dec 2005) | 4 lines

Merge EJSHeader.pm into EJS.pm and simplify smbcalls_rpc.c a bit,
now that it is guaranteed that the smbcalls modules are always
initialized
after the EJS subsystem itself.

------------------------------------------------------------------------
r12512 | jelmer | 2005-12-27 17:22:35 +0100 (Tue, 27 Dec 2005) | 3 lines

Use GUID structs in API functions everywhere rather then converting back
and
forth between GUID structs and strings in several places.

------------------------------------------------------------------------
r12515 | jelmer | 2005-12-27 18:50:53 +0100 (Tue, 27 Dec 2005) | 2 lines

Use UUID directly rather then string containing UUID

------------------------------------------------------------------------
r12517 | jelmer | 2005-12-27 20:13:18 +0100 (Tue, 27 Dec 2005) | 2 lines

Don't generate empty init functions

------------------------------------------------------------------------
r12528 | jelmer | 2005-12-27 23:51:30 +0100 (Tue, 27 Dec 2005) | 2 lines

Add seperate proto headers for ntvfs, tdr, smb_server and nbt_server.

------------------------------------------------------------------------
r12539 | metze | 2005-12-28 10:31:43 +0100 (Wed, 28 Dec 2005) | 3 lines

fix the pidl tests

metze
------------------------------------------------------------------------
r12572 | jelmer | 2005-12-29 17:03:03 +0100 (Thu, 29 Dec 2005) | 2 lines

No longer parse coclasses as interfaces

------------------------------------------------------------------------
r12573 | jelmer | 2005-12-29 17:03:47 +0100 (Thu, 29 Dec 2005) | 2 lines

Update README to recent changes in pidls namespace

------------------------------------------------------------------------
r12574 | jelmer | 2005-12-29 17:04:34 +0100 (Thu, 29 Dec 2005) | 3 lines

Bring tables.pl back to life and move registration of interfaces
now completely to a new subsystem.

------------------------------------------------------------------------
r12651 | jelmer | 2005-12-31 15:57:43 +0100 (Sat, 31 Dec 2005) | 2 lines
Changed paths:
   M /branches/SAMBA_4_0/source/librpc/idl/idl_types.h
   M /branches/SAMBA_4_0/source/librpc/ndr/libndr.h
   M /branches/SAMBA_4_0/source/librpc/ndr/ndr_string.c

Remove STR_LARGE_SIZE as it's no longer used

------------------------------------------------------------------------
============================ Samba log end ==============


------------------------------------------------------------------------
r16926 | ulfl | 2005-12-31 11:09:27 -0600 (Sat, 31 Dec 2005) | 5 lines
Changed paths:
   M /trunk/gtk/dcerpc_stat.c
   M /trunk/gtk/file_dlg.c
   M /trunk/gtk/filter_dlg.c
   M /trunk/gtk/filter_dlg.h
   M /trunk/gtk/find_dlg.c
   M /trunk/gtk/io_stat.c
   M /trunk/gtk/main.c
   M /trunk/gtk/rpc_stat.c
   M /trunk/gtk/tap_dfilter_dlg.c

fix #152

set the read filter dialog modal and transient to the parent window if requested. This way, it will receive input signals (solving problems with GTK2's gtk_file_chooser).

To do this, add another construct_args flag, so it will be modal only if really needed ...
------------------------------------------------------------------------
r16925 | ulfl | 2005-12-31 05:48:32 -0600 (Sat, 31 Dec 2005) | 1 line
Changed paths:
   M /trunk/wiretap/snoop.c

bugfix to #649: first convert to microseconds, then eventually swap byte ordering (not the other way round)
------------------------------------------------------------------------
r16924 | ulfl | 2005-12-31 04:51:15 -0600 (Sat, 31 Dec 2005) | 3 lines
Changed paths:
   M /trunk/dumpcap.c

add the GCC specific attribute "noreturn" to exit_main()

add an error message if no interfaces could be found (and mention that it might be a privilege problem)
------------------------------------------------------------------------
r16923 | ulfl | 2005-12-31 04:48:29 -0600 (Sat, 31 Dec 2005) | 3 lines
Changed paths:
   M /trunk/capture_loop.c

Ooops, remove a debug message in the Win32 code part of the capturing loop.

It might (very slightly) slow down capturing in the 0.10.14 release :-(
------------------------------------------------------------------------
r16922 | ulfl | 2005-12-31 04:22:57 -0600 (Sat, 31 Dec 2005) | 7 lines
Changed paths:
   M /trunk/dumpcap.c

From Jaap Keuter:

Even though dumpcap isn't finished I would like this patch applied in
order to:
1. remove some compiler warnings
2. avoid a seg fault when running dumpcap without parameters as normal
user.
------------------------------------------------------------------------
r16921 | lego | 2005-12-30 20:19:24 -0600 (Fri, 30 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtcp.c

Fixes Bug 531 (Incorrect Interpretation of Bit vector and RLE RTCP XR Blocks).


------------------------------------------------------------------------
r16920 | lego | 2005-12-30 12:41:56 -0600 (Fri, 30 Dec 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-radius.c

From: Graeme Hewson 	
Decryption of the RADIUS User-Password attribute is currently broken.


------------------------------------------------------------------------
r16919 | ulfl | 2005-12-29 10:49:58 -0600 (Thu, 29 Dec 2005) | 4 lines
Changed paths:
   M /trunk/docbook/developer-guide.xml
   M /trunk/docbook/user-guide.xml

remove the document version. As we are using the subversion it's no longer needed.
The former versioning didn't really worked quite well. 

add the (changed) messages section back to the user's guide appendix
------------------------------------------------------------------------
r16918 | ulfl | 2005-12-29 10:47:12 -0600 (Thu, 29 Dec 2005) | 3 lines
Changed paths:
   M /trunk/docbook/eug_src/EUG_app_messages.xml

remove the former description of the dialog boxes, which is pretty useless as the dialogs should be (or improved to be) self explaining.

explain the messages in the packet list and packet details (e.g. [Malformed Packet])
------------------------------------------------------------------------
r16917 | ulfl | 2005-12-29 10:43:58 -0600 (Thu, 29 Dec 2005) | 1 line
Changed paths:
   M /trunk/docbook/edg_src/EDG_chapter_sources.xml

we don't have nightly builds an longer, but buildbot builds - update the text accordingly
------------------------------------------------------------------------
r16916 | lego | 2005-12-28 17:57:43 -0600 (Wed, 28 Dec 2005) | 4 lines
Changed paths:
   M /trunk/epan/tvbparse.c
   M /trunk/epan/tvbparse.h

Change tvbparse's engine to use callbacks instead of a big switch.
add some primitives.


------------------------------------------------------------------------
r16915 | etxrab | 2005-12-28 15:32:41 -0600 (Wed, 28 Dec 2005) | 1 line
Changed paths:
   M /trunk/asn1/ansi_map/ansi_map.asn
   M /trunk/asn1/ansi_map/ansi_map.cnf
   M /trunk/asn1/ansi_map/packet-ansi_map-template.c

Updates to the ASN1 code and decode some IE:s
------------------------------------------------------------------------
r16914 | lego | 2005-12-28 13:46:57 -0600 (Wed, 28 Dec 2005) | 5 lines
Changed paths:
   M /trunk/asn1/h248/h248.cnf
   M /trunk/asn1/h248/packet-h248-template.c
   M /trunk/asn1/h248/packet-h248-template.h
   M /trunk/epan/dissectors/packet-h248.c
   M /trunk/epan/dissectors/packet-h248.h

- Decode some more annex C fields
- Keep track of terminations (link wildcarded ones to real ones)
- Keep termination info and link aal2 terminations to alcap legs


------------------------------------------------------------------------
r16913 | lego | 2005-12-28 13:38:33 -0600 (Wed, 28 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-alcap.c
   M /trunk/epan/dissectors/packet-alcap.h

Keep a hash of call legs indexed by nsap:sugr and separate the leg tree code so that it can be called from others.


------------------------------------------------------------------------
r16912 | gerald | 2005-12-28 10:19:31 -0600 (Wed, 28 Dec 2005) | 4 lines
Changed paths:
   M /trunk/ChangeLog
   M /trunk/NEWS
   M /trunk/docbook/Makefile
   M /trunk/docbook/release-notes.xml

Fix download URLs in the release notes.  Disable building release-notes.txt,
since the Windows build server doesn't have elinks.  Copy over ChangeLog and
NEWS from 0.10.14.

------------------------------------------------------------------------
r16911 | jmayer | 2005-12-27 17:08:37 -0600 (Tue, 27 Dec 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rsync.c

As reported by Toralf Foerster in bug 647:
It should be "Authentication" (2x "t") not "Authenication"


------------------------------------------------------------------------
r16910 | gerald | 2005-12-27 16:22:14 -0600 (Tue, 27 Dec 2005) | 2 lines
Changed paths:
   M /trunk/docbook/Makefile

Add a "release-notes.txt" target.

------------------------------------------------------------------------
r16909 | ulfl | 2005-12-27 15:56:59 -0600 (Tue, 27 Dec 2005) | 1 line
Changed paths:
   M /trunk/docbook/developer-guide.xml
   M /trunk/docbook/edg_src/EDG_chapter_libraries.xml
   M /trunk/docbook/edg_src/EDG_preface.xml

minor updates (URL's and such)
------------------------------------------------------------------------
r16907 | gerald | 2005-12-27 12:33:58 -0600 (Tue, 27 Dec 2005) | 2 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/config.nmake
   M /trunk/tools/win32-setup.sh

Update to Net-SNMP 5.2.2.

------------------------------------------------------------------------
r16906 | ulfl | 2005-12-27 11:39:14 -0600 (Tue, 27 Dec 2005) | 6 lines
Changed paths:
   M /trunk/docbook/eug_src/EUG_chapter_advanced.xml
   M /trunk/docbook/eug_src/EUG_chapter_use.xml
   M /trunk/docbook/eug_src/EUG_chapter_work.xml
   M /trunk/docbook/graphics/ethereal-view-menu.png

add two new sections:

7.3 time stamps
7.4 time zones

add the "View menu - time stamp" precision additions
------------------------------------------------------------------------
r16902 | ulfl | 2005-12-27 05:46:29 -0600 (Tue, 27 Dec 2005) | 3 lines
Changed paths:
   M /trunk/docbook/user-guide.xml

resequence the list of authors, as I'm doing most of the work for some time now

add some timezone/DST related URL's
------------------------------------------------------------------------
r16901 | ulfl | 2005-12-27 05:43:15 -0600 (Tue, 27 Dec 2005) | 3 lines
Changed paths:
   M /trunk/docbook/edg_graphics/ethereal-logo.png
   M /trunk/docbook/edg_graphics/note.png
   M /trunk/docbook/edg_graphics/tip.png
   M /trunk/docbook/edg_graphics/warning.png
   M /trunk/docbook/graphics/ethereal-logo.png
   M /trunk/docbook/graphics/note.png
   M /trunk/docbook/graphics/tip.png
   M /trunk/docbook/graphics/warning.png

replace the png's that have a transparent background with a white background.

The pdf conversion process doesn't work properly with transparent backgrounds
------------------------------------------------------------------------
r16900 | ulfl | 2005-12-27 05:36:54 -0600 (Tue, 27 Dec 2005) | 1 line
Changed paths:
   M /trunk/docbook/custom_layer_pdf.xsl

set admon.graphics.extension to '.png' (the default), so we don't have to search for it in case we need it
------------------------------------------------------------------------
r16899 | jmayer | 2005-12-25 19:42:44 -0600 (Sun, 25 Dec 2005) | 12 lines
Changed paths:
   M /trunk/tools/Makefile.am
   M /trunk/tools/pidl/MANIFEST

Update from samba tree revision 12487 to 12488
============================ Samba log start ============
------------------------------------------------------------------------
r12488 | jelmer | 2005-12-26 02:37:18 +0100 (Mon, 26 Dec 2005) | 2 lines

Fix MANIFEST to match recent changes

------------------------------------------------------------------------
============================ Samba log end ==============

Update Makefile.am accordingly

------------------------------------------------------------------------
r16898 | jmayer | 2005-12-25 19:20:38 -0600 (Sun, 25 Dec 2005) | 3 lines
Changed paths:
   M /trunk/tools/pidl/MANIFEST

Found by buildbot:
Update MANIFEST to fix a bug in the samba tree.

------------------------------------------------------------------------
r16897 | jmayer | 2005-12-25 19:04:48 -0600 (Sun, 25 Dec 2005) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-3com-njack.c

Backup time :-)

- Add packet types: query and query response
- Add  tlv types: snmptrap, coldstarttrap, linkdowntrap, linkuptrap,
  authfailtrap
- Add comments to port settings


------------------------------------------------------------------------
r16896 | jmayer | 2005-12-25 18:47:24 -0600 (Sun, 25 Dec 2005) | 65 lines
Changed paths:
   M /trunk/tools/pidl/TODO
   M /trunk/tools/pidl/idl.yp
   M /trunk/tools/pidl/lib/Parse/Pidl/Ethereal/NDR.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/IDL.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/NDR.pm
   D /trunk/tools/pidl/lib/Parse/Pidl/Samba
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba3/Header.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba3/Parser.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba3/Types.pm
   A /trunk/tools/pidl/lib/Parse/Pidl/Samba4
   A /trunk/tools/pidl/lib/Parse/Pidl/Samba4/COM
   A /trunk/tools/pidl/lib/Parse/Pidl/Samba4/COM/Header.pm
   A /trunk/tools/pidl/lib/Parse/Pidl/Samba4/COM/Proxy.pm
   A /trunk/tools/pidl/lib/Parse/Pidl/Samba4/COM/Stub.pm
   A /trunk/tools/pidl/lib/Parse/Pidl/Samba4/EJS.pm
   A /trunk/tools/pidl/lib/Parse/Pidl/Samba4/EJSHeader.pm
   A /trunk/tools/pidl/lib/Parse/Pidl/Samba4/Header.pm
   A /trunk/tools/pidl/lib/Parse/Pidl/Samba4/NDR
   A /trunk/tools/pidl/lib/Parse/Pidl/Samba4/NDR/Client.pm
   A /trunk/tools/pidl/lib/Parse/Pidl/Samba4/NDR/Parser.pm
   A /trunk/tools/pidl/lib/Parse/Pidl/Samba4/NDR/Server.pm
   A /trunk/tools/pidl/lib/Parse/Pidl/Samba4/SWIG.pm
   A /trunk/tools/pidl/lib/Parse/Pidl/Samba4/TDR.pm
   A /trunk/tools/pidl/lib/Parse/Pidl/Samba4/Template.pm
   D /trunk/tools/pidl/lib/Parse/Pidl/Test.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Util.pm
   M /trunk/tools/pidl/pidl
   A /trunk/tools/pidl/tests/Util.pm
   M /trunk/tools/pidl/tests/ndr_align.pl
   M /trunk/tools/pidl/tests/ndr_alloc.pl
   M /trunk/tools/pidl/tests/ndr_array.pl
   M /trunk/tools/pidl/tests/ndr_refptr.pl
   M /trunk/tools/pidl/tests/ndr_simple.pl
   M /trunk/tools/pidl/tests/ndr_string.pl
   A /trunk/tools/pidl/tests/parse_idl.pl

Update from samba tree revision 12430 to 12487
============================ Samba log start ============
------------------------------------------------------------------------
r12462 | jelmer | 2005-12-24 22:57:51 +0100 (Sat, 24 Dec 2005) | 2 lines

Hide oo magic from callers of the parser

------------------------------------------------------------------------
r12463 | jelmer | 2005-12-24 23:11:44 +0100 (Sat, 24 Dec 2005) | 2 lines

Rename 'Samba' namespace to 'Samba4'

------------------------------------------------------------------------
r12464 | jelmer | 2005-12-25 00:32:50 +0100 (Sun, 25 Dec 2005) | 4 lines

Add simple IDL parsing tests for pidl using the standard perl
testing framework (Test::Simple, distributed with perl itself).
Run these tests from 'make test'

------------------------------------------------------------------------
r12465 | jelmer | 2005-12-25 02:33:35 +0100 (Sun, 25 Dec 2005) | 3 lines

Merge Parse::Pidl::Samba4::NDR::Header into
Parse::Pidl::Samba4::NDR::Parser.
Small optimization to avoid including NDR headers multiple times

------------------------------------------------------------------------
r12470 | jelmer | 2005-12-25 04:04:13 +0100 (Sun, 25 Dec 2005) | 3 lines

Add helper module for pidl tests
Convert other pidl tests to use Test::More and run them from 'make test'

------------------------------------------------------------------------
r12480 | jelmer | 2005-12-25 15:11:59 +0100 (Sun, 25 Dec 2005) | 2 lines

Extend testsuite

------------------------------------------------------------------------
r12481 | jelmer | 2005-12-25 15:59:21 +0100 (Sun, 25 Dec 2005) | 4 lines

Move parser-specific utility functions to idl.yp, remove some unused
functions
Allow the use of non-typedef structs and unions when declaring
variables. Allow the
use of the 'signed' and 'unsigned' qualifiers for integer types

------------------------------------------------------------------------
r12482 | jelmer | 2005-12-25 15:59:39 +0100 (Sun, 25 Dec 2005) | 2 lines

Add some more tests

------------------------------------------------------------------------
r12483 | jelmer | 2005-12-25 16:19:55 +0100 (Sun, 25 Dec 2005) | 2 lines

Remove --tdr-header option (merged into --tdr-parser)

------------------------------------------------------------------------
r12484 | jelmer | 2005-12-25 18:12:52 +0100 (Sun, 25 Dec 2005) | 2 lines

Initial work on supporting non-typedeffed types

------------------------------------------------------------------------
============================ Samba log end ==============


------------------------------------------------------------------------
r16895 | sahlberg | 2005-12-25 06:03:18 -0600 (Sun, 25 Dec 2005) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dns.c
   M /trunk/epan/dissectors/packet-gssapi.c

remove some proto_tree_add_text and replace with proto_tree_add_item()  for the TSIG dissection in dns.

create a new dissector table where MAC algorithms for dns/tsig can be registered.


register gssapi for the algorithm "gss.microsoft.com" since this is what w2k uses when performing dns updates.



------------------------------------------------------------------------
r16894 | sahlberg | 2005-12-25 05:43:47 -0600 (Sun, 25 Dec 2005) | 4 lines
Changed paths:
   M /trunk/asn1/spnego/packet-spnego-template.c
   M /trunk/epan/dissectors/packet-spnego.c

microsoft does not use a confounder for spnego when using DNS/TSIG
they use an additional confounder everywhere else  (as it seems)   but not for DNS/TSIG


------------------------------------------------------------------------
r16893 | sahlberg | 2005-12-24 04:10:04 -0600 (Sat, 24 Dec 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c
   M /trunk/epan/dissectors/packet-smb2.h

from metze

update to tid and uid tracking


------------------------------------------------------------------------
r16892 | jmayer | 2005-12-23 21:13:16 -0600 (Fri, 23 Dec 2005) | 1 line
Changed paths:
   M /trunk/gtk/smb2_stat.c

Foil another of Ronnies attempts to make the repository properties free :-)
------------------------------------------------------------------------
r16891 | sahlberg | 2005-12-23 17:54:35 -0600 (Fri, 23 Dec 2005) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bootp.c

add Jaap K's extensions


also change one (of several:-( )  arrays to be accessed through accessor functions so proper bounds checking is done.


there are many other inbstances of arrays in this dissector that are accessed with no proper bounds checking and the same thing should be done for them




------------------------------------------------------------------------
r16890 | sahlberg | 2005-12-23 15:12:40 -0600 (Fri, 23 Dec 2005) | 12 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cdp.c

from jaap k


Hi list,

On the Ethereal Wiki is a CDP capture of a Broadcom BCM1100 VoIP chipset.
It has a power consumption TLV, which was not yet dissected. The attached
patch does that.




------------------------------------------------------------------------
r16889 | guy | 2005-12-23 04:55:05 -0600 (Fri, 23 Dec 2005) | 5 lines
Changed paths:
   M /trunk/gtk/expert_comp_dlg.c

Clean up indentation.

"error_t" is defined elsewhere on at least some versions of Fedora Core,
so it collides with our usage; use "expert_comp_dlg_t" instead.

------------------------------------------------------------------------
r16888 | sahlberg | 2005-12-23 00:51:58 -0600 (Fri, 23 Dec 2005) | 4 lines
Changed paths:
   M /trunk/epan/libethereal.def

add a symbol to the stupid windows broken shared library bandaid file.



------------------------------------------------------------------------
r16887 | sahlberg | 2005-12-22 22:57:06 -0600 (Thu, 22 Dec 2005) | 4 lines
Changed paths:
   M /trunk/gtk/Makefile.common
   A /trunk/gtk/smb2_stat.c

add service response time statistics for smb2



------------------------------------------------------------------------
r16886 | sahlberg | 2005-12-22 22:55:25 -0600 (Thu, 22 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

make smb2 tappable


------------------------------------------------------------------------
r16885 | sahlberg | 2005-12-22 21:43:56 -0600 (Thu, 22 Dec 2005) | 5 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-kerberos.c
   M /trunk/epan/dissectors/packet-kerberos.h
   M /trunk/epan/dissectors/packet-kpasswd.c

from eric wedel

kpasswd over tcp support


------------------------------------------------------------------------
r16884 | sahlberg | 2005-12-22 17:23:25 -0600 (Thu, 22 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

dunt put ACK number in COL_INFO or in the decode pane if the ACK bit is not set


------------------------------------------------------------------------
r16883 | sahlberg | 2005-12-22 15:28:51 -0600 (Thu, 22 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isakmp.c

add decoding of RFC3947   which should fix bug 513


------------------------------------------------------------------------
r16882 | etxrab | 2005-12-22 10:26:26 -0600 (Thu, 22 Dec 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtcp.c

From Martin Mathieson:
there are only 1000 ms in one second
------------------------------------------------------------------------
r16881 | sahlberg | 2005-12-22 02:51:50 -0600 (Thu, 22 Dec 2005) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-windows-common.c

some ACEs are not used for authorization and thus do NOT contain an access mask and a SID.

make the dissection of the ACL check the type for each individual ACE and only dissect  as access mask and sid  those ACEs we know how to handle.


this prevents ethereal from dumping on w32 if we encounter any of these "special" ACE entries,   such as the ones used for storing location data for offline files.




------------------------------------------------------------------------
r16880 | etxrab | 2005-12-22 01:11:21 -0600 (Thu, 22 Dec 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-skinny.c

Fix Bug 642, use col_set_fence() not to owerwrite column info if several Skinny messages are in one frame.  
------------------------------------------------------------------------
r16879 | jmayer | 2005-12-21 20:37:22 -0600 (Wed, 21 Dec 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bootp.c

As reported by Mark Millet <mmillet@cisco.com>

Add message types 13-17 for option 53 decoding.


------------------------------------------------------------------------
