commit 530d85e072
Author: Gerald Combs <gerald@wireshark.org>
Date:   Thu Oct 11 10:58:36 2018 -0700

    Release prep 2.6.4.
    
    Change-Id: I004614722e0ce1d80e1da402dcf7183c73869d0f

commit dd35b8bab7
Author: Gerald Combs <gerald@wireshark.org>
Date:   Wed Oct 10 14:17:24 2018 -0700

    Update the release notes for 2.6.4.
    
    Change-Id: I133daa5433ee51375cd674d2e3e9b54c7054db2a
    Reviewed-on: https://code.wireshark.org/review/30122
    Reviewed-by: Gerald Combs <gerald@wireshark.org>

commit cfc1111322
Author: Gerald Combs <gerald@wireshark.org>
Date:   Wed Oct 10 08:41:35 2018 -0700

    Autotools: Fix Shellcheck discovery.
    
    Use AC_PATH_PROG to find Shellcheck instead of AC_CHECK_PROG.
    
    Bug: 15165
    Change-Id: I718f71bb60efa64a289e2887a51983e061e3c2d3
    Reviewed-on: https://code.wireshark.org/review/30118
    Petri-Dish: Gerald Combs <gerald@wireshark.org>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Gerald Combs <gerald@wireshark.org>

commit 9ad5b4b6e0
Author: Peter Wu <peter@lekensteyn.nl>
Date:   Sun Aug 12 13:17:29 2018 +0200

    HTTP: ignore large Content-Length values
    
    The SSTP capture from bug 8239 failed to be recognized as SSTP.  Its
    large Content-Length was parsed as -1 which triggered reassembly due to
    tvb_bytes_exist returning FALSE for negative lengths.
    
    Test:
    
        # Expect 'SSTP_DUPLEX_POST /' in the output of:
        tshark -r sstp.pcapng -ossl.keys_list:localhost,443,http,sstp.pem, -Y frame.number==174 -Px
    
    Change-Id: I40afaff8554f34f24e09bab184121ced59045954
    Fixes: v2.9.0rc0-531-gd80acae40d ("tvbuff: make tvb_bytes_exist fail with negative values")
    Reviewed-on: https://code.wireshark.org/review/29109
    Petri-Dish: Peter Wu <peter@lekensteyn.nl>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 4802e3300dc18a973f74990d0d3f96068a7759d1)
    Reviewed-on: https://code.wireshark.org/review/30119
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>

commit b2bbd9fdf2
Author: Peter Wu <peter@lekensteyn.nl>
Date:   Tue Oct 9 19:18:34 2018 +0200

    coap: ensure that piv_len matches piv
    
    In frame 121, piv_len was 1 while piv was NULL. Ensure that both piv and
    piv_len are reset to avoid this. Adjust another check to ensure that piv
    and piv_len are in sync (probably not necessary, but it seems the
    intention).
    
    Bug: 15172
    Change-Id: If8636d32f3273d6707749c807bd7d676ca9ab96d
    Fixes: v2.5.2rc0-9-g830ea5731a ("CoAP: Hooks to OSCORE")
    Reviewed-on: https://code.wireshark.org/review/30100
    Petri-Dish: Peter Wu <peter@lekensteyn.nl>
    Petri-Dish: Gerald Combs <gerald@wireshark.org>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 5a2aafef7a8ad4b3917823133c2e3534951fc4d3)
    Reviewed-on: https://code.wireshark.org/review/30111
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>

commit 7571da4358
Author: Peter Wu <peter@lekensteyn.nl>
Date:   Tue Oct 9 17:14:11 2018 +0200

    ftype-protocol: do not return from TRY/CATCH
    
    TRY/CATCH are macros, before returning the ENDTRY block must be executed
    or the weirdest crashes can occur.
    
    Change-Id: Ic56871322f8567263e2b8a81cce5a3c7042301b7
    Fixes: v2.1.0rc0-2939-g5493fe0167 ("Convert ftype-tvbuff.c to ftype-protocol.c")
    Reviewed-on: https://code.wireshark.org/review/30095
    Petri-Dish: Peter Wu <peter@lekensteyn.nl>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 8c31cdc13c546107235b86cfa9a539c436448f2e)
    Reviewed-on: https://code.wireshark.org/review/30109
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>

commit 6e920ddc3c
Author: Peter Wu <peter@lekensteyn.nl>
Date:   Tue Oct 9 18:16:11 2018 +0200

    steam-ihs: fix memleak on exception
    
    When protobuf_dissect_unknown_field throws an exception,
    steamdiscover_dissect_body_status will leak memory as
    wmem_destroy_allocator is not called. Capture fuzz-2018-10-06-3104.pcap
    from the linked bug leaks 64kiB memory in each frame 14 and 36.
    
    Bug: 15171
    Change-Id: I930d0738fde61799ab4ef2310f8ff11c1bcb032b
    Fixes: v2.5.1rc0-130-g7ae954c7ac ("steam-ihs: Add dissector for the Steam IHS Discovery Protocol")
    Reviewed-on: https://code.wireshark.org/review/30098
    Petri-Dish: Peter Wu <peter@lekensteyn.nl>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit f3986c24728f03a346a10388fd6c15ea9ae16d41)
    Reviewed-on: https://code.wireshark.org/review/30108
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>

commit 73fd53f068
Author: James Ko <jck@exegin.com>
Date:   Thu Oct 4 18:09:28 2018 -0700

    Fix Windows dumpcap -i TCP@
    
    Reading from a TCP socket in Windows must not change read state
    variables to values required by cap_thread_read on pipes.
    
    Bug: 15149
    Change-Id: I1efa9288b5954dc4a18b2c68772c54a098a224e7
    Reviewed-on: https://code.wireshark.org/review/29894
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>
    Petri-Dish: Peter Wu <peter@lekensteyn.nl>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 354c0d4e5f9e988e2f62ee7818456af0bac90cbf)
    Reviewed-on: https://code.wireshark.org/review/30087

commit 6f2c61cef2
Author: Guy Harris <guy@alum.mit.edu>
Date:   Mon Oct 8 12:00:34 2018 -0700

    Get rid of duplicate declaration.
    
    Change-Id: Ief942bab72928ff683d9ee11384e1efe23356f58
    Reviewed-on: https://code.wireshark.org/review/30081
    Reviewed-by: Guy Harris <guy@alum.mit.edu>

commit cb45d1fcb6
Author: Guy Harris <guy@alum.mit.edu>
Date:   Sun Oct 7 21:35:03 2018 -0700

    Make sure we avoid the local code page for command-line arguments.
    
    Do in WinMain() as we do in the Qt main() - fetch the command line with
    GetCommandLineW(), convert it to an argument count and array of UTF-16
    strings with CommandLineToArgvW(), and then convert them to an array of
    UTF-8 strings with arg_list_utf_16to8().
    
    Change-Id: I04bd4182b1ff62573eb132531f4c7f2360f376cc
    Reviewed-on: https://code.wireshark.org/review/30067
    Petri-Dish: Guy Harris <guy@alum.mit.edu>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Guy Harris <guy@alum.mit.edu>

commit 9828b3c5b4
Author: Guy Harris <guy@alum.mit.edu>
Date:   Mon Oct 8 10:35:11 2018 -0700

    No need to check for dladdr in autotools, either, as we're no longer using it.
    
    Get rid of an unnecessary test of HAVE_DLADDR and an unnecessary include
    of <dlfcn.h> while we're at it.
    
    Change-Id: Ie231b49fdb7de182529e0e7b4d785ceee3a8b806
    Reviewed-on: https://code.wireshark.org/review/30078
    Reviewed-by: Guy Harris <guy@alum.mit.edu>

commit 75a3d3b0fd
Author: Guy Harris <guy@alum.mit.edu>
Date:   Sat May 5 00:19:09 2018 -0700

    Don't use dladdr() to get a pathname for the current executable().
    
    Change-Id: I24ad11a659c2cb936f873339dc2b36ac9944280a
    Reviewed-on: https://code.wireshark.org/review/27359
    Petri-Dish: Guy Harris <guy@alum.mit.edu>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit 15cfc41e9441c648caf10483520ba3503f2824a0)
    Reviewed-on: https://code.wireshark.org/review/30076

commit d7d9886fdf
Author: Guy Harris <guy@alum.mit.edu>
Date:   Sun Oct 7 19:04:50 2018 -0700

    Bring back arg_list_utf_16to8(), but have it just do UTF-16-to-UTF-8 mapping.
    
    Call it from wmain() in the command-line tools, passing it the input
    argument count and vector, and call it from main() in Wireshark, after
    getting a UTF-16 argument vector from passing the result of
    GetCommandLineW() to CommandLineToArgvW().
    
    Change-Id: I0e51703c0a6c92f7892d196e700ab437bd702514
    Reviewed-on: https://code.wireshark.org/review/30063
    Petri-Dish: Guy Harris <guy@alum.mit.edu>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit bce13644e9d528a153f87019738a1582c9cae606)
    Reviewed-on: https://code.wireshark.org/review/30064

commit 16e7fe4040
Author: Guy Harris <guy@alum.mit.edu>
Date:   Sun Oct 7 10:06:00 2018 -0700

    Use wsetargv.obj, and wmain() rather than main(), on Windows.
    
    Doing so for command-line programs means that the argument list doesn't
    ever get converted to the local code page; converting to the local code
    page can mangle file names that *can't* be converted to the local code
    page.
    
    Furthermore, code that uses setargv.obj rather than wsetargv.obj has
    issues in some versions of Windows 10; see bug 15151.
    
    That means that converting the argument list to UTF-8 is a bit simpler -
    we don't need to call GetCommandLineW() or CommandLineToArgvW(), we just
    loop over the UTF-16LE argument strings in argv[].
    
    While we're at it, note in Wireshark's main() why we discard argv on
    Windows (Qt does the same "convert-to-the-local-code-page" stuff); that
    means we *do* need to call GetCommandLineW() and CommandLineToArgvW() in
    main() (i.e., we duplicate what Qt's WinMain() does, but converting to
    UTF-8 rather than to the local code page).
    
    Change-Id: I35b57c1b658fb3e9b0c685097afe324e9fe98649
    Ping-Bug: 15151
    Reviewed-on: https://code.wireshark.org/review/30051
    Petri-Dish: Guy Harris <guy@alum.mit.edu>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit a679ae6f791ac6b02f342d3b73d6b4aecb9ca6e9)
    Reviewed-on: https://code.wireshark.org/review/30061

commit b743423e6a
Author: Guy Harris <guy@alum.mit.edu>
Date:   Tue Oct 2 14:06:21 2018 -0700

    You have to add setargv.obj as a link flag, not as a library.
    
    Change-Id: Iab00c28b8fdb5649a115fb7f006ba176d4a4223e
    Reviewed-on: https://code.wireshark.org/review/29986
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit 105f2d68d81416e322152f0edc62ec1434a9d604)
    Reviewed-on: https://code.wireshark.org/review/30059

commit d49e0576dc
Author: Guy Harris <guy@alum.mit.edu>
Date:   Tue Oct 2 13:33:02 2018 -0700

    We should only link executables with setargv.obj.
    
    Libraries shouldn't be linked with it.
    
    See if this fixes the weird problems I'm having with mergecap -
    including, apparently, the mergecap from the buildbots - when run with
    wildcard arguments, terminating before it gets to main() (making it hard
    to try to debug bug 15151).
    
    Change-Id: Ie793b0ea8157186a121106636ac8b782457c09f5
    Reviewed-on: https://code.wireshark.org/review/29985
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit 97972ea9ff4ba1dc485070197486bb5fffedf774)
    Reviewed-on: https://code.wireshark.org/review/30057

commit ce01899863
Author: Gerald Combs <gerald.combs@riverbed.com>
Date:   Sun Oct 7 08:42:37 2018 +0000

    [Automatic update for 2018-10-07]
    
    Update manuf, services enterprise numbers, translations, and other items.
    
    Change-Id: Ib790c47144a4e10c202083dcd04177474b7cbbd3
    Reviewed-on: https://code.wireshark.org/review/30047
    Reviewed-by: Gerald Combs <gerald@wireshark.org>

commit c07a9a0b02
Author: Stig Bjørlykke <stig@bjorlykke.org>
Date:   Fri Oct 5 19:54:59 2018 +0200

    Qt: Call createIOGraph() when duplicating an existing IO Graph
    
    Call createIOGraph() when adding a new graph by duplicating
    an existing to actually create the new graph.
    
    This is a regression from g5b3e3ee5.
    
    Change-Id: If1d8e4386a44dc4867d75fbad2d9ebb2e4b22307
    Reviewed-on: https://code.wireshark.org/review/30036
    Petri-Dish: Stig Bjørlykke <stig@bjorlykke.org>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Anders Broman <a.broman58@gmail.com>

commit f797c7901c
Author: Uli Heilmeier <uh@heilmeier.eu>
Date:   Fri Oct 5 08:54:55 2018 +0200

    *shark: Update help and manpage for name resolving
    
    Add 'v' option for VLAN ID resolving and get rid of
    deprecated 'C' option.
    
    Bug: 14826
    Change-Id: I63104f4a465d251048693ad02882ea7eb2c4d926
    Reviewed-on: https://code.wireshark.org/review/30029
    Petri-Dish: Anders Broman <a.broman58@gmail.com>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    Reviewed-on: https://code.wireshark.org/review/30037
    Reviewed-by: Alexis La Goutte <alexis.lagoutte@gmail.com>

commit f99ea22e77
Author: Guy Harris <guy@alum.mit.edu>
Date:   Thu Oct 4 23:25:01 2018 -0700

    Don't assume we have Qt *at all* when setting HAVE_QT_VERSION_4.
    
    Bug: 15166
    Change-Id: Ic9131ff0d456cc8b546a5a36c97a3c0b1c241fcd
    Reviewed-on: https://code.wireshark.org/review/30026
    Reviewed-by: Guy Harris <guy@alum.mit.edu>

commit 4b3d75cbfb
Author: Jeff Morriss <jeff.morriss.ws@gmail.com>
Date:   Thu Oct 4 10:07:36 2018 -0400

    h248_3gpp: register an ett.
    
    Unregistered etts will lead to an assertion/abort when used.
    
    Change-Id: I2837311fcf472417ba36670e42073d15d475afd6
    Reviewed-on: https://code.wireshark.org/review/30017
    Petri-Dish: Jeff Morriss <jeff.morriss.ws@gmail.com>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 102fb519a7fb9504d3ba27bf15cf10c977fee4a1)
    Reviewed-on: https://code.wireshark.org/review/30020

commit bcacdd2824
Author: Jeff Morriss <jeff.morriss.ws@gmail.com>
Date:   Fri Sep 7 14:10:08 2018 -0400

    Register some unregistered etts.
    
    ... Use of an unregistered ett leads to an abort.
    
    Inspired by I3ee2f557ace1643dfba5a978add66c3c7ba7d895.  Some day I should get
    the ett_ registration checking code in checkAPIs ready for prime time...
    
    Conflicts:
            epan/dissectors/asn1/ngap/packet-ngap-template.c
            epan/dissectors/packet-ieee80211-radiotap.c
            epan/dissectors/packet-ngap.c
    
    Change-Id: I69162d4bcec571e6a517a107ac365aa78bfe8d25
    Reviewed-on: https://code.wireshark.org/review/29474
    Petri-Dish: Jeff Morriss <jeff.morriss.ws@gmail.com>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 98207eb612b024359d3212d0432cb38342741250)
    Reviewed-on: https://code.wireshark.org/review/30016

commit cfb90bbfff
Author: Guy Harris <guy@alum.mit.edu>
Date:   Tue Oct 2 04:20:19 2018 -0700

    Clean up some things.
    
    Rename ascend_seek() to ascend_find_next_packet(), to indicate what it
    does; it doesn't seek to an arbitrary place, it tries to find the
    starting offset of the next packet when reading sequentially.
    
    Don't have it set the header type - that's the job of the parser.
    
    Don't set the "next packet seek start" when doing random access I/O -
    that field is only for sequential I/O, and we don't want random I/O
    happening at the same time (which can happen in Wireshark) interfering.
    
    Clean up comments.
    
    Change-Id: I2808479eeec074afa16945ffb577b91d8cb356f7
    Reviewed-on: https://code.wireshark.org/review/29975
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit 5076c1c02ef3b2fa8fb0ce2405629aab3ff7fa3c)
    Reviewed-on: https://code.wireshark.org/review/29976

commit f15bf6afb8
Author: Guy Harris <guy@alum.mit.edu>
Date:   Tue Oct 2 04:03:28 2018 -0700

    Don't return TRUE with *err or *err_info set.
    
    Read and seek-read routines shouldn't do that; it causes TShark to
    report an error when there was no error.
    
    Change-Id: If564348fa01dce83c6a2317ac56ac8716d514bf7
    Reviewed-on: https://code.wireshark.org/review/29972
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit c8bf7f47cd51ee49e8d53877b3900f5cff200d11)
    Reviewed-on: https://code.wireshark.org/review/29973

commit 384e06de65
Author: Peter Wu <peter@lekensteyn.nl>
Date:   Tue Oct 2 00:00:16 2018 +0200

    TLS: fix reassembly regression when extending a PDU
    
    The fragment identifier was changed, but fragment_set_partial_reassembly
    was left unchanged which broke reassembly/decryption when a subdissector
    finishes reassembly, but then requests further reassembly (like HTTP
    with chunked encoding). This bug results in a faulty "Reassembly error,
    protocol TLS: New fragment past old data limits" message.
    
    Bug: 15158
    Change-Id: I636ef623dd65c3feb58da29adf7125d8458f038f
    Fixes: v2.9.0rc0-2003-gbe16d87c60 ("TLS: fix broken reassembly with multiple PDUs in the same frame")
    Reviewed-on: https://code.wireshark.org/review/29967
    Petri-Dish: Peter Wu <peter@lekensteyn.nl>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 2263ce4f63f91f58d840c628dccaec6a72a0d6fc)
    Reviewed-on: https://code.wireshark.org/review/29970
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>

commit 2b349e3706
Author: Guy Harris <guy@alum.mit.edu>
Date:   Sun Sep 30 21:23:04 2018 -0700

    Fix handling of some ISDN calls.
    
    There's no guarantee that there will be two digits after PRI-XMIT or
    PRI-RCV; the capture file in bug 3535, for exmaple, has "PRI-XMIT-0/1"
    and "PRI-RCV-0".
    
    Require a minimum of 1, not 2, non-{/(:} characters.  Leave the maximum
    of 20 in place.
    
    Change-Id: Ie8f8f4ff5eb04baf0ee61bf28015e59a1fa43948
    Reviewed-on: https://code.wireshark.org/review/29947
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit d8c1db34969cb5fe6c9ed6d4ff36bdd3ec37ab87)
    Reviewed-on: https://code.wireshark.org/review/29965

commit 5618a81287
Author: Peter Wu <peter@lekensteyn.nl>
Date:   Sun Sep 30 12:07:49 2018 +0200

    ieee80211: fix addresses for ToDS=1|FromDS=1 case
    
    For Data frames with ToDs=1|FromDS=1 and a Frame body containing A-MSDU,
    the Addr3 and Addr4 fields are not Destination/Source addresses (DA/SA),
    but BSSID/BSSID. Use the RA/TA fields for the Hw Dest/Src columns and
    add another BSSID field for Addr4 (should match Addr3, but in theory the
    wire format could have different values).
    
    While at it, fix the A-MSDU case for other cases to match 802.11-2016
    Table 9-26 Address field contents. The "Short A-MSDU" case as used by
    DNG STAs are not handled here though.
    
    Tested against a capture with MSDU frames (all but ToDS=1|FromDS=1) and
    the test case from the linked bug.
    
    Bug: 15144
    Change-Id: Ic832d7cd7b8e05a1408353cb79c07efed0fb19cc
    Reviewed-on: https://code.wireshark.org/review/29935
    Petri-Dish: Peter Wu <peter@lekensteyn.nl>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit b3cbb4faf12691af2cc9127b36889b7593306409)
    Reviewed-on: https://code.wireshark.org/review/29957
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>

commit 703ead5b04
Author: Stig Bjørlykke <stig@bjorlykke.org>
Date:   Mon Oct 1 10:14:19 2018 +0200

    Qt: Set enabled properties in Filter Dialog
    
    Default set enabled property to false for deleteToolButton and
    copyToolButton because no item is selected.
    
    Change-Id: I99bfb572abb9bc38cbf49c6b1fabdeefac4f8d90
    Reviewed-on: https://code.wireshark.org/review/29951
    Reviewed-by: Stig Bjørlykke <stig@bjorlykke.org>
    (cherry picked from commit 6be0abac261ca375dca4aa19c5a90e7f97a1ea8c)
    Reviewed-on: https://code.wireshark.org/review/29952

commit d5a057e2d2
Author: Stig Bjørlykke <stig@bjorlykke.org>
Date:   Mon Oct 1 09:56:49 2018 +0200

    Qt: Set enabled properties in Coloring Rules Dialog
    
    Default set enabled property to false for deleteToolButton and
    copyToolButton because no item is selected.
    
    Change-Id: I6ead2fa17cf1fd5bc165526fb76d104af6d5234d
    Reviewed-on: https://code.wireshark.org/review/29949
    Reviewed-by: Stig Bjørlykke <stig@bjorlykke.org>
    (cherry picked from commit 67f47a9f1c1e2ce4d88cd2ca35de87544d7118b8)
    Reviewed-on: https://code.wireshark.org/review/29950

commit c8583e041e
Author: Guy Harris <guy@alum.mit.edu>
Date:   Sun Sep 30 14:06:37 2018 -0700

    Show the *per-file* encapsulation in the __tostring method.
    
    We use the per-file encapsulation everywhere else; use it there as well.
    
    Change-Id: I3e3df234a9f541a9d90e54a3c0f41b5019e00bb3
    Reviewed-on: https://code.wireshark.org/review/29940
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit d7546532d9c24ebe82627bbb10d4b3cc0fbf9d1e)
    Reviewed-on: https://code.wireshark.org/review/29941

commit 066ab657c4
Author: Gerald Combs <gerald.combs@riverbed.com>
Date:   Sun Sep 30 08:44:49 2018 +0000

    [Automatic update for 2018-09-30]
    
    Update manuf, services enterprise numbers, translations, and other items.
    
    Change-Id: Ibf8f8b06fa1c21b2d5a380e0e45d42687c027126
    Reviewed-on: https://code.wireshark.org/review/29933
    Reviewed-by: Gerald Combs <gerald@wireshark.org>

commit 5c81acc802
Author: Stig Bjørlykke <stig@bjorlykke.org>
Date:   Sat Sep 29 00:00:19 2018 +0200

    Qt: Show "unknown colorfilters" warning when opening the dialog
    
    Show the warning about unknown colorfilters being disabled when
    opening the "Coloring Rules..." dialog to make the user aware of
    this before starting editing the rules.
    
    The user may have corrected the filter and enabled it while having
    the dialog open, and then this warning would be misleading.
    
    Change-Id: Ic7f10495e5561bc2fea413c89cf9ebd187c8f113
    Reviewed-on: https://code.wireshark.org/review/29909
    Petri-Dish: Stig Bjørlykke <stig@bjorlykke.org>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>
    (cherry picked from commit 45be9668223f3b42b45a6e30d67cb2eee94d2c5b)
    Reviewed-on: https://code.wireshark.org/review/29919
    Reviewed-by: Stig Bjørlykke <stig@bjorlykke.org>

commit 85ebd9e4da
Author: Stig Bjørlykke <stig@bjorlykke.org>
Date:   Fri Sep 28 23:45:35 2018 +0200

    prefs: Don't remove unknown coloring rules.
    
    When saving the colorfilters file, keep and disable unknown coloring
    rules instead of removing them. The user may want to correct the syntax.
    
    Change-Id: Ib27612a0601276b6ebbb467d7d253f3f72103d1c
    Reviewed-on: https://code.wireshark.org/review/29908
    Petri-Dish: Stig Bjørlykke <stig@bjorlykke.org>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>
    (cherry picked from commit b0dd361d4899ee6a3fda4ecbcee3d9b197c342be)
    Reviewed-on: https://code.wireshark.org/review/29918
    Reviewed-by: Stig Bjørlykke <stig@bjorlykke.org>

commit 64c63c51fd
Author: Stig Bjørlykke <stig@bjorlykke.org>
Date:   Fri Sep 28 19:47:33 2018 +0200

    prefs: Reset prefs.unknown_colorfilters before reading colorfilters
    
    Reset prefs.unknown_colorfilters in the beginning of read_filters_file()
    to avoid a situation when the preference is set and never cleared.
    This will end up with an error message in UI even when not having
    unknown color filters.
    
    Change-Id: I835dbc2a57f0be6889eb5bce250987dabd796e30
    Reviewed-on: https://code.wireshark.org/review/29904
    Petri-Dish: Stig Bjørlykke <stig@bjorlykke.org>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>
    (cherry picked from commit e804e63d4dc7fcf7893d32cd0c420f1736840aeb)
    Reviewed-on: https://code.wireshark.org/review/29917
    Reviewed-by: Stig Bjørlykke <stig@bjorlykke.org>

commit c3b0bcaed5
Author: moguz <mehmet.oguz.mnz@gmail.com>
Date:   Fri Sep 28 09:44:37 2018 -0700

    PROFINET: ARServerblock is correctly dissected.
    
    ARServerBlock function causes MalformedPacket error.
    Padding in the function is fixed.
    
    Change-Id: I498b1f15abcaab2a0be19096939fae5402747b68
    Reviewed-on: https://code.wireshark.org/review/29899
    Petri-Dish: Anders Broman <a.broman58@gmail.com>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Anders Broman <a.broman58@gmail.com>

commit 9474283818
Author: Peter Wu <peter@lekensteyn.nl>
Date:   Tue Sep 25 15:52:37 2018 +0200

    TLS: fix broken reassembly with multiple PDUs in the same frame
    
    When (1) a frame has multiple TLS application data records and (2) two
    of them request reassembly of a new PDU, then the second fragment would
    be considered conflicting with the first one since the PDUs (MSPs) are
    identified by the frame number of the starting frame.
    
    This behavior was observed in a firefox-http2-frag.pcap
    (attachment 16616) which uses tcp_dissect_pdus to trigger reassembly:
    
        Frame 19: 8694 bytes on wire (69552 bits), 8694 bytes captured (69552 bits)
        ...
        Transport Layer Security            (8640 bytes)
            TLSv1.3 Record Layer: Application Data Protocol: http2
            SSL segment data (1369 bytes)   <-- 7/7 last segment of previous PDU
            SSL segment data (1203 bytes)   <-- 1/5 first segment of new PDU
            TLSv1.3 Record Layer: Application Data Protocol: http2
            SSL segment data (1369 bytes)   <-- 2/5
            TLSv1.3 Record Layer: Application Data Protocol: http2
            SSL segment data (1369 bytes)   <-- 3/5
            TLSv1.3 Record Layer: Application Data Protocol: http2
            SSL segment data (1369 bytes)   <-- 4/5
            TLSv1.3 Record Layer: Application Data Protocol: http2
            SSL segment data (976 bytes)    <-- 5/5
            TLSv1.3 Record Layer: Application Data Protocol: http2
            SSL segment data (1369 bytes)   <-- 1/? first segment of another PDU
        [5 Reassembled TLS segments (6286 bytes): #19(1203), #19(1369), #19(1369), #19(1369), #19(976)]
        [7 Reassembled TLS segments (8201 bytes): #17(1190), #17(1369), #17(1369), #18(1369), #18(1369), #18(1369), #19(166)]
        HyperText Transfer Protocol 2       (8201 bytes, reassembled PDU)
            Stream: DATA, Stream ID: 17, Length 8192 (partial entity body)
                ...
            (7/7 finishes previous reassembly, see "7 Reassembled TLS segments")
        HyperText Transfer Protocol 2       (1203 bytes, start of new PDU)
        HyperText Transfer Protocol 2       (6286 bytes, reassembled PDU)
            Stream: DATA, Stream ID: 17, Length 6277 (partial entity body)
                ...
            (all fragments are in this frame, see "5 Reassembled TLS segments")
        HyperText Transfer Protocol 2       (1369 bytes, start of another PDU)
        [Reassembly error, protocol SSL: Frame already added in first pass]
    
    TLS records for fragments 1/5 and 1/? both start a new PDU and would
    thus invoke fragment_add with the same identifier. That results in the
    Reassembly error which breaks further decryption. Reduce the probability
    of this issue by mixing in the TLS stream position of the fragment.
    
    Bug: 11173
    Change-Id: I5536f3010b156555f1d7ae6dc98e08c030c8f771
    Reviewed-on: https://code.wireshark.org/review/29871
    Petri-Dish: Peter Wu <peter@lekensteyn.nl>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit be16d87c60ae82eaef60da2bd4ce3597a05c1a30)
    Reviewed-on: https://code.wireshark.org/review/29885
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>

commit 1e9bd90dcf
Author: Guy Harris <guy@alum.mit.edu>
Date:   Wed Sep 26 12:14:27 2018 -0700

    pcapng: Free option_content on error
    
    Change-Id: If95c6858370fdff795f5e568d0300fedb1a611ea
    Reviewed-on: https://code.wireshark.org/review/29874
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit 77693bc6acf6a1682ffc24d9e65e8fab41f13e2e)
    Reviewed-on: https://code.wireshark.org/review/29875

commit a15eecdc10
Author: Stig Bjørlykke <stig@bjorlykke.org>
Date:   Wed Sep 26 20:04:35 2018 +0200

    pcapng: Free option_content on error
    
    Change-Id: I5a406ecf4e495d0224473d01af4144479ceaf9c3
    Reviewed-on: https://code.wireshark.org/review/29863
    Petri-Dish: Stig Bjørlykke <stig@bjorlykke.org>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Stig Bjørlykke <stig@bjorlykke.org>
    (cherry picked from commit 65a422e235bd88859a27626f120a3d3ec478e29d)
    Reviewed-on: https://code.wireshark.org/review/29872
    Reviewed-by: Guy Harris <guy@alum.mit.edu>

commit e0a652cf20
Author: Guy Harris <guy@alum.mit.edu>
Date:   Wed Sep 26 11:54:35 2018 -0700

    Move wtap_encap_requires_phdr() amongs the other switch statement routines.
    
    Keeping them together might increase the likelihood that all of them get
    updated when a new pcap/pcapng link-layer type whose pseudo-header is
    first processed here rather than by a dissector.
    
    Change-Id: Ia6f45c38e9530b7c6a53d006fbc01b3040e9a014
    Reviewed-on: https://code.wireshark.org/review/29868
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit e50e86c97427694812efd5ebada1a2c3bef9cb7c)
    Reviewed-on: https://code.wireshark.org/review/29869

commit b5d51f2383
Author: Guy Harris <guy@alum.mit.edu>
Date:   Tue Sep 25 16:20:00 2018 -0700

    Get rid of unused flag argument.
    
    We always tell pcap_process_pseudo_header() to check to make sure the
    pseudo-header isn't bigger than the captured data; no need for a flag
    argument to tell it to do so.
    
    Change-Id: I8310bb06a390a7f4a7a232ad140ae07955d52da1
    Reviewed-on: https://code.wireshark.org/review/29833
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit f9129721b2e504987484b8def3b56d9eae30b4db)
    Reviewed-on: https://code.wireshark.org/review/29866

commit fc659b6125
Author: Guy Harris <guy@alum.mit.edu>
Date:   Tue Sep 25 17:33:31 2018 -0700

    Only use "libpcap" to refer to the library.
    
    For file formats, say "pcap/pcapng" or "pcap and pcapng" instead; this
    code handles both formats.  Use just "pcap_" in structure types.
    
    Change-Id: I2c0e096855ac3736bbfd72480ed4221b3a2f25d1
    Reviewed-on: https://code.wireshark.org/review/29835
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit 5773f2bbca29b08dc1987478d8d4ee7ee24b7293)
    Reviewed-on: https://code.wireshark.org/review/29861

commit d8f278829f
Author: Guy Harris <guy@alum.mit.edu>
Date:   Wed Sep 26 10:52:25 2018 -0700

    Sort cases in pcap_get_phdr_size(), add a missing one for WTAP_ENCAP_NFC_LLCP.
    
    Sort the cases to match the order in other routines.
    
    That turned up a missing case for WTAP_ENCAP_NFC_LLCP, so add it.
    
    Change-Id: I500731322ae93c6d2efc368f16cf468f589910f3
    Reviewed-on: https://code.wireshark.org/review/29858
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit 0a19ec761d68b4a52a4bbfe994503d3d09dbd245)
    Reviewed-on: https://code.wireshark.org/review/29859

commit f6c23769ff
Author: Uli Heilmeier <uh@heilmeier.eu>
Date:   Tue Sep 25 21:04:12 2018 +0200

    PCP: Add padding for option
    
    RFC 6887 states that options have to be padded to a multiple
    of 4 octets. This commit adds missing padding.
    
    Bug: 14950
    Change-Id: I68a0631ecdd2f30e24e83b1a6e8dfc55856c9c94
    Reviewed-on: https://code.wireshark.org/review/29832
    Reviewed-by: Alexis La Goutte <alexis.lagoutte@gmail.com>
    Petri-Dish: Alexis La Goutte <alexis.lagoutte@gmail.com>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 1768252ef2c0aa7b7b0e728e752bb8422db2d323)
    Reviewed-on: https://code.wireshark.org/review/29845
    Petri-Dish: Anders Broman <a.broman58@gmail.com>

commit 6d998c0003
Author: Guy Harris <guy@alum.mit.edu>
Date:   Tue Sep 25 20:21:25 2018 -0700

    Handle the NFC LLCP pseudo-header when writing.
    
    Write out the pseudo-header.
    
    Change-Id: I7cab959ad9f3240580860cb91649d615fb49784e
    Reviewed-on: https://code.wireshark.org/review/29842
    Reviewed-by: Guy Harris <guy@alum.mit.edu>

commit 57de498494
Author: Gerald Combs <gerald@wireshark.org>
Date:   Mon Sep 24 11:02:11 2018 -0700

    Netmon+Message Analyzer: Fix a couple of lengths.
    
    Set the length of the Network Monitor Event and ETW Ndis protocols to
    that of their respective headers instead of the remaining TVB length.
    
    Add packet-netmon.c and packet-messageanalyzer.c to .editorconfig.
    
    Change-Id: I50c23c63a74190cebf760fa6b374cc1b78c0191e
    Reviewed-on: https://code.wireshark.org/review/29810
    Reviewed-by: Gerald Combs <gerald@wireshark.org>
    Petri-Dish: Gerald Combs <gerald@wireshark.org>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Alexis La Goutte <alexis.lagoutte@gmail.com>
    (cherry picked from commit ab53831abd962d4fc57e58fe3a7cc18c523c543c)
    Reviewed-on: https://code.wireshark.org/review/29827

commit 5f425ea6dd
Author: Gerald Combs <gerald.combs@riverbed.com>
Date:   Sun Sep 23 08:44:22 2018 +0000

    [Automatic update for 2018-09-23]
    
    Update manuf, services enterprise numbers, translations, and other items.
    
    Change-Id: Id877add7e7f22052c556b3d0d44fc5c6795d2abe
    Reviewed-on: https://code.wireshark.org/review/29791
    Reviewed-by: Gerald Combs <gerald@wireshark.org>

commit 334193717b
Author: Roland Knall <roland.knall@br-automation.com>
Date:   Fri Sep 21 14:35:03 2018 +0200

    ProfiNet: Fix order in AssetManagment
    
    According to the current Profinet specification in regard
    to the coding of the AM_DeviceIdentification field, the
    dissection order of DeviceId and VendorId is in the wrong
    order.
    
    Bug: 15140
    Change-Id: I9954619a938db382967104de91e2b905677cc171
    Reviewed-on: https://code.wireshark.org/review/29780
    Petri-Dish: Roland Knall <rknall@gmail.com>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Roland Knall <rknall@gmail.com>
    (cherry picked from commit 59c0a962f6aa414b6342a17e831d639d26ac9a85)
    Reviewed-on: https://code.wireshark.org/review/29781

commit f5f3fdd79f
Author: Guy Harris <guy@alum.mit.edu>
Date:   Thu Sep 20 22:27:22 2018 -0700

    Get rid of unused variable, update a comment.
    
    We no longer use red.libssh.org, so the file number isn't needed any
    more.
    
    Change-Id: I4cc6eb242eac51219742731cfa82a7bfe9fff2c3
    Reviewed-on: https://code.wireshark.org/review/29771
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit b1afc67b9fd4755de8ab5a700f0158fa1c8b447e)
    Reviewed-on: https://code.wireshark.org/review/29772

commit 1acdda22b6
Author: Guy Harris <guy@alum.mit.edu>
Date:   Thu Sep 20 22:20:48 2018 -0700

    Try downloading libssh directly from www.libssh.org.
    
    Downloading from red.libssh.org got "curl: (51) SSL: no alternative
    certificate subject name matches target host name 'red.libssh.org'" on
    my Mojave virtual machine.
    
    Change-Id: Iab8016c4dc5200c80bff3c0cdc776bc922f4dd59
    Reviewed-on: https://code.wireshark.org/review/29768
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit 5a3ace1a25dbaacb721466b97952afae2f530373)
    Reviewed-on: https://code.wireshark.org/review/29769

commit dc81d642a4
Author: Guy Harris <guy@alum.mit.edu>
Date:   Thu Sep 20 21:43:10 2018 -0700

    Update the URLs for GnuPG.
    
    Use HTTP rather than FTP; the FTP server appears no longer to be
    available.
    
    Change-Id: I4446cc48818f419a341880da53db8670170794ae
    Reviewed-on: https://code.wireshark.org/review/29765
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit d2347534dfe4be867c0971409beefb5202b36288)
    Reviewed-on: https://code.wireshark.org/review/29766

commit f7f795194e
Author: Gerald Combs <gerald@wireshark.org>
Date:   Tue Sep 18 17:31:49 2018 -0700

    make-manuf.py: Add response headers.
    
    Add comments containing the resonse headers for the URLs we fetch.
    standards-oui.ieee.org currently returns inconsistent results depending
    on which host you happen to resolve.
    
    Change-Id: I4adba7e51628d0350ba8e091523807ec85009700
    Reviewed-on: https://code.wireshark.org/review/29730
    Reviewed-by: Gerald Combs <gerald@wireshark.org>

commit 4c11ef4edb
Author: Gerald Combs <gerald.combs@riverbed.com>
Date:   Tue Sep 18 21:57:33 2018 +0000

    update-tx: Fix our file list.
    
    LUPDATE_FILES is a string, not an array.
    
    Change-Id: Ibeef6fd45805f82eeff8c26f7110779603d9d30a
    Reviewed-on: https://code.wireshark.org/review/29725
    Reviewed-by: Gerald Combs <gerald@wireshark.org>

commit 186cf94398
Author: Guy Harris <guy@alum.mit.edu>
Date:   Mon Sep 17 15:21:03 2018 -0700

    Make the maximum block size big enough for max-size D-Bus packets.
    
    Change-Id: I352db07084294629160f16f6cf1e07f902a2844f
    Reviewed-on: https://code.wireshark.org/review/29711
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit f057a9dc55a9a171e6dc8dccbd6ba5f6cdcc3833)
    Reviewed-on: https://code.wireshark.org/review/29712

commit d3681c5a6c
Author: Gerald Combs <gerald@wireshark.org>
Date:   Mon Sep 17 11:17:21 2018 -0700

    make-manuf.py: Add back our user agent.
    
    Change-Id: I39c54fa38c791f3244075b03a0045babc4f249ec
    Reviewed-on: https://code.wireshark.org/review/29707
    Reviewed-by: Gerald Combs <gerald@wireshark.org>

commit 4fbc017e80
Author: João Valverde <joao.valverde@tecnico.ulisboa.pt>
Date:   Fri Sep 14 02:06:01 2018 +0100

    CMake: Fix build from tarball under certain conditions
    
    RPM target has a hard dependency on a git checkout. When building
    from a tarbal the cmake step fails on systems with rpmbuild and git
    installed. Make that failure more rare by testing for the presence
    of a .git subfolder, which 99% of the time implies a working git VCS.
    
    Change-Id: I9e035fd0b192ae0e0fbe98599799f19dbf31263d
    Reviewed-on: https://code.wireshark.org/review/29653
    Petri-Dish: João Valverde <j@v6e.pt>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: João Valverde <j@v6e.pt>

commit 05c9c6cadb
Author: Gerald Combs <gerald.combs@riverbed.com>
Date:   Sun Sep 16 08:40:15 2018 +0000

    [Automatic update for 2018-09-16]
    
    Update manuf, services enterprise numbers, translations, and other items.
    
    Change-Id: Iff8ce503b89cef7b9df5659ce3a80ab96824beec
    Reviewed-on: https://code.wireshark.org/review/29680
    Reviewed-by: Gerald Combs <gerald@wireshark.org>

commit cd8c4063b4
Author: Gerald Combs <gerald.combs@riverbed.com>
Date:   Fri Sep 14 17:41:28 2018 +0000

    make-manuf.py: Improve truncation.
    
    If the PyICU module is available, use it to truncate manufacturer
    names by grapheme clusters.
    
    Change-Id: Ib7dcbb126809df496a534f44a47871a1b28dc539
    Reviewed-on: https://code.wireshark.org/review/29661
    Reviewed-by: Gerald Combs <gerald@wireshark.org>

commit fc956747a1
Author: Hannes Mezger <hannes.mezger@ascolab.com>
Date:   Thu Jul 12 18:35:08 2018 +0200

    opcua: prevent opcua dissector crash by limiting nesting depth
    
    The OPC UA types DiagnosticInfo, Variant and ExtensionObject can be
    nested, which can lead to stack overflows when parsing specially
    crafted packets. This is fixed by storing the current nesting depth
    as expert info.
    The corresponding CVE is https://cve.mitre.org/cgi-bin/cvename.cgi?name=2018-12086
    The corresponding security bulletin of the OPC Foundation is https://opcfoundation-onlineapplications.org/faq/SecurityBulletins/OPC_Foundation_Security_Bulletin_CVE-2018-12086.pdf
    
    Change-Id: I5f6da3a3e269f6db1b690b77470ddf60045bcedd
    Reviewed-on: https://code.wireshark.org/review/29645
    Petri-Dish: Anders Broman <a.broman58@gmail.com>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 28a7a79cac425d1b1ecf06e73add41edd2241e49)
    Reviewed-on: https://code.wireshark.org/review/29654

commit 331a57fa74
Author: Uli Heilmeier <uh@heilmeier.eu>
Date:   Sun Sep 9 09:47:56 2018 +0200

    MGCP: Ignore case for command header
    
    Bug: 15008
    Change-Id: Ibfd9bd8d9d93ddac8c5441be9f5e27c3e095c11b
    Reviewed-on: https://code.wireshark.org/review/29502
    Petri-Dish: Alexis La Goutte <alexis.lagoutte@gmail.com>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    Reviewed-on: https://code.wireshark.org/review/29629
    Petri-Dish: Anders Broman <a.broman58@gmail.com>

commit d95f7307af
Author: Dario Lombardo <lomato@gmail.com>
Date:   Wed Aug 1 14:37:22 2018 +0200

    kafka: fix builds without Snappy or LZ4 support
    
    Avoid passing an uninitialized "raw" pointer to "proto_tree_add_item".
    
    Change-Id: Ic7d3542b4aa5650f452aad7ac3b783769cb44eb7
    Reviewed-on: https://code.wireshark.org/review/28922
    Petri-Dish: Peter Wu <peter@lekensteyn.nl>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>
    (cherry picked from commit 9b9a0d0f88b3323d4014aab1308d00fcb9c02bf8)
    Reviewed-on: https://code.wireshark.org/review/29595
    Petri-Dish: Dario Lombardo <lomato@gmail.com>
    Reviewed-by: Dario Lombardo <lomato@gmail.com>

commit 2b64e541df
Author: Tim Cuthbertson <tim@gfxmonk.net>
Date:   Wed Jul 4 15:03:41 2018 +1000

    Kafka: add info when we lack decompression support
    
    Change-Id: I4c1b5d84bd1a6dfa811fd8ffbd576ac8dfd448af
    Reviewed-on: https://code.wireshark.org/review/28749
    Petri-Dish: Anders Broman <a.broman58@gmail.com>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit c9ecb01f368d02f7cb77455296d24c5ba7c50134)
    Reviewed-on: https://code.wireshark.org/review/29564
    Petri-Dish: Dario Lombardo <lomato@gmail.com>

commit 9e2b033ad3
Author: Gerald Combs <gerald@wireshark.org>
Date:   Mon Sep 10 10:23:16 2018 -0700

    Manuf fixups.
    
    Remove some entries from manuf.tmpl that are either redundant or less
    informative that their corresponding IEEE entries. Add a missing '"' to
    make-manuf.py.
    
    Change-Id: Ia69f4529c5fa1b39f1662b94d072c65bd2d969ea
    Reviewed-on: https://code.wireshark.org/review/29569
    Reviewed-by: Gerald Combs <gerald@wireshark.org>

commit 830ea86e91
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Sep 9 09:40:34 2018 -0700

    make-manuf.py: Expand a comment.
    
    Change-Id: I545a63bb4a045ba93d1ad1ee82315315bdbb3c9e
    Reviewed-on: https://code.wireshark.org/review/29508
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit cba7dfb40b629db564be9efb113b3c4d6eda2899)
    Reviewed-on: https://code.wireshark.org/review/29565
    Reviewed-by: Gerald Combs <gerald@wireshark.org>

commit 5d038a11e1
Author: Tim Cuthbertson <tim@gfxmonk.net>
Date:   Sat Jun 30 09:37:39 2018 +1000

    Kafka: add support for additional Produce, Fetch, OffsetCommit and Heartbeat API versions
    
    Change-Id: I5bd41ed299e586b953042683acf2f05c678a7e93
    Reviewed-on: https://code.wireshark.org/review/28748
    Petri-Dish: Alexis La Goutte <alexis.lagoutte@gmail.com>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Evan Huus <eapache@gmail.com>
    (cherry picked from commit 1ec79c84f01aa3faaff3172f49135992ec929686)
    Reviewed-on: https://code.wireshark.org/review/29562
    Petri-Dish: Dario Lombardo <lomato@gmail.com>
    Reviewed-by: Dario Lombardo <lomato@gmail.com>

commit 4a83040662
Author: Joerg Mayer <jmayer@loplof.de>
Date:   Fri Apr 13 17:41:20 2018 +0200

    Check for HAVE_LZ4FRAME_H in the LZ4 detection process and use it
    
    Change-Id: I919621b8c4c809eb181d563251eeb099b767ad82
    Reviewed-on: https://code.wireshark.org/review/26940
    Petri-Dish: Pascal Quantin <pascal.quantin@gmail.com>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Pascal Quantin <pascal.quantin@gmail.com>
    Reviewed-by: Jörg Mayer <jmayer@loplof.de>
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 0d31ec328f2c523cfc4655f1674a5f0eae80923f)
    Reviewed-on: https://code.wireshark.org/review/29555
    Petri-Dish: Dario Lombardo <lomato@gmail.com>
    Reviewed-by: Dario Lombardo <lomato@gmail.com>

commit 01fd752ee3
Author: Peter Wu <peter@lekensteyn.nl>
Date:   Mon Sep 10 15:35:09 2018 +0200

    prefs: pacify checkAPIs by using ws_g_warning
    
    Change-Id: I15ead09ed5b8df33d795d2c6ed75cd911790113b
    Reviewed-on: https://code.wireshark.org/review/29560
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>
    (cherry picked from commit 8f4b0401249c0fdbd8ddbbc6028d253eef9359ae)
    Reviewed-on: https://code.wireshark.org/review/29561

commit 6d21086998
Author: Peter Wu <peter@lekensteyn.nl>
Date:   Mon Sep 10 11:58:19 2018 +0200

    prefs,ui: properly migrate old filter expressions
    
    When legacy filter expressions preferences are present, be sure to
    (1) save the dfilter_buttons file when updating the preferences file and
    (2) save the preferences file after updating the dfilter_buttons file.
    
    Without doing (1), the old buttons will be lost. Without (2), restarting
    Wireshark will result in duplicate buttons. Only write the files if the
    user actually made other changes to avoid breaking profiles by just
    opening Wireshark.
    
    Bug: 15114
    Bug: 15121
    Change-Id: I5b9417c34146c4450526781a20308c9c98fb44a1
    Reviewed-on: https://code.wireshark.org/review/29488
    Reviewed-by: Stig Bjørlykke <stig@bjorlykke.org>
    Petri-Dish: Stig Bjørlykke <stig@bjorlykke.org>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>
    (cherry picked from commit ad0de0ffbc9ed9e397d09e1398555d06d29439d2)
     [Peter: reapplied changes to ui/qt/main_window_slots.cpp since
      ui/qt/widgets/filter_expression_toolbar.cpp is missing in 2.6 and
      applied a similar change for GTK+ as well]
    Reviewed-on: https://code.wireshark.org/review/29548
    Petri-Dish: Peter Wu <peter@lekensteyn.nl>

commit 9bd645bbbc
Author: Michał Łabędzki <michal.labedzki@wireshark.org>
Date:   Sun May 20 10:24:59 2018 +0200

    Do not use #if* in struct
    
    Do not assume that somebody always includes "config.h" with "epan/prefs.h",
    because I do not include that one and I notice a lot of bugs, like:
    in one file sizeof(prefs) is 538 but in another is 544...
    and of course preferences do not work as expected - order of fields
    in the struct was changed. Try to avoid #if in struct.
    
    Remove dependency of config.h for prefs by removing #ifs, because all prefs
    should be registered also if not used.
    
    Change-Id: I02f71d2e64acf3e0f90c802b1610cc4620727051
    Reviewed-on: https://code.wireshark.org/review/27654
    Petri-Dish: Michal Labedzki <michal.labedzki@wireshark.org>
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit bded74eb669a5d1789c2ea876e0044db17fe61e2)
    Reviewed-on: https://code.wireshark.org/review/29541
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>

commit adc91410a4
Author: Dario Lombardo <lomato@gmail.com>
Date:   Wed Apr 11 14:37:53 2018 +0200

    kafka: raise the required version to 1.5.0 for lz4_frame.
    
    Change-Id: I25619260572163872915c56bcf242e8ff8190b47
    Reviewed-on: https://code.wireshark.org/review/26890
    Petri-Dish: Dario Lombardo <lomato@gmail.com>
    Tested-by: Petri Dish Buildbot
    Tested-by: Dario Lombardo <lomato@gmail.com>
    Reviewed-by: Martin Mathieson <martin.r.mathieson@googlemail.com>
    Reviewed-by: Dario Lombardo <lomato@gmail.com>
    (cherry picked from commit 0b62dce0054bf8c63a8f96cea2cbf29c6e1721a0)
    Reviewed-on: https://code.wireshark.org/review/29553

commit bed2bc2209
Author: Dario Lombardo <lomato@gmail.com>
Date:   Wed Apr 11 14:37:21 2018 +0200

    kafka: check lz4 version in a single point.
    
    This allows a better check of the required version.
    
    Change-Id: I6c4aab67c73434aff4ad744caa2d0add9ec6225c
    Reviewed-on: https://code.wireshark.org/review/26889
    Petri-Dish: Alexis La Goutte <alexis.lagoutte@gmail.com>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 0c30760c95eb14b8cc79c7ed54c9a066388c1588)
    Reviewed-on: https://code.wireshark.org/review/29551
    Petri-Dish: Dario Lombardo <lomato@gmail.com>
    Reviewed-by: Dario Lombardo <lomato@gmail.com>

commit ac50834a5a
Author: Dario Lombardo <lomato@gmail.com>
Date:   Fri Apr 13 08:55:05 2018 +0200

    RPM: restore the bindir in openSUSE before packing.
    
    Change-Id: I6e60d1a299528c0f1603b56704a8c47f18c66d08
    Reviewed-on: https://code.wireshark.org/review/26926
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 9f851c284f86306f8a795646443e8fe070c8a827)
    Reviewed-on: https://code.wireshark.org/review/29547
    Reviewed-by: Dario Lombardo <lomato@gmail.com>

commit 17f44eab06
Author: Dario Lombardo <lomato@gmail.com>
Date:   Thu Apr 12 18:07:00 2018 +0200

    RPM: install wireshark.desktop in /usr/share/applications.
    
    The presence of this file in /usr/share/applications in required by
    suse_update_desktop_file, as described here:
    
    https://en.opensuse.org/openSUSE:Packaging_Conventions_RPM_Macros#.25suse_update_desktop_file
    
    Change-Id: I88573afca2d4523a1b305bf4dc672c421c2fa1d1
    Reviewed-on: https://code.wireshark.org/review/26925
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 5594a9ba67473f4b9ca8d5e34e37e3134fa6362b)
    Reviewed-on: https://code.wireshark.org/review/29546
    Reviewed-by: Dario Lombardo <lomato@gmail.com>

commit 55553db8e2
Author: Dario Lombardo <lomato@gmail.com>
Date:   Thu Apr 12 17:55:22 2018 +0200

    RPM: cd into build dir in openSUSE.
    
    This step is needed because of the differences in the %cmake macro
    between Fedora/Centos and openSUSE.
    
    Change-Id: I7ac94e560b4c298934f78e96036a814f3eadc4a5
    Reviewed-on: https://code.wireshark.org/review/26924
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 63ee1a962e02bcf64123edae9e55b0723f83e3d7)
    Reviewed-on: https://code.wireshark.org/review/29545
    Reviewed-by: Dario Lombardo <lomato@gmail.com>

commit 560b111816
Author: Dario Lombardo <lomato@gmail.com>
Date:   Wed Apr 11 10:45:15 2018 +0200

    RPM: don't give the cmake macro the directory (it has it already).
    
    Change-Id: I1c3febf527f16825793a30eb2ab5d43baaa83a57
    Reviewed-on: https://code.wireshark.org/review/26880
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 643f2eb3469c36af0b64f8889f90a14259e5654f)
    Reviewed-on: https://code.wireshark.org/review/29544
    Reviewed-by: Dario Lombardo <lomato@gmail.com>

commit 97745d8cfc
Author: Dario Lombardo <lomato@gmail.com>
Date:   Wed Apr 11 10:28:17 2018 +0200

    RPM: set the cmake bindir in openSUSE.
    
    Change-Id: I41edf52f8021938877bc53dd5eea4ff29cf4827e
    Reviewed-on: https://code.wireshark.org/review/26878
    Reviewed-by: Alexis La Goutte <alexis.lagoutte@gmail.com>
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit d944dda7af127441cf1b7a9ce94b276131b6325c)
    Reviewed-on: https://code.wireshark.org/review/29543
    Reviewed-by: Dario Lombardo <lomato@gmail.com>

commit 5c72b6e6c2
Author: Dario Lombardo <lomato@gmail.com>
Date:   Wed Apr 11 09:38:59 2018 +0200

    RPM: set ninja executable in %install target.
    
    It is not inherited by previous target.
    
    Change-Id: I11be59211a900375e02fce8c05cc4164b8dc42e4
    Reviewed-on: https://code.wireshark.org/review/26877
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 5f20746a29643f292e6a18c47959fef3e52dfea9)
    Reviewed-on: https://code.wireshark.org/review/29542
    Reviewed-by: Dario Lombardo <lomato@gmail.com>

commit 28efae3f63
Author: Dario Lombardo <lomato@gmail.com>
Date:   Wed Apr 11 10:34:08 2018 +0200

    RPM: fix typo.
    
    Change-Id: I2e82fb0696e2e7cb636ec1fdfb72a566e0eca94f
    Reviewed-on: https://code.wireshark.org/review/26879
    Reviewed-by: Alexis La Goutte <alexis.lagoutte@gmail.com>
    Reviewed-by: Dario Lombardo <lomato@gmail.com>
    (cherry picked from commit 26cd969c09702eb3ed982223e895774608ad8993)
    Reviewed-on: https://code.wireshark.org/review/29540

commit 1a406039ca
Author: Dario Lombardo <lomato@gmail.com>
Date:   Wed Apr 11 08:54:59 2018 +0200

    RPM: don't install doc under guides with make.
    
    Change-Id: Iaa8f3d941dcb329bbfff28f6d9417b92d44371e1
    Reviewed-on: https://code.wireshark.org/review/26876
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit dcc88906a9c58e015d48b78b586185ab77aa061d)
    Reviewed-on: https://code.wireshark.org/review/29539
    Reviewed-by: Dario Lombardo <lomato@gmail.com>

commit 40ee7b580c
Author: Gerald Combs <gerald@wireshark.org>
Date:   Wed Apr 11 09:57:36 2018 +0800

    RPM: Make documentation installation optional.
    
    Add a "guides" bcond so that we can make Asciidoctor and the HTML guide
    installation optional.
    
    Change-Id: I5f9e6cc59689dba7d600cc721547aed020652f00
    Reviewed-on: https://code.wireshark.org/review/26867
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit b8861933094ddd6ec9d366648186efab8a1ab0cb)
    Reviewed-on: https://code.wireshark.org/review/29538
    Reviewed-by: Dario Lombardo <lomato@gmail.com>

commit be7b828f3c
Author: Dario Lombardo <lomato@gmail.com>
Date:   Tue Apr 10 16:11:46 2018 +0200

    RPM: support multiple ninja executables.
    
    Support ninja and ninja-build (Centos7) so far.
    
    Change-Id: I846a0645f24f6cfdc83bd725827d1681a5a1f174
    Reviewed-on: https://code.wireshark.org/review/26856
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 0b7c6f03b0f1c2737a16b68c9f689e373bd83b80)
    Reviewed-on: https://code.wireshark.org/review/29537
    Reviewed-by: Dario Lombardo <lomato@gmail.com>

commit 847d5b9bda
Author: Dario Lombardo <lomato@gmail.com>
Date:   Tue Apr 10 18:12:08 2018 +0200

    RPM: install guides when using make.
    
    Change-Id: I89ca826f39dea3f53b94a87ccc2fbe3f9bb4a2b1
    Reviewed-on: https://code.wireshark.org/review/26861
    Reviewed-by: Alexis La Goutte <alexis.lagoutte@gmail.com>
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 64f75a4ede58afd3941782f30a73243b9d204071)
    Reviewed-on: https://code.wireshark.org/review/29536
    Reviewed-by: Dario Lombardo <lomato@gmail.com>

commit 60460bdab5
Author: Anders <anders.broman@ericsson.com>
Date:   Wed Apr 4 10:00:06 2018 +0200

    CMake RPM build: Try to get rid of %globals in favor of %bcond.
    
    Change-Id: I051fb722b0c4161b373f04a79288faa41a61c3cc
    Reviewed-on: https://code.wireshark.org/review/26735
    Petri-Dish: Anders Broman <a.broman58@gmail.com>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Gerald Combs <gerald@wireshark.org>
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 9e02a0b65b87349814ab6aa9a1df9d6a930d0a3c)
    Reviewed-on: https://code.wireshark.org/review/29535
    Reviewed-by: Dario Lombardo <lomato@gmail.com>

commit af4c4af598
Author: Stig Bjørlykke <stig@bjorlykke.org>
Date:   Sun Sep 9 20:30:54 2018 +0200

    Qt: Restore column visibility when loading packets
    
    Always restore column visibility when loading packets to avoid some
    situations where the column hidden state was incorrect.
    
    This fixes the following scenario:
     - Apply a column and hide it using the column popup menu
     - Apply another column and remove it using the column popup menu
     - Close and reopen the capture file
     - Observe the hidden column is shown, but with wrong width
    
    Change-Id: I00531907b2383c6605a2d62e8243092906037d0c
    Reviewed-on: https://code.wireshark.org/review/29516
    Petri-Dish: Stig Bjørlykke <stig@bjorlykke.org>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Stig Bjørlykke <stig@bjorlykke.org>
    (cherry picked from commit 7468107e1167d9526d6646a0870bf4c5a44ff91b)
    Reviewed-on: https://code.wireshark.org/review/29531

commit 2d4bf81715
Author: Guy Harris <guy@alum.mit.edu>
Date:   Sun Sep 9 13:05:49 2018 -0700

    rpm_setup.sh was renamed to rpm-setup.sh; reflect that.
    
    Change-Id: Ifdc0f30abc65e9a85b6344f5cdfe0d9f07915bc1
    Reviewed-on: https://code.wireshark.org/review/29519
    Reviewed-by: Guy Harris <guy@alum.mit.edu>

commit 536fb9403a
Author: Guy Harris <guy@alum.mit.edu>
Date:   Sun Sep 9 10:45:56 2018 -0700

    Fix handling of invalid type values.
    
    If vType_get_type() returns NULL, that means that the packet is bad, not
    that the dissector is bad.  Report it as such.
    
    Bug: 15119
    Change-Id: I8e66fcece2b526ef9edbf948862f8fc5bea25d74
    Reviewed-on: https://code.wireshark.org/review/29511
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit 69e49ed9926153e2061951f7026f373a0e21b978)
    Reviewed-on: https://code.wireshark.org/review/29513

commit c6c0df1ff8
Author: Gerald Combs <gerald.combs@riverbed.com>
Date:   Sun Sep 9 08:52:26 2018 +0000

    [Automatic update for 2018-09-09]
    
    Update manuf, services enterprise numbers, translations, and other items.
    
    Change-Id: I7c9acbf709a76d3aba663abd5d0aed7bd68fb3ad
    Reviewed-on: https://code.wireshark.org/review/29504
    Reviewed-by: Gerald Combs <gerald@wireshark.org>

commit 7675c2fea1
Author: Guy Harris <guy@alum.mit.edu>
Date:   Sat Sep 8 12:47:14 2018 -0700

    Don't use on-the-stack buffers for pinfo addresses.
    
    pinfo addresses are supposed to be valid after the routine that sets
    them exits; therefore, the data mustn't be on the stack.
    
    Change-Id: I7db48065b2cacad200fa6b18e19b68e130e535a5
    Reviewed-on: https://code.wireshark.org/review/29492
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit 30cc32e379ad2edf04cb5fd659e3b9246cdc5464)
    Reviewed-on: https://code.wireshark.org/review/29493

commit 6deb4c9a6b
Author: Gerald Combs <gerald@wireshark.org>
Date:   Fri Sep 7 16:26:04 2018 -0700

    Add make-manuf.py to dist.
    
    Change-Id: I6b1dbdae4d91fca546f5fdd4523640963366a3ac
    Reviewed-on: https://code.wireshark.org/review/29481
    Reviewed-by: Gerald Combs <gerald@wireshark.org>

commit 32f8971a05
Author: Gerald Combs <gerald@wireshark.org>
Date:   Fri Sep 7 10:21:14 2018 -0700

    make-manuf.py: Skip the title row of each .csv file.
    
    Change-Id: I88a4b3da6b75d4891dc3b3e5b8ceb1233e038932
    Reviewed-on: https://code.wireshark.org/review/29470
    Reviewed-by: Gerald Combs <gerald@wireshark.org>
    (cherry picked from commit 83239cd745c0aafa9beacc093649bff3ef069b60)
    Reviewed-on: https://code.wireshark.org/review/29471

commit 9d61d410c6
Author: Gerald Combs <gerald@wireshark.org>
Date:   Wed Sep 5 09:46:27 2018 -0700

    Migrate make-manuf to Python+CSV.
    
    The download links offered by the IEEE at
    https://standards.ieee.org/products-services/regauth/ are CSV files.
    Updating the Perl version to support CSV would have required rewriting a
    significant portion of the script along with either adding a dependency
    on Text::CSV or writing our own CSV parser.
    
    Migrate it to Python, which has a built-in CSV module.
    
    Change-Id: I39ba0ec873145f44374ab9f751e8bde51535ca4d
    Reviewed-on: https://code.wireshark.org/review/29442
    Reviewed-by: Gerald Combs <gerald@wireshark.org>
    Petri-Dish: Gerald Combs <gerald@wireshark.org>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit a1fac65d8e9135014ff8cb9dfe9841e8b8267efb)
    Reviewed-on: https://code.wireshark.org/review/29467

commit b407f7a945
Author: Peter Wu <peter@lekensteyn.nl>
Date:   Thu Sep 6 15:27:58 2018 +0200

    wslua: fix source argument in debug info for luacov
    
    The source argument should start with a '@', otherwise it is treated as
    actual source code instead of a filename. This is needed for luacov. See
    https://www.lua.org/manual/5.2/manual.html#lua_Debug
    https://github.com/keplerproject/luacov/issues/55
    
    Change-Id: I0a3e2da65fb6b4aaabb9173a07fdea18a788f3e3
    Reviewed-on: https://code.wireshark.org/review/29447
    Petri-Dish: Peter Wu <peter@lekensteyn.nl>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 46e71f9a7c17e6aec5dd9d7c5829ac8bc684d90e)
    Reviewed-on: https://code.wireshark.org/review/29464
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>

commit 4f49cb4010
Author: Martin Boye Petersen <martinboyepetersen@gmail.com>
Date:   Fri Sep 7 09:29:39 2018 +0200

    Qt: Add null check for finfo and hfinfo
    
    Adding the null check fixes a bug that made wireshark crash
    when right clicking a subtree which doesn't have any preferences
    and if none of the parents had one either.
    
    The problem was introduced in commit 589413d8772f1450be9bd4a2550cb99a95f71299
    
    Change-Id: Ia5bbae0a58298f3e9d912e44f33589da1cbfacc9
    Reviewed-on: https://code.wireshark.org/review/29455
    Petri-Dish: Stig Bjørlykke <stig@bjorlykke.org>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Stig Bjørlykke <stig@bjorlykke.org>
    (cherry picked from commit 3aa7e61b17a39be4ec0674f9933a07172df0e712)
    Reviewed-on: https://code.wireshark.org/review/29461

commit bd4759b65f
Author: Pascal Quantin <pascal.quantin@gmail.com>
Date:   Fri Sep 7 09:38:34 2018 +0200

    PER: fix dissection of enumerated type with a single extension value
    
    Per X.691 chapter 14.3, a enumerated type with extension marcker should
    always be encoded as a normally small non-negative whole number.
    
    Change-Id: Ice070a932792ba1654674c68157ff4b6b0942f90
    Reviewed-on: https://code.wireshark.org/review/29454
    Reviewed-by: Pascal Quantin <pascal.quantin@gmail.com>
    Petri-Dish: Pascal Quantin <pascal.quantin@gmail.com>
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit e4ff3e657a8abfad75041cb9e6d750ca42764af0)
    Reviewed-on: https://code.wireshark.org/review/29457

commit b1bcb620a3
Author: Martin Kaiser <wireshark@kaiser.cx>
Date:   Sun Sep 2 14:43:40 2018 +0200

    make IPv4 and IPv6 name resolution usable at all times
    
    IPv4 and v6 name resolution are bound to a capture file. Using a lua
    script, it is possible to trigger a name resolution when no capture file
    is open. This crashes Wireshark as the hash tables for name resolution
    are not initialized at this time.
    
    martin@reykholt:~/src/wireshark.git/build$ echo "print(Address.ip(\"1.1.1.1\"))" > bla.lua
    martin@reykholt:~/src/wireshark.git/build$ ./run/tshark -Xlua_script:bla.lua
    Segmentation fault
    
    martin@reykholt:~/src/wireshark.git/build$ echo "print(Address.ipv6(\"::1\"))" > bla6.lua
    martin@reykholt:~/src/wireshark.git/build$ ./run/tshark -Xlua_script:bla6.lua
    Segmentation fault
    
    Make sure that the hash tables are available as long as the epan library
    is initialized. Add a new function host_name_lookup_reset(), call this
    function every time we set up dissection for a new capture file. This
    way, we keep the name resolution results separate per capture file.
    
    Reorder the steps in init_dissection(). Host name lookup is now
    available at all times, there's no need to be in file scope when it's
    initialized.
    
    Change-Id: I9599100d5f378b6a0f73dc630e4c8af3b3ffb2cc
    Reviewed-on: https://code.wireshark.org/review/29398
    Reviewed-by: Martin Kaiser <wireshark@kaiser.cx>
    Petri-Dish: Martin Kaiser <wireshark@kaiser.cx>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 8681e1deba5fc03146125f33722d2094afd02b7f)
    Reviewed-on: https://code.wireshark.org/review/29444

commit 496f17da01
Author: Uli Heilmeier <uh@heilmeier.eu>
Date:   Wed Sep 5 01:12:46 2018 +0200

    Radius: Fix offset for multiple VSA in one AVP
    
    When there are multiple VSAs in one AVP we should forward the vendor_offset.
    The length field includes the type field therefore we have to subtract it.
    
    Bug: 15073
    Change-Id: If365ebca493208d67b3283fe876d2d1b0bda64af
    Reviewed-on: https://code.wireshark.org/review/29421
    Petri-Dish: Alexis La Goutte <alexis.lagoutte@gmail.com>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Alexis La Goutte <alexis.lagoutte@gmail.com>
    (cherry picked from commit 8122d1402a043bf34e267920e3b3a985d65f5fa5)
    Reviewed-on: https://code.wireshark.org/review/29423
    Reviewed-by: Anders Broman <a.broman58@gmail.com>

commit c7a30c344d
Author: Gerald Combs <gerald@wireshark.org>
Date:   Tue Sep 4 13:03:48 2018 -0700

    Update tools help using a script.
    
    Update docbook/wsug_src/*.txt using tools/update-tools-help.py. This
    removes a lot of unwanted behavior that came with updating via a CMake
    target.
    
    Conflicts:
            CMakeLists.txt
            docbook/CMakeLists.txt
    
    Change-Id: I0a24f425e9673ef7bd074210d7047654c6755e79
    Reviewed-on: https://code.wireshark.org/review/29416
    Reviewed-by: Gerald Combs <gerald@wireshark.org>
    (cherry picked from commit c15ada34b17b614230194ba8f22dad76b51c30fa)
    Reviewed-on: https://code.wireshark.org/review/29431
    Petri-Dish: Gerald Combs <gerald@wireshark.org>
    Tested-by: Petri Dish Buildbot

commit 2c91551f31
Author: Pascal Quantin <pascal.quantin@gmail.com>
Date:   Wed Sep 5 13:20:43 2018 +0200

    tvbuff_subset.c: handle a reported_length set to -1 in tvb_new_subset_length()
    
    According to tvbuff.h, tvb_new_subset_length() should behave like
    tvb_new_subet_caplen(). Let's do so.
    
    Bug: 15112
    Change-Id: I3f05ff45246ac0d05e9bc7bd069ec864da1afae6
    Reviewed-on: https://code.wireshark.org/review/29426
    Reviewed-by: Pascal Quantin <pascal.quantin@gmail.com>
    Petri-Dish: Pascal Quantin <pascal.quantin@gmail.com>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit b40beb9edfc5c09bb2374e2382871a7fc8825858)
    Conflicts:
            epan/tvbuff_subset.c
    Reviewed-on: https://code.wireshark.org/review/29439

commit 10c867b6ed
Author: Stig Bjørlykke <stig@bjorlykke.org>
Date:   Wed Sep 5 19:20:57 2018 +0200

    prefs: Improve check for visible custom columns
    
    Add a check for the resolved setting when searching for hidden columns
    in prefs_is_column_visible(). This allows hiding one of two equal custom
    columns where the only difference is the resolved setting.
    
    Change-Id: Iafb4ffa7bf258948fbe973e038bbeb26d6e8d2e3
    Reviewed-on: https://code.wireshark.org/review/29433
    Petri-Dish: Stig Bjørlykke <stig@bjorlykke.org>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Stig Bjørlykke <stig@bjorlykke.org>
    (cherry picked from commit 2f297457af98a03842f751184ce6d5d3c017e785)
    Reviewed-on: https://code.wireshark.org/review/29434

commit 28f956ca28
Author: Stig Bjørlykke <stig@bjorlykke.org>
Date:   Wed Sep 5 14:20:14 2018 +0200

    proto: Reset handled occurrences counter
    
    Reset handled occurrences counter between each multi field custom
    column to be able to handle configurations with occurrence set.
    
    Change-Id: Iaa01da069b661ddbb2871370fcc9f9fde33041bb
    Reviewed-on: https://code.wireshark.org/review/29427
    Petri-Dish: Stig Bjørlykke <stig@bjorlykke.org>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Stig Bjørlykke <stig@bjorlykke.org>
    (cherry picked from commit f3a1c2e76a33855d8fdd71958e5be8d764ac4a68)
    Reviewed-on: https://code.wireshark.org/review/29429

commit 94d56a8002
Author: Dario Lombardo <lomato@gmail.com>
Date:   Tue Sep 4 14:35:14 2018 +0200

    tools: align rpm-setup.sh to master.
    
    Manual merge of commits (from master):
    f23a934492 (Guy Harris) Don't install autotools or GTK+, but do install CMake.
    d431863e70 (Dario Lombardo) tools: add ninja to debian/rpm additional packages.
    3dce4ea3d3 (Dario Lombardo) tools: add missing optional packages in debian/rpm setup.
    338604ad9e (Dario Lombardo) tools: rename rpm_setup.sh to reflect other similar scripts.
    ba3dfd5f4b (Jeff Morriss) Fix rpm-setup.sh so it works when you're not installing the optional pkgs.
    63c62a2212 (Dario Lombardo) tools: update rpm-setup.
    e2ada3e687 (Dario Lombardo) rpm-setup: add support for opensuse non-interactive mode.
    2b1741ecd0 (Dario Lombardo) rpm-setup: add rpmbuild package.
    
    Change-Id: Ia5de1dca7869082da0caccf25850ab4554c40857
    Reviewed-on: https://code.wireshark.org/review/29412
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>
    Reviewed-by: Dario Lombardo <lomato@gmail.com>

commit 26db56558d
Author: Stig Bjørlykke <stig@bjorlykke.org>
Date:   Sat Sep 1 13:15:12 2018 +0200

    Qt: Avoid crash for ByteViewTab with 0 bytes
    
    A ByteViewTab with 0 bytes is not useful, but may happen.
    The crash could be reproduced with the following Lua code:
    
      local t = ByteArray.new():tvb()
    
    Change-Id: I256fd7fc2b91aa3c1161c46558c647308a3d564b
    Reviewed-on: https://code.wireshark.org/review/29383
    Petri-Dish: Stig Bjørlykke <stig@bjorlykke.org>
    Reviewed-by: Stig Bjørlykke <stig@bjorlykke.org>
    (cherry picked from commit cb002c597a4e4635b1743cb178301dc46b7d01de)
    Reviewed-on: https://code.wireshark.org/review/29399

commit 66d05f91a4
Author: Gerald Combs <gerald.combs@riverbed.com>
Date:   Sun Sep 2 08:41:34 2018 +0000

    [Automatic update for 2018-09-02]
    
    Update manuf, services enterprise numbers, translations, and other items.
    
    Change-Id: I6281c679131606d8a4f49bbb030a6ba9c31dc563
    Reviewed-on: https://code.wireshark.org/review/29393
    Reviewed-by: Gerald Combs <gerald@wireshark.org>

commit 47779b0bb0
Author: Stig Bjørlykke <stig@bjorlykke.org>
Date:   Fri Aug 31 20:01:05 2018 +0200

    Qt: Improve fetching preferences from the packet list.
    
    The Lua fake item will not give preferences for the last protocol
    in the packet, so avoid this. The Lua fake item is always added when
    having a Lua post-dissector, even if the post-dissector does not add
    any elements to the tree.
    
    Change-Id: I43427bf522a32feebd44f192888e73b5607e6fff
    Reviewed-on: https://code.wireshark.org/review/29377
    Petri-Dish: Stig Bjørlykke <stig@bjorlykke.org>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Stig Bjørlykke <stig@bjorlykke.org>
    (cherry picked from commit f61cb129a96a2c094a9d85e98894f1f86896cccb)
    Reviewed-on: https://code.wireshark.org/review/29384

commit 4fc32c9eef
Author: Stig Bjørlykke <stig@bjorlykke.org>
Date:   Fri Aug 31 09:28:04 2018 +0200

    Qt: Improve fetching preferences from a tree item.
    
    The special-case "text only" header field will not give preferences for the
    selected protocol, so we have to traverse the parents to get a usable node.
    
    Change-Id: I647f275839db337dedaeb67664402af1fe9f21c1
    Reviewed-on: https://code.wireshark.org/review/29363
    Petri-Dish: Stig Bjørlykke <stig@bjorlykke.org>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 589413d8772f1450be9bd4a2550cb99a95f71299)
    Reviewed-on: https://code.wireshark.org/review/29374
    Reviewed-by: Stig Bjørlykke <stig@bjorlykke.org>

commit c2a07cdfc6
Author: Dario Lombardo <lomato@gmail.com>
Date:   Tue Apr 24 12:26:47 2018 +0200

    tools: make rpm and debian setup scripts more similar.
    
    Change-Id: Ie46d56aff91694a3b8c4c62b4b03e38d3fb1e68a
    Reviewed-on: https://code.wireshark.org/review/27116
    Reviewed-by: Alexis La Goutte <alexis.lagoutte@gmail.com>
    (cherry picked from commit 0202bc995b8966399f3d3ba29f82579b1500e594)
    Reviewed-on: https://code.wireshark.org/review/29373
    Reviewed-by: Dario Lombardo <lomato@gmail.com>

commit cdaf2750e6
Author: Dario Lombardo <lomato@gmail.com>
Date:   Tue Apr 10 18:11:41 2018 +0200

    tools: add openSUSE asciidoctor to rpm_setup.sh.
    
    Change-Id: I939110047739ac9b7a5c6984a84351d4fdfbf556
    Reviewed-on: https://code.wireshark.org/review/26860
    Reviewed-by: Alexis La Goutte <alexis.lagoutte@gmail.com>
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit afbdd66fc23b58ec5e8b7ff61a101510aa84dfd7)
    Reviewed-on: https://code.wireshark.org/review/29372
    Reviewed-by: Dario Lombardo <lomato@gmail.com>

commit 193b15b7cc
Author: Dario Lombardo <lomato@gmail.com>
Date:   Tue Aug 28 13:28:48 2018 +0200

    gitlab-ci: update apt list files.
    
    Change-Id: I7a9dfec200d64c327e1d12bb691a310295a8c1ff
    Reviewed-on: https://code.wireshark.org/review/29316
    Tested-by: Dario Lombardo <lomato@gmail.com>
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>
    Reviewed-by: Dario Lombardo <lomato@gmail.com>
    (cherry picked from commit 67a73b4152a0a447ce0f734f658635af9f1531bc)
    Reviewed-on: https://code.wireshark.org/review/29371

commit 264f664802
Author: Dario Lombardo <lomato@gmail.com>
Date:   Sun Jun 17 23:01:01 2018 +0200

    gitlab-ci: add fedora build.
    
    Change-Id: Ie5e49a4eb35dac2793ac3d8be8ba87d663ff359b
    Reviewed-on: https://code.wireshark.org/review/28322
    Reviewed-by: Alexis La Goutte <alexis.lagoutte@gmail.com>
    Reviewed-by: Dario Lombardo <lomato@gmail.com>
    (cherry picked from commit 92841d5eecd2ba9e9cde8fbd405d3ec4611b5e82)
    Reviewed-on: https://code.wireshark.org/review/29370

commit 9d89eb7f9b
Author: Dario Lombardo <lomato@gmail.com>
Date:   Fri Jun 8 13:53:24 2018 +0200

    gitlab-ci: add opensuse build.
    
    Create RPM as well.
    
    Change-Id: Id84df19c6fa27eb576d29884299f771224328dba
    Reviewed-on: https://code.wireshark.org/review/28122
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 1aff175b1c8c613b709ae27b8e40e7aa43508502)
    Reviewed-on: https://code.wireshark.org/review/29369
    Reviewed-by: Dario Lombardo <lomato@gmail.com>

commit 241ea086e7
Author: Dario Lombardo <lomato@gmail.com>
Date:   Fri Jun 8 11:49:50 2018 +0200

    gitlab-ci: add centos build.
    
    Create RPM as well.
    
    Change-Id: Iaedbd0fbe2b7c00f07ea833aef261351c78b6985
    Reviewed-on: https://code.wireshark.org/review/28113
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit edcad2c3f5c68e16791a472c15de9b1fd41f59d8)
    Reviewed-on: https://code.wireshark.org/review/29368
    Reviewed-by: Dario Lombardo <lomato@gmail.com>

commit 3b16c8a431
Author: Dario Lombardo <lomato@gmail.com>
Date:   Fri Jun 8 11:32:29 2018 +0200

    gitlab-ci: add tshark --version test after all jobs.
    
    Change-Id: I7d82587b26dd1636c437fc07934f5ca941ab052c
    Reviewed-on: https://code.wireshark.org/review/28108
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit df1b07cc62ccd1faa6c25aff07d1e40985b889e4)
    Reviewed-on: https://code.wireshark.org/review/29367
    Reviewed-by: Dario Lombardo <lomato@gmail.com>

commit 52897ccf49
Author: Dario Lombardo <lomato@gmail.com>
Date:   Fri Jun 8 10:36:16 2018 +0200

    gitlab-ci: make ubuntu steps a module.
    
    This will make room for more modules to be used by new jobs.
    
    Change-Id: I0dff41d18c8027cb4d929acf5ab808a64f0277a4
    Reviewed-on: https://code.wireshark.org/review/28107
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit e088fcd84cfd02387bbe5cc2e2cf387cb2be8589)
    Reviewed-on: https://code.wireshark.org/review/29366
    Reviewed-by: Dario Lombardo <lomato@gmail.com>

commit 6337050ee6
Author: Dario Lombardo <lomato@gmail.com>
Date:   Thu May 3 12:46:06 2018 +0200

    gitlab-ci: add gcc-8 and use it for nopcap build.
    
    Change-Id: If7c17202f45ea0832596d5a87154b9ea333a5296
    Reviewed-on: https://code.wireshark.org/review/27303
    Reviewed-by: Alexis La Goutte <alexis.lagoutte@gmail.com>
    Reviewed-by: Dario Lombardo <lomato@gmail.com>
    (cherry picked from commit 869180ce7d3b84f8d23d2bdeb937a71458da47ea)
    Reviewed-on: https://code.wireshark.org/review/29365

commit a96c713e3e
Author: Pascal Quantin <pascal.quantin@gmail.com>
Date:   Thu Aug 30 15:11:57 2018 +0200

    DPLAY: fix heuristic check
    
    Regression introduced in 9c3be9d5
    
    Bug: 15092
    Change-Id: If52b1dfe05c8093d93ef6ed52cd38f3b2263e9e3
    Reviewed-on: https://code.wireshark.org/review/29351
    Reviewed-by: Pascal Quantin <pascal.quantin@gmail.com>
    Petri-Dish: Pascal Quantin <pascal.quantin@gmail.com>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 942bb3ea7c4342978ad3cbfe73fb9ca0c460d587)
    Reviewed-on: https://code.wireshark.org/review/29352

commit b4389fdad6
Author: Peter Wu <peter@lekensteyn.nl>
Date:   Mon Aug 27 14:16:00 2018 +0200

    CMake: fix dmg_package target since CMake 3.12
    
    The Resources directory was removed a while back. Since CMake 3.12, the
    copy_directory command will fail when the source directory is missing.
    Reported by anta_tw in the #wireshark IRC channel at Freenode.
    
    Change-Id: I4de087dd2833e79a806c8a0c9a28024848e1e03f
    Fixes: v2.1.0rc0-2347-g4aa049019a ("OS X: Remove GTK+ packaging.")
    Reviewed-on: https://code.wireshark.org/review/29304
    Petri-Dish: Peter Wu <peter@lekensteyn.nl>
    Tested-by: Petri Dish Buildbot
    Reviewed-by: Gerald Combs <gerald@wireshark.org>
    (cherry picked from commit b55c20a1b1b798fdfbc48cb622ae9ca772ecb4f1)
    Reviewed-on: https://code.wireshark.org/review/29347
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>

commit 21c4e2216e
Author: Gerald Combs <gerald@wireshark.org>
Date:   Wed Aug 29 12:19:18 2018 -0700

    2.6.3 → 2.6.4.
    
    Change-Id: I090a7b3a86a0adc4f302b2ff7eab8c5c0f6b54c4
    Reviewed-on: https://code.wireshark.org/review/29339
    Reviewed-by: Gerald Combs <gerald@wireshark.org>
