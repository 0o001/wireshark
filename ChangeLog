------------------------------------------------------------------------
r28739 | gerald | 2009-06-15 08:24:40 -0700 (Mon, 15 Jun 2009) | 12 lines
Changed paths:
   M /trunk-1.2/wiretap/pcapng.c

One last fix for the release.

------------------------------------------------------------------------
r28736 | tuexen | 2009-06-15 05:55:42 -0700 (Mon, 15 Jun 2009) | 3 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

Fix bug reported by Stig: per packet encapsulation for
pcapng is supported.
------------------------------------------------------------------------


------------------------------------------------------------------------
r28741 | gerald | 2009-06-15 09:45:57 -0700 (Mon, 15 Jun 2009) | 15 lines
Changed paths:
   M /trunk-1.2/capture_sync.c
   M /trunk-1.2/epan/prefs.c
   M /trunk-1.2/epan/prefs.h
   M /trunk-1.2/gtk/capture_dlg.c
   M /trunk-1.2/gtk/main.c
   M /trunk-1.2/gtk/prefs_capture.c

Copy over one more time from the trunk.

------------------------------------------------------------------------
r28740 | stig | 2009-06-15 09:36:02 -0700 (Mon, 15 Jun 2009) | 2 lines
Changed paths:
   M /trunk/capture_sync.c
   M /trunk/epan/prefs.c
   M /trunk/epan/prefs.h
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/main.c
   M /trunk/gtk/prefs_capture.c

Added a preference to capture in Pcap-NG from GUI.
------------------------------------------------------------------------

------------------------------------------------------------------------
r28743 | gerald | 2009-06-15 10:03:03 -0700 (Mon, 15 Jun 2009) | 11 lines
Changed paths:
   M /trunk-1.2/doc/README.developer

Small documentation fix.

------------------------------------------------------------------------
r28742 | guy | 2009-06-15 09:54:07 -0700 (Mon, 15 Jun 2009) | 2 lines
Changed paths:
   M /trunk/doc/README.developer

Note that non-ASCII characters in source files cause problems.
------------------------------------------------------------------------


------------------------------------------------------------------------
r28747 | gerald | 2009-06-15 15:01:35 -0700 (Mon, 15 Jun 2009) | 7 lines
Changed paths:
   M /trunk-1.2/wiretap/ascend-grammar.y

From Ben Winslow via bug 3535:

Because Lucent/Ascend equipment will sometimes omit the hex dump for a packet
or send two headers followed by two hex dumps, Wireshark needs to be very
lenient when parsing a Lucent/Ascend trace.  On a busy access server, a packet
like this is pretty likely to appear within a few minutes.

------------------------------------------------------------------------
r28753 | stig | 2009-06-15 20:54:21 -0700 (Mon, 15 Jun 2009) | 2 lines
Changed paths:
   M /trunk-1.2/wiretap/wtap.c

Support per packet dumping in wtap_encap_string() and wtap_encap_short_string().

------------------------------------------------------------------------
r28787 | gerald | 2009-06-21 08:04:42 -0700 (Sun, 21 Jun 2009) | 1 line
Changed paths:
   M /trunk-1.2/epan/enterprise-numbers
   M /trunk-1.2/manuf

[Automatic manuf and enterprise-numbers update for 2009-06-21]
------------------------------------------------------------------------
r28871 | gerald | 2009-06-28 08:04:37 -0700 (Sun, 28 Jun 2009) | 1 line
Changed paths:
   M /trunk-1.2/epan/enterprise-numbers
   M /trunk-1.2/manuf

[Automatic manuf and enterprise-numbers update for 2009-06-28]
------------------------------------------------------------------------
r28943 | gerald | 2009-07-05 08:04:37 -0700 (Sun, 05 Jul 2009) | 1 line
Changed paths:
   M /trunk-1.2/epan/enterprise-numbers
   M /trunk-1.2/manuf

[Automatic manuf and enterprise-numbers update for 2009-07-05]
------------------------------------------------------------------------
r29072 | gerald | 2009-07-12 08:04:57 -0700 (Sun, 12 Jul 2009) | 1 line
Changed paths:
   M /trunk-1.2/epan/enterprise-numbers
   M /trunk-1.2/manuf

[Automatic manuf and enterprise-numbers update for 2009-07-12]
------------------------------------------------------------------------
r29099 | gerald | 2009-07-14 17:10:08 -0700 (Tue, 14 Jul 2009) | 211 lines
Changed paths:
   M /trunk-1.2/AUTHORS
   M /trunk-1.2/asn1/ansi_map/ansi_map.asn
   M /trunk-1.2/diameter/dictionary.xml
   M /trunk-1.2/docbook/release-notes.xml
   M /trunk-1.2/dumpcap.c
   M /trunk-1.2/epan/addr_resolv.c
   M /trunk-1.2/epan/dissectors/packet-afs.c
   M /trunk-1.2/epan/dissectors/packet-icmpv6.c
   M /trunk-1.2/epan/dissectors/packet-ieee80211.c
   M /trunk-1.2/epan/dissectors/packet-infiniband.c
   M /trunk-1.2/epan/dissectors/packet-ipmi-se.c
   M /trunk-1.2/gtk/afp_stat.c
   M /trunk-1.2/gtk/airpcap_dlg.c
   M /trunk-1.2/gtk/ansi_a_stat.c
   M /trunk-1.2/gtk/ansi_map_stat.c
   M /trunk-1.2/gtk/bootp_stat.c
   M /trunk-1.2/gtk/camel_counter.c
   M /trunk-1.2/gtk/camel_srt.c
   M /trunk-1.2/gtk/capture_if_details_dlg_win32.c
   M /trunk-1.2/gtk/capture_if_dlg.c
   M /trunk-1.2/gtk/compare_stat.c
   M /trunk-1.2/gtk/conversations_table.c
   M /trunk-1.2/gtk/dcerpc_stat.c
   M /trunk-1.2/gtk/diameter_stat.c
   M /trunk-1.2/gtk/fc_stat.c
   M /trunk-1.2/gtk/fileset_dlg.c
   M /trunk-1.2/gtk/flow_graph.c
   M /trunk-1.2/gtk/funnel_stat.c
   M /trunk-1.2/gtk/gsm_a_stat.c
   M /trunk-1.2/gtk/gsm_map_stat.c
   M /trunk-1.2/gtk/gsm_map_summary.c
   M /trunk-1.2/gtk/gtp_stat.c
   M /trunk-1.2/gtk/h225_counter.c
   M /trunk-1.2/gtk/h225_ras_srt.c
   M /trunk-1.2/gtk/hostlist_table.c
   M /trunk-1.2/gtk/io_stat.c
   M /trunk-1.2/gtk/ldap_stat.c
   M /trunk-1.2/gtk/mcast_stream_dlg.c
   M /trunk-1.2/gtk/megaco_stat.c
   M /trunk-1.2/gtk/mgcp_stat.c
   M /trunk-1.2/gtk/mtp3_stat.c
   M /trunk-1.2/gtk/mtp3_summary.c
   M /trunk-1.2/gtk/ncp_stat.c
   M /trunk-1.2/gtk/radius_stat.c
   M /trunk-1.2/gtk/rpc_progs.c
   M /trunk-1.2/gtk/rpc_stat.c
   M /trunk-1.2/gtk/rtp_player.c
   M /trunk-1.2/gtk/scsi_stat.c
   M /trunk-1.2/gtk/sctp_byte_graph_dlg.c
   M /trunk-1.2/gtk/sctp_chunk_stat.c
   M /trunk-1.2/gtk/sctp_graph_dlg.c
   M /trunk-1.2/gtk/sip_stat.c
   M /trunk-1.2/gtk/smb2_stat.c
   M /trunk-1.2/gtk/smb_stat.c
   M /trunk-1.2/gtk/voip_calls_dlg.c
   M /trunk-1.2/gtk/wsp_stat.c
   M /trunk-1.2/tools/asn2wrs.py
   M /trunk-1.2/version.conf
   M /trunk-1.2/wiretap/dct3trace.c
   M /trunk-1.2/wiretap/libpcap.c
   M /trunk-1.2/wiretap/packetlogger.c
   M /trunk-1.2/wiretap/pcap-common.c
   M /trunk-1.2/wiretap/pcap-common.h
   M /trunk-1.2/wiretap/pcapng.c
   M /trunk-1.2/wiretap/wtap-int.h

Copy over revisions from the trunk:

------------------------------------------------------------------------
r28768 | tuexen | 2009-06-18 11:43:36 -0700 (Thu, 18 Jun 2009) | 3 lines
Changed paths:
   M /trunk/wiretap/pcapng.c
   M /trunk/wiretap/wtap-int.h

Fix for bug 3539: Address as signess issue for fcs_len.
Bugfix scheduled for 1.2.1.
------------------------------------------------------------------------
r28769 | stig | 2009-06-18 14:26:13 -0700 (Thu, 18 Jun 2009) | 2 lines
Changed paths:
   M /trunk/tools/asn2wrs.py

Use BASE_NONE for FT_BYTES.
------------------------------------------------------------------------
r28773 | stig | 2009-06-18 20:37:52 -0700 (Thu, 18 Jun 2009) | 2 lines
Changed paths:
   M /trunk/tools/asn2wrs.py

Write NULL for empty blurb.
------------------------------------------------------------------------
r28803 | stig | 2009-06-21 23:16:39 -0700 (Sun, 21 Jun 2009) | 2 lines
Changed paths:
   M /trunk/tools/asn2wrs.py

Default to BASE_NONE for FT_BOOLEAN with zero value for display.
------------------------------------------------------------------------
r28774 | stig | 2009-06-18 20:47:40 -0700 (Thu, 18 Jun 2009) | 3 lines
Changed paths:
   M /trunk/asn1/ansi_map/ansi_map.asn

From Anders: Fix wrong tag numbers.
Dissector will be generated when we fix some "empty blurb issues".
------------------------------------------------------------------------
r28796 | etxrab | 2009-06-21 13:42:07 -0700 (Sun, 21 Jun 2009) | 1 line
Changed paths:
   M /trunk/gtk/afp_stat.c
   M /trunk/gtk/airpcap_dlg.c
   M /trunk/gtk/ansi_a_stat.c
   M /trunk/gtk/ansi_map_stat.c
   M /trunk/gtk/bootp_stat.c
   M /trunk/gtk/camel_counter.c
   M /trunk/gtk/camel_srt.c
   M /trunk/gtk/capture_if_details_dlg_win32.c
   M /trunk/gtk/capture_if_dlg.c
   M /trunk/gtk/compare_stat.c
   M /trunk/gtk/conversations_table.c
   M /trunk/gtk/dcerpc_stat.c
   M /trunk/gtk/diameter_stat.c
   M /trunk/gtk/fc_stat.c
   M /trunk/gtk/fileset_dlg.c
   M /trunk/gtk/flow_graph.c
   M /trunk/gtk/funnel_stat.c
   M /trunk/gtk/gsm_a_stat.c
   M /trunk/gtk/gsm_map_stat.c
   M /trunk/gtk/gsm_map_summary.c
   M /trunk/gtk/gtp_stat.c
   M /trunk/gtk/h225_counter.c
   M /trunk/gtk/h225_ras_srt.c
   M /trunk/gtk/hostlist_table.c
   M /trunk/gtk/io_stat.c
   M /trunk/gtk/ldap_stat.c
   M /trunk/gtk/mcast_stream_dlg.c
   M /trunk/gtk/megaco_stat.c

Change window_new() to dlg_window_new() and destroy the window with the top level window.
------------------------------------------------------------------------
r28810 | etxrab | 2009-06-22 08:22:37 -0700 (Mon, 22 Jun 2009) | 1 line
Changed paths:
   M /trunk/gtk/hostlist_table.c
   M /trunk/gtk/mgcp_stat.c
   M /trunk/gtk/mtp3_stat.c
   M /trunk/gtk/mtp3_summary.c
   M /trunk/gtk/ncp_stat.c
   M /trunk/gtk/radius_stat.c
   M /trunk/gtk/rpc_progs.c
   M /trunk/gtk/rpc_stat.c
   M /trunk/gtk/rtp_player.c
   M /trunk/gtk/scsi_stat.c
   M /trunk/gtk/sctp_byte_graph_dlg.c
   M /trunk/gtk/sctp_chunk_stat.c
   M /trunk/gtk/sctp_graph_dlg.c
   M /trunk/gtk/sip_stat.c
   M /trunk/gtk/smb2_stat.c
   M /trunk/gtk/smb_stat.c
   M /trunk/gtk/voip_calls_dlg.c
   M /trunk/gtk/wsp_stat.c

Change window_new() to dlg_window_new() and destroy the window with the top level window.
------------------------------------------------------------------------
r28801 | jake | 2009-06-21 22:57:44 -0700 (Sun, 21 Jun 2009) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipmi-se.c

Fix for bug 3559:
Don't let the index run over the size of the array.
------------------------------------------------------------------------
r28815 | gerald | 2009-06-22 15:38:29 -0700 (Mon, 22 Jun 2009) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-afs.c

Instead of tvb_get_ptr + ep_alloc + proto_tree_add_string to fetch a string and
add it to the tree, just call proto_tree_add_item. Fixes bug 3564.

Replace another tvb_get_ptr call with tvb_format_text.
------------------------------------------------------------------------
r28818 | jake | 2009-06-22 23:45:59 -0700 (Mon, 22 Jun 2009) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icmpv6.c

From Shinsuke SUZUKI:
Due to an incorrect offset setting in packet-icmpv6.c Wireshark cannot parse RA router-lifetime and RA flags properly.
------------------------------------------------------------------------
r28822 | etxrab | 2009-06-23 09:01:55 -0700 (Tue, 23 Jun 2009) | 1 line
Changed paths:
   M /trunk/diameter/dictionary.xml

Update 3GPP AVP:s
------------------------------------------------------------------------
r28837 | stig | 2009-06-24 12:10:50 -0700 (Wed, 24 Jun 2009) | 3 lines
Changed paths:
   M /trunk/epan/addr_resolv.c

From Kovarththanan Rajaratnam via bug 3555:
Cancel hostname lookup timers if c-ares is not initialized.
------------------------------------------------------------------------
r28838 | jake | 2009-06-24 13:27:58 -0700 (Wed, 24 Jun 2009) | 2 lines
Changed paths:
   M /trunk/wiretap/dct3trace.c

From Duncan Salerno:
Ensure dct3trac packets never longer than 23 bytes.
------------------------------------------------------------------------
r28839 | stig | 2009-06-24 18:50:56 -0700 (Wed, 24 Jun 2009) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-infiniband.c

Remove a tvb_free() call.
------------------------------------------------------------------------
r28850 | tuexen | 2009-06-26 08:08:04 -0700 (Fri, 26 Jun 2009) | 12 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

* Allocate enough memory for reading a packet.
* Initialize pseudoheader.
* Add some input validation / protection code.
* Fix some return values.
* Clean up some whitespaces.

This fixes Bug 3565. Thanks to Tyson Key how reported
the issue and provided capture files for debugging.

This fix is scheduled for inclusion in Wireshark 1.2.1
and higher.
------------------------------------------------------------------------
r28852 | gerald | 2009-06-26 14:25:09 -0700 (Fri, 26 Jun 2009) | 3 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/dumpcap.c

Unfortunately, r28452 seems to cause more problems than it fixes. Back
out the change for now.
------------------------------------------------------------------------
r28857 | tuexen | 2009-06-27 04:39:47 -0700 (Sat, 27 Jun 2009) | 8 lines
Changed paths:
   M /trunk/wiretap/libpcap.c
   M /trunk/wiretap/pcap-common.c
   M /trunk/wiretap/pcap-common.h
   M /trunk/wiretap/pcapng.c

This commit
* adds an encap argument to pcap_process_pseudo_header.
* adds support for reading pseudo headers.
It fixes Bug 3560.
Thanks to Tyson Key for reporting the bug and providing
trace files. This fix will be scheduled for inclusion in
Wireshark 1.2.1 and higher.
------------------------------------------------------------------------
r28858 | tuexen | 2009-06-27 05:14:18 -0700 (Sat, 27 Jun 2009) | 10 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

If all interfaces use the same encapsulation, use
this a the file encapsulation.

This fixes a bug where you can not save a file
in libpcap format when you captured it as a
pcapng one.

This fix will be scheduled for Wireshark 1.2.1
and higher.
------------------------------------------------------------------------
r28859 | tuexen | 2009-06-27 05:41:06 -0700 (Sat, 27 Jun 2009) | 7 lines
Changed paths:
   M /trunk/wiretap/libpcap.c
   M /trunk/wiretap/pcap-common.c
   M /trunk/wiretap/pcap-common.h
   M /trunk/wiretap/pcapng.c

This patch
* adds an encapsulation argument to pcap_write_phdr.
* writes the pseudo header when writing pcapng files.

This fixes a bug where you could not write pcapng files
when using encapsulations requiring pseudo headers.
------------------------------------------------------------------------

Update the release notes and version.

------------------------------------------------------------------------
r29101 | gerald | 2009-07-15 11:39:09 -0700 (Wed, 15 Jul 2009) | 269 lines
Changed paths:
   M /trunk-1.2/Makefile.am
   M /trunk-1.2/Makefile.common
   M /trunk-1.2/Makefile.nmake
   M /trunk-1.2/aclocal-fallback/libgnutls.m4
   M /trunk-1.2/aclocal-flags
   M /trunk-1.2/config.h.win32
   M /trunk-1.2/configure.in
   M /trunk-1.2/docbook/release-notes.xml
   M /trunk-1.2/dumpcap.c
   M /trunk-1.2/epan/dissectors/Makefile.common
   M /trunk-1.2/epan/dissectors/packet-btl2cap.c
   M /trunk-1.2/epan/dissectors/packet-miop.c
   D /trunk-1.2/epan/dissectors/packet-miop.h
   M /trunk-1.2/epan/dissectors/packet-mip6.c
   M /trunk-1.2/epan/dissectors/packet-mip6.h
   M /trunk-1.2/epan/dissectors/packet-radius.c
   M /trunk-1.2/epan/dissectors/packet-sflow.c
   M /trunk-1.2/file.c
   M /trunk-1.2/gtk/airpcap_dlg.c
   M /trunk-1.2/gtk/airpcap_dlg.h
   M /trunk-1.2/gtk/airpcap_gui_utils.c
   M /trunk-1.2/gtk/airpcap_gui_utils.h
   M /trunk-1.2/gtk/follow_stream.c
   M /trunk-1.2/gtk/follow_stream.h
   M /trunk-1.2/gtk/follow_tcp.c
   M /trunk-1.2/gtk/hostlist_table.c
   M /trunk-1.2/gtk/iax2_analysis.c
   M /trunk-1.2/gtk/keys.h
   M /trunk-1.2/gtk/main.c
   M /trunk-1.2/gtk/main_airpcap_toolbar.c
   M /trunk-1.2/gtk/print_dlg.c
   M /trunk-1.2/gtk/rtp_analysis.c
   M /trunk-1.2/gtk/tcp_graph.c
   M /trunk-1.2/ipmap.html
   D /trunk-1.2/mkstemp.c
   D /trunk-1.2/mkstemp.h
   D /trunk-1.2/packaging/portableapps/win32/WiresharkPortable.ini
   M /trunk-1.2/packaging/portableapps/win32/WiresharkPortable.nsi
   A /trunk-1.2/packaging/portableapps/win32/WiresharkPortable.tmpl
   M /trunk-1.2/packaging/portableapps/win32/makefile.nmake
   M /trunk-1.2/packaging/portableapps/win32/readme.txt
   M /trunk-1.2/tempfile.c
   M /trunk-1.2/tempfile.h
   M /trunk-1.2/wiretap/btsnoop.c
   M /trunk-1.2/wiretap/libpcap.c
   M /trunk-1.2/wiretap/pcap-common.c
   M /trunk-1.2/wiretap/pcap-common.h
   M /trunk-1.2/wiretap/pcapng.c
   M /trunk-1.2/wiretap/wtap-int.h

Copy over revisions from the trunk:

------------------------------------------------------------------------
r28863 | tuexen | 2009-06-27 09:08:18 -0700 (Sat, 27 Jun 2009) | 3 lines
Changed paths:
   M /trunk/wiretap/libpcap.c
   M /trunk/wiretap/pcap-common.c
   M /trunk/wiretap/pcap-common.h
   M /trunk/wiretap/pcapng.c

Cleanup. Should be included in Wireshark 1.2.1 and higher to keep
merging future bug fixes simple.
------------------------------------------------------------------------
r28864 | tuexen | 2009-06-27 10:33:23 -0700 (Sat, 27 Jun 2009) | 3 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

Another cleanup. We are now back to Ulf's original
model of data handling.
------------------------------------------------------------------------
r28865 | tuexen | 2009-06-27 11:10:10 -0700 (Sat, 27 Jun 2009) | 3 lines
Changed paths:
   M /trunk/wiretap/libpcap.c

Fix copy/paste error introduced in rev. 28863.
Thanks to Guy for finding and reporting it. 
------------------------------------------------------------------------
r28866 | tuexen | 2009-06-27 11:50:13 -0700 (Sat, 27 Jun 2009) | 6 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

Accept file snaplen larger than WTAP_MAX_PACKET_SIZE,
text2pcap uses 102400.
This fixes bug 3620. Thanks to Tyson Key for reporting the bug
and providing capture files.
This fix should be included in Wireshark 1.2.1 and higher.
------------------------------------------------------------------------
r28868 | tuexen | 2009-06-28 04:09:24 -0700 (Sun, 28 Jun 2009) | 7 lines
Changed paths:
   M /trunk/wiretap/pcapng.c

Stop loading a pcapng file with multiple section header blocks.
This fixes a bug reported by Tyson Key as a follow up of Bug 3560.
Also some cleanups and debug output improvements.

Thanks to Tyson Key for reporting the bug and providing a tracefile.
This fix will be included in Wireshark 1.2.1 and higher.
------------------------------------------------------------------------
r28873 | etxrab | 2009-06-28 08:22:43 -0700 (Sun, 28 Jun 2009) | 3 lines
Changed paths:
   M /trunk/gtk/tcp_graph.c

From   Sean Walberg:
The title in the TCP sequence graphs is too short.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=3556
------------------------------------------------------------------------
r28874 | rbalint | 2009-06-28 09:31:27 -0700 (Sun, 28 Jun 2009) | 4 lines
Changed paths:
   D /trunk/aclocal-fallback/libgnutls.m4
   M /trunk/configure.in

Detect gnutls via pkg-config instead of the deprecated libgnutls-config.
Based on patch from Andreas Metzler.
This fixes bug 3627.
------------------------------------------------------------------------
r28876 | guy | 2009-06-28 10:23:07 -0700 (Sun, 28 Jun 2009) | 3 lines
Changed paths:
   M /trunk/aclocal-flags

We only support GLib 2.x/GTK+ 2.x, which uses pkg-config, not
gtk-config; use it instead.
------------------------------------------------------------------------
r28717 | gal | 2009-06-13 01:20:46 -0700 (Sat, 13 Jun 2009) | 2 lines
Changed paths:
   M /trunk/packaging/portableapps/win32/WiresharkPortable.ini
   M /trunk/packaging/portableapps/win32/WiresharkPortable.nsi
   M /trunk/packaging/portableapps/win32/readme.txt

Update for the latest WinPcap and also installation of the VC redistributable.
------------------------------------------------------------------------
r28884 | wmeier | 2009-06-29 13:59:26 -0700 (Mon, 29 Jun 2009) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-btl2cap.c

From  Kovarththanan Rajaratnam: Fix for Bug #3572 
[http://bugs.wireshark.org/bugzilla/show_bug.cgi?id=3572]
------------------------------------------------------------------------
r28886 | gerald | 2009-06-29 16:08:05 -0700 (Mon, 29 Jun 2009) | 3 lines
Changed paths:
   M /trunk/gtk/airpcap_dlg.c
   M /trunk/gtk/airpcap_dlg.h
   M /trunk/gtk/airpcap_gui_utils.c
   M /trunk/gtk/airpcap_gui_utils.h
   M /trunk/gtk/keys.h
   M /trunk/gtk/main_airpcap_toolbar.c

Fix a couple of AirPcap channel/offset bugs. Remove an unused
routine. Fixup whitespace in a couple of places.
------------------------------------------------------------------------
r28891 | wmeier | 2009-06-30 06:57:26 -0700 (Tue, 30 Jun 2009) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-radius.c

packet-radius: Fix exception CLEANUP handling when malformed attribute list/pair seen;
Fixes crash reported in Bug #3578. [https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=3578]
Essentially: CLEANUP_CALL_AND_POP wasn't being executed for certain error exits from
 dissect_attribute_pairs() thus leaving a CLEANUP entry on the exception stack.
Also: vsa_buffer_table wasn't being destroyed if an exception occurred in dissect_attribute_pairs.
------------------------------------------------------------------------
r28897 | gerald | 2009-06-30 13:59:51 -0700 (Tue, 30 Jun 2009) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sflow.c

Add some length checks. Fixes bug 3567.
------------------------------------------------------------------------
r28908 | gerald | 2009-07-01 08:56:12 -0700 (Wed, 01 Jul 2009) | 3 lines
Changed paths:
   M /trunk/gtk/airpcap_dlg.c
   M /trunk/gtk/airpcap_gui_utils.c
   M /trunk/gtk/airpcap_gui_utils.h
   M /trunk/gtk/main_airpcap_toolbar.c

Fix a key entry bug in the decryption key dialog. Remove some unused /
unnecessary functions. Clean up code in a couple of places.
------------------------------------------------------------------------
r28917 | stig | 2009-07-01 23:51:27 -0700 (Wed, 01 Jul 2009) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mip6.c
   M /trunk/epan/dissectors/packet-mip6.h

From Albert Chin:
Small patch to make it compile on AIX.
------------------------------------------------------------------------
r28918 | stig | 2009-07-02 02:08:11 -0700 (Thu, 02 Jul 2009) | 5 lines
Changed paths:
   M /trunk/gtk/main.c

Move updating menus with new recent values to a point after we have created
the new packet list, because we relay on the columns for time values.

This fixes bug 3640.
------------------------------------------------------------------------
r28728 | gerald | 2009-06-14 15:19:08 -0700 (Sun, 14 Jun 2009) | 3 lines
Changed paths:
   M /trunk/gtk/hostlist_table.c
   M /trunk/ipmap.html

Use a unique data file name for our OpenStreetMap data. Print an error
if we don't have data for any hosts. Fixes bug 3530.
------------------------------------------------------------------------
r28915 | gerald | 2009-07-01 16:36:51 -0700 (Wed, 01 Jul 2009) | 5 lines
Changed paths:
   M /trunk/dumpcap.c
   M /trunk/file.c
   M /trunk/gtk/follow_stream.c
   M /trunk/gtk/follow_stream.h
   M /trunk/gtk/follow_tcp.c
   M /trunk/gtk/hostlist_table.c
   M /trunk/gtk/iax2_analysis.c
   M /trunk/gtk/print_dlg.c
   M /trunk/gtk/rtp_analysis.c
   M /trunk/tempfile.c
   M /trunk/tempfile.h

Updates to create_tempfile:

  - Use g_get_tmp_dir, just like get_tempfile_path.
  - Don't make the caller worry about the path buffer length.
------------------------------------------------------------------------
r28920 | gerald | 2009-07-02 10:20:27 -0700 (Thu, 02 Jul 2009) | 8 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/Makefile.common
   M /trunk/Makefile.nmake
   M /trunk/config.h.win32
   M /trunk/configure.in
   M /trunk/gtk/hostlist_table.c
   D /trunk/mkstemp.c
   D /trunk/mkstemp.h
   M /trunk/tempfile.c
   M /trunk/tempfile.h

Pull mkstemp() into tempfile.c. That's the only place we use it now, and
it's arguably the only place we _should_ use it. Add create_tempdir() to
tempfile.c and use it to create a temp directory for IP maps. This
should fix bug 3530.

(This still doesn't work on IE 8 / Vista here. IE gives an access denied
error in OpenLayers.js, but this is a separate issue).
------------------------------------------------------------------------
r28924 | tuexen | 2009-07-02 12:52:47 -0700 (Thu, 02 Jul 2009) | 4 lines
Changed paths:
   M /trunk/wiretap/btsnoop.c

Patch from Alex Badea for Bug 3645.

This fix will be included in Wireshark 1.2.1.
------------------------------------------------------------------------
r28925 | guy | 2009-07-02 13:10:05 -0700 (Thu, 02 Jul 2009) | 7 lines
Changed paths:
   M /trunk/wiretap/btsnoop.c

Don't dump out the raw link-layer type when noting that
KHciLoggerDatalinkTypeBCSP and KHciLoggerDatalinkTypeH5 aren't supported
- just explicitly say "BSCP" or "H5".

For unknown link-layer types, say "unknown or unsupported", as other
Wiretap modules do.
------------------------------------------------------------------------


Copy over with manual intervention:

------------------------------------------------------------------------
r28862 | tuexen | 2009-06-27 08:20:44 -0700 (Sat, 27 Jun 2009) | 9 lines
Changed paths:
   M /trunk/wiretap/pcapng.c
   M /trunk/wiretap/wtap-int.h

Add support for writing pcapng files with multiple
encapsulations.
This fixes a bug reported by Sake during the
Sharkfest 09. Thanks for providing a
Netscreen tracefile with multiple link layer
types.
This patch will be included in Wireshark 1.2.1
and higher.
------------------------------------------------------------------------
r28880 | gal | 2009-06-29 06:01:54 -0700 (Mon, 29 Jun 2009) | 9 lines
Changed paths:
   D /trunk/packaging/portableapps/win32/WiresharkPortable.ini
   M /trunk/packaging/portableapps/win32/WiresharkPortable.nsi
   A /trunk/packaging/portableapps/win32/WiresharkPortable.tmpl
   M /trunk/packaging/portableapps/win32/makefile.nmake

Changes to address bug 3547:

1) Make sure WiresharkPortable.nsi uses correct WinPcap version (from config.nmake), and also vcredist.
2) Automatically generate WiresharkPortable.ini with correct default values
3) Include readme.txt in the distribution so that users know how to use WiresharkPortable.ini

Thanks to Kovarththanan Rajaratnam for basic patch.
------------------------------------------------------------------------
r28963 | gerald | 2009-07-06 13:23:32 -0700 (Mon, 06 Jul 2009) | 17 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-miop.c
   D /trunk/epan/dissectors/packet-miop.h

From Kovarththanan Rajaratnam via bug 3652:

This patch protects against malformed Unique ID lengths (>= 252 bytes) and
defer all tvb_xxx related calls to when we actually need them. This allows us
to dissects as much as possible before bailing out (in case of a malformed
length).

From me:

Add a link to the protocol specification.  Remove packet-miop.h along
with some struct definitions. (Don't tvb_memcpy over structs!) Remove
some more tvbuffs.  Don't call proto_item_add_subtree if we're not going
to use the trees.  Call proto_tree_add_item instead of
proto_tree_add_text Remove a bunch of unused ett_ variables.  Add an
expert item for the protocol version.  Register the field array with the
correct length.
------------------------------------------------------------------------

Update the release notes.

------------------------------------------------------------------------
r29102 | gerald | 2009-07-15 12:22:21 -0700 (Wed, 15 Jul 2009) | 78 lines
Changed paths:
   M /trunk-1.2/docbook/release-notes.xml
   M /trunk-1.2/epan/Makefile.nmake
   M /trunk-1.2/epan/dfilter/semcheck.c
   M /trunk-1.2/epan/dissectors/packet-isup.c
   M /trunk-1.2/epan/dissectors/packet-radius.c
   M /trunk-1.2/epan/libwireshark.def
   M /trunk-1.2/epan/radius_dict.l
   M /trunk-1.2/gtk/dfilter_expr_dlg.c
   M /trunk-1.2/packaging/Makefile.am

Copy over revisions from the trunk:

------------------------------------------------------------------------
r28923 | gerald | 2009-07-02 12:50:35 -0700 (Thu, 02 Jul 2009) | 2 lines
Changed paths:
   M /trunk/epan/Makefile.nmake
   M /trunk/epan/libwireshark.def

mkstemp cleanups.
------------------------------------------------------------------------
r28931 | wmeier | 2009-07-02 18:11:23 -0700 (Thu, 02 Jul 2009) | 12 lines
Changed paths:
   M /trunk/epan/dfilter/semcheck.c
   M /trunk/gtk/dfilter_expr_dlg.c

From  Kovarththanan Rajaratnam: Fixes for bug #3536
(plus some additional changes by me).

Handle BASE_RANGE_STRING display types properly

We always treat header field info strings as value_string's undiscriminated.
However, if the header field info display is marked as BASE_RANGE_STRING, we
need to treat them as range_string's. This wasn't properly handled in the
filter expression dialog and in the filter toolbar which would cause a crash
upon referencing any fields marked as BASE_RANGE_STRING.
------------------------------------------------------------------------
r28937 | wmeier | 2009-07-03 09:03:02 -0700 (Fri, 03 Jul 2009) | 29 lines
Changed paths:
   M /trunk/epan/dissectors/packet-radius.c
   M /trunk/epan/radius_dict.l

From: Tobias Witek: Fix processing of radius 'vendor specific attributes'

In the RADIUS dissector, the function radius_register_avp_dissector() registers
vendors that are not already present in the dictionary hash-table. As far as I
can see, there are two problems with this:

1. The function does not set the number of type/length octets and the has_flags
 variable for that AVP, which is required to correctly decode AVP/VSA values
2. In some situations, the function is called _before_ radius_load_dictionary()
is called (for example for the vendor 3GPP (ID: 10415))

Therefore, all vendor entries that are created by calling
radius_register_avp_dissector() leave their type_octets and length_octets un-initialized,
which causes incorrect decoding.

[Result: Radius dissector displays messages such as:
 "Malformed Packet: RADIUS" and "Error/Malformed: Malformed Packet(Exception occurred)"]

The attached patch fixes this problem by assuming that the dictionary knows the
'ground truth' about the type/length octet and the has_flags information and allows it to
overwrite these values even for vendors that have already been loaded.

Also: (from Bill Meier): set the type/length octet and the has_flags variables to default
"standard" values (1,1,FALSE) in radius_register_avp_dissector().

Fixes Bug #3651 (and Bug #3635).
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=3651
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=3635
------------------------------------------------------------------------
r28939 | etxrab | 2009-07-04 08:15:51 -0700 (Sat, 04 Jul 2009) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isup.c

A fix for:
"ANSI ISUP Cause indicators with coding standard=ANSI fail to dissect."
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=3654
------------------------------------------------------------------------
r28882 | stig | 2009-06-29 13:16:20 -0700 (Mon, 29 Jun 2009) | 2 lines
Changed paths:
   M /trunk/packaging/Makefile.am
   M /trunk/packaging/portableapps/win32

WiresharkPortable.ini -> WiresharkPortable.tmpl
------------------------------------------------------------------------

Update the release notes.

------------------------------------------------------------------------
r29106 | gerald | 2009-07-15 14:37:33 -0700 (Wed, 15 Jul 2009) | 21 lines
Changed paths:
   M /trunk-1.2/Makefile.am
   M /trunk-1.2/asn1/snmp/packet-snmp-template.c
   M /trunk-1.2/debian/control
   M /trunk-1.2/debian/rules
   M /trunk-1.2/diameter/dictionary.xml
   M /trunk-1.2/doc/tshark.pod
   M /trunk-1.2/doc/wireshark.pod
   M /trunk-1.2/docbook/release-notes.xml
   M /trunk-1.2/epan/dissectors/packet-cops.c
   M /trunk-1.2/epan/dissectors/packet-dcm.c
   M /trunk-1.2/epan/dissectors/packet-dcm.h
   M /trunk-1.2/epan/dissectors/packet-ff.c
   M /trunk-1.2/epan/dissectors/packet-giop.c
   M /trunk-1.2/epan/dissectors/packet-gsm_a_bssmap.c
   M /trunk-1.2/epan/dissectors/packet-hci_h4.c
   M /trunk-1.2/epan/dissectors/packet-iec104.c
   M /trunk-1.2/epan/dissectors/packet-ieee80211.c
   M /trunk-1.2/epan/dissectors/packet-isup.c
   M /trunk-1.2/epan/dissectors/packet-netflow.c
   M /trunk-1.2/epan/dissectors/packet-pw-eth.c
   M /trunk-1.2/epan/dissectors/packet-smb2.c
   M /trunk-1.2/epan/dissectors/packet-ziop.c
   M /trunk-1.2/gtk/decode_as_dlg.c
   M /trunk-1.2/gtk/export_object_dicom.c
   M /trunk-1.2/gtk/main_statusbar.c

r29095 | gerald | 2009-07-14 12:13:14 -0700 (Tue, 14 Jul 2009) | 14 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ziop.c

From Alvaro Vega Garcia via bug 3652:

Patch with some improvements for packet ziop dissector following patch
about MIOP dissector submitted by Kovarththanan Rajaratnam.

From me:

Add a link to the protocol specification.  Don't tvb_memcpy over
structs! Remove some more tvbuffs.  Don't call proto_item_add_subtree if
we're not going to use the trees.  Call proto_tree_add_item instead of
proto_tree_add_text Remove a bunch of unused ett_ variables and a few
other now-unused variables.  Register the field array with the correct
length.
------------------------------------------------------------------------

Update the release notes.

------------------------------------------------------------------------
r29107 | gerald | 2009-07-15 14:40:55 -0700 (Wed, 15 Jul 2009) | 10 lines
Changed paths:
   M /trunk-1.2/gtk/follow_stream.c

Copy over r28916 from the trunk:

------------------------------------------------------------------------
r28916 | gerald | 2009-07-01 19:50:24 -0700 (Wed, 01 Jul 2009) | 2 lines
Changed paths:
   M /trunk/gtk/follow_stream.c

Fix the build.
------------------------------------------------------------------------

------------------------------------------------------------------------
r29108 | gerald | 2009-07-15 14:45:11 -0700 (Wed, 15 Jul 2009) | 10 lines
Changed paths:
   M /trunk-1.2/epan/dissectors/packet-ziop.c

Copy over r29105 from the trunk:

------------------------------------------------------------------------
r29105 | guy | 2009-07-15 14:30:37 -0700 (Wed, 15 Jul 2009) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ziop.c

Get rid of C++-style comment (and anglicize it).
------------------------------------------------------------------------

------------------------------------------------------------------------
r29110 | gerald | 2009-07-15 16:08:08 -0700 (Wed, 15 Jul 2009) | 2 lines
Changed paths:
   A /trunk-1.2/debian/README.source

Add a missing file.

------------------------------------------------------------------------
r29112 | gerald | 2009-07-15 16:44:29 -0700 (Wed, 15 Jul 2009) | 2 lines
Changed paths:
   M /trunk-1.2/diameter/dictionary.xml

Copy over dictionary.xml r29052 from the trunk.

------------------------------------------------------------------------
r29113 | jake | 2009-07-15 22:47:03 -0700 (Wed, 15 Jul 2009) | 1 line
Changed paths:
   M /trunk-1.2/debian/changelog

Bump version number/timestamp in debian changelog.
------------------------------------------------------------------------
r29117 | gerald | 2009-07-16 08:42:38 -0700 (Thu, 16 Jul 2009) | 1 line
Changed paths:
   M /trunk-1.2/config.nmake
   M /trunk-1.2/configure.in

It might help if we used the right version.
------------------------------------------------------------------------
r29119 | gerald | 2009-07-16 10:07:43 -0700 (Thu, 16 Jul 2009) | 8 lines
Changed paths:
   M /trunk-1.2/asn1/snmp/packet-snmp-template.c
   M /trunk-1.2/epan/dissectors/packet-snmp.c

Copy over r29118 with manual intervention.

------------------------------------------------------------------------
r29118 | gerald | 2009-07-16 10:00:58 -0700 (Thu, 16 Jul 2009) | 2 lines

Don't crash if we happen to load a bad MIB file.
------------------------------------------------------------------------

------------------------------------------------------------------------
r29120 | gerald | 2009-07-16 10:09:19 -0700 (Thu, 16 Jul 2009) | 2 lines
Changed paths:
   M /trunk-1.2/docbook/release-notes.xml

Update the release notes.

------------------------------------------------------------------------
r29136 | gerald | 2009-07-17 16:34:48 -0700 (Fri, 17 Jul 2009) | 41 lines
Changed paths:
   M /trunk-1.2/docbook/release-notes.xml
   M /trunk-1.2/epan/dissectors/packet-per.c
   M /trunk-1.2/epan/dissectors/packet-rsvp.c
   M /trunk-1.2/epan/reassemble.c
   M /trunk-1.2/gtk/airpcap_gui_utils.c
   M /trunk-1.2/gtk/main_airpcap_toolbar.c

Copy over revisions from the trunk:

------------------------------------------------------------------------
r29124 | etxrab | 2009-07-16 14:09:18 -0700 (Thu, 16 Jul 2009) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-per.c

From   Sean Yunjnz:
Problem in packet-per.c for ASN.1 PER Encoding.
https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=3733
------------------------------------------------------------------------
r29123 | gerald | 2009-07-16 14:03:39 -0700 (Thu, 16 Jul 2009) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rsvp.c

Make sure some variables are initialized so that Valgrind quits
complaining.  Use se_memdup to copy memory.
------------------------------------------------------------------------
r29126 | gerald | 2009-07-16 14:35:54 -0700 (Thu, 16 Jul 2009) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rsvp.c

Use SE_COPY_ADDRESS instead of trying to attach ep_alloced data to an
se_alloced struct.
------------------------------------------------------------------------
r29128 | gerald | 2009-07-16 15:25:06 -0700 (Thu, 16 Jul 2009) | 2 lines
Changed paths:
   M /trunk/epan/reassemble.c

Check for an overflow. This should hopefully fix bug 3672.
------------------------------------------------------------------------
r29135 | gerald | 2009-07-17 15:59:59 -0700 (Fri, 17 Jul 2009) | 2 lines
Changed paths:
   M /trunk/gtk/airpcap_gui_utils.c
   M /trunk/gtk/main_airpcap_toolbar.c

Set the extension channel correctly. Fixup whitespace.
------------------------------------------------------------------------

Update the release notes.

------------------------------------------------------------------------
r29140 | gerald | 2009-07-19 08:05:02 -0700 (Sun, 19 Jul 2009) | 1 line
Changed paths:
   M /trunk-1.2/epan/enterprise-numbers
   M /trunk-1.2/manuf

[Automatic manuf and enterprise-numbers update for 2009-07-19]
------------------------------------------------------------------------
